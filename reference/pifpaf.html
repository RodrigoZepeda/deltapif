<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Potential Impact fraction and Population Attributable Fraction — pifpaf • deltapif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Potential Impact fraction and Population Attributable Fraction — pifpaf"><meta name="description" content="Calculates the potential impact fraction pif or the population
attributable fraction paf for a categorical exposure considering
an observed prevalence of  p and a relative risk
(or relative risk parameter) of beta."><meta property="og:description" content="Calculates the potential impact fraction pif or the population
attributable fraction paf for a categorical exposure considering
an observed prevalence of  p and a relative risk
(or relative risk parameter) of beta."><meta property="og:image" content="https://rodrigozepeda.github.io/deltapif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deltapif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Potential Impact fraction and Population Attributable Fraction</h1>

      <div class="d-none name"><code>pifpaf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the potential impact fraction <code>pif</code> or the population
attributable fraction <code>paf</code> for a categorical exposure considering
an observed prevalence of  <code>p</code> and a relative risk
(or relative risk parameter) of <code>beta</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">paf</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  var_p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rr_link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  rr_link_deriv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"log-complement"</span>,</span>
<span>  link_inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link_deriv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pif</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  p_cft <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  var_p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rr_link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  rr_link_deriv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"log-complement"</span>,</span>
<span>  link_inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link_deriv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"PIF"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Prevalence (proportion) of the exposed individuals for
each of the <code>N</code> exposure levels.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Relative risk parameter for which standard deviation is
available (usually its either the relative risk directly or the log
of the relative risk as most RRs, ORs and HRs come from exponential
models).</p></dd>


<dt id="arg-var-p">var_p<a class="anchor" aria-label="anchor" href="#arg-var-p"></a></dt>
<dd><p>Estimate of the colink_variance matrix of <code>p</code> where the entry
<code>var_p[i,j]</code> represents the colink_variance between <code>p[i]</code> and <code>p[j]</code>.</p></dd>


<dt id="arg-var-beta">var_beta<a class="anchor" aria-label="anchor" href="#arg-var-beta"></a></dt>
<dd><p>Estimate of the colink_variance matrix of <code>beta</code> where the entry
<code>var_beta[i,j]</code> represents the colink_variance between <code>beta[i]</code> and <code>beta[j]</code>.</p></dd>


<dt id="arg-rr-link">rr_link<a class="anchor" aria-label="anchor" href="#arg-rr-link"></a></dt>
<dd><p>Link function such that the relative risk is given by
<code>rr_link(beta)</code>.</p></dd>


<dt id="arg-rr-link-deriv">rr_link_deriv<a class="anchor" aria-label="anchor" href="#arg-rr-link-deriv"></a></dt>
<dd><p>Derivative of the link function for the relative risk.
The function tries to build it automatically from <code>rr_link</code> using
<code><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv::Deriv()</a></code>.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function such that the <code>pif</code> confidence intervals
stays within the expected bounds.</p></dd>


<dt id="arg-link-inv">link_inv<a class="anchor" aria-label="anchor" href="#arg-link-inv"></a></dt>
<dd><p>The inverse of <code>link</code>. For example if <code>link</code>
is <code>logit</code> this should be <code>inv_logit</code>.</p></dd>


<dt id="arg-link-deriv">link_deriv<a class="anchor" aria-label="anchor" href="#arg-link-deriv"></a></dt>
<dd><p>Derivative of the <code>link</code> function. The function tries
to build it automatically from <code>link</code> using <code><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv::Deriv()</a></code>.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level for the confidence interval (default 0.95).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Whether to show messages.</p></dd>


<dt id="arg-p-cft">p_cft<a class="anchor" aria-label="anchor" href="#arg-p-cft"></a></dt>
<dd><p>Counterfactual prevalence (proportion) of the exposed
individuals for each of the <code>N</code> exposure levels.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character either Potential Impact Fraction (<code>PIF</code>) or
Population Attributable Fraction (<code>PAF</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function assumes <code>p</code> and <code>beta</code> have been pre-computed from
the data and the individual-level data are not accessible to the
researchers. If either the data for the individual-level prevalence of
exposure <code>p</code> or the data for the individual-level risk estimate <code>beta</code>
can be accessed by the researcher other methods (such as the <code>pifpaf</code>
package should be preferred).</p>
    </div>
    <div class="section level2">
    <h2 id="formulas">Formulas<a class="anchor" aria-label="anchor" href="#formulas"></a></h2>


<p>This function computed the potential impact fraction and its confidence
intervals using Walter's formula:
$$
 \dfrac{
   \sum\limits_{i=1}^N p_i \text{RR}_i - \sum\limits_{i=1}^N p_i^{\text{cft}} \text{RR}_i
  }{
   \sum\limits_{i=1}^N p_i \text{RR}_i
  }
$$
in the case of <code>N</code> exposure categories which is equivalent to Levine's formula
when there is only <code>1</code> exposure category:
$$
 \dfrac{
   p (\text{RR} - 1) - p^{\text{cft}} (\text{RR} - 1)
  }{
   1 + p (\text{RR} - 1)
  }
$$</p>
    </div>
    <div class="section level2">
    <h2 id="link-functions-for-the-pif">Link functions for the PIF<a class="anchor" aria-label="anchor" href="#link-functions-for-the-pif"></a></h2>



    </div>
    <div class="section level2">
    <h2 id="link-functions-for-beta">Link functions for beta<a class="anchor" aria-label="anchor" href="#link-functions-for-beta"></a></h2>



    </div>
    <div class="section level2">
    <h2 id="population-attributable-fraction">Population Attributable Fraction<a class="anchor" aria-label="anchor" href="#population-attributable-fraction"></a></h2>


<p>The population attributable fraction corresponds to the potential impact
fraction at the theoretical minimum risk level. It is assumed that the
theoretical minimum risk level is a relative risk of 1. If no
counterfactual prevalence <code>p_cft</code> is specified, the model computes
the population attributable fraction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This example comes from Levin 1953</span></span></span>
<span class="r-in"><span><span class="co"># Relative risk of lung cancer given smoking was 3.6</span></span></span>
<span class="r-in"><span><span class="co"># Proportion of individuals smoking where 49.9%</span></span></span>
<span class="r-in"><span><span class="co"># Calculates PAF (i.e. counterfactual is no smoking)</span></span></span>
<span class="r-in"><span><span class="fu">paf</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.499</span>, beta <span class="op">=</span> <span class="fl">3.6</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Assuming parameters `p` have no variance Use `var_p` to input their link_variances and/or covariance</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Assuming parameters `beta` have no variance Use `var_beta` to input their link_variances and/or covariance</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Attributable Fraction</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PAF = 56.473% [<span style="font-style: italic;">95% CI</span>: 56.473% to 56.473%]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(paf %) = 0.000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(link(paf)) = 0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assuming that beta and p had a link_variance</span></span></span>
<span class="r-in"><span><span class="fu">paf</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.499</span>, beta <span class="op">=</span> <span class="fl">3.6</span>, var_p <span class="op">=</span> <span class="fl">0.001</span>, var_beta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Attributable Fraction</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PAF = 56.473% [<span style="font-style: italic;">95% CI</span>: 32.990% to 71.726%]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(paf %) = 9.582</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(link(paf)) = 0.220</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the link_variance was to high a logistic transform would be required</span></span></span>
<span class="r-in"><span><span class="co"># Generates incorrect values for the interval:</span></span></span>
<span class="r-in"><span><span class="fu">paf</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.499</span>, beta <span class="op">=</span> <span class="fl">3.6</span>, var_p <span class="op">=</span> <span class="fl">0.1</span>, var_beta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Attributable Fraction</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PAF = 56.473% [<span style="font-style: italic;">95% CI</span>: -20.431% to 84.268%]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(paf %) = 22.601</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(link(paf)) = 0.519</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Logit fixes it</span></span></span>
<span class="r-in"><span><span class="fu">paf</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.499</span>, beta <span class="op">=</span> <span class="fl">3.6</span>, var_p <span class="op">=</span> <span class="fl">0.1</span>, var_beta <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    link <span class="op">=</span> <span class="st">"logit"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Population Attributable Fraction</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PAF = 56.473% [<span style="font-style: italic;">95% CI</span>: 17.628% to 88.720%]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(paf %) = 22.601</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(link(paf)) = 0.919</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the counterfactual was reducing the smoking population by 1/2</span></span></span>
<span class="r-in"><span><span class="fu">pif</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.499</span>, beta <span class="op">=</span> <span class="fl">1.6</span>, p_cft <span class="op">=</span> <span class="fl">0.499</span><span class="op">/</span><span class="fl">2</span>, var_p <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>    var_beta <span class="op">=</span> <span class="fl">1</span>, link <span class="op">=</span> <span class="st">"logit"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Potential Impact Fraction</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PIF = 11.521% [<span style="font-style: italic;">95% CI</span>: 0.746% to 69.285%]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(pif %) = 14.833</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> standard_deviation(link(pif)) = 1.455</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rodrigo Zepeda-Tello.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

