<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Potential Impact Fraction related classes — classes • deltapif</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Potential Impact Fraction related classes — classes"><meta name="description" content="Objects for handling potential impact fractions for a categorical exposure
considering an observed prevalence of  p and a relative risk
(or relative risk parameter) of beta."><meta property="og:description" content="Objects for handling potential impact fractions for a categorical exposure
considering an observed prevalence of  p and a relative risk
(or relative risk parameter) of beta."><meta property="og:image" content="https://rodrigozepeda.github.io/deltapif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deltapif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Potential Impact Fraction related classes</h1>

      <div class="d-none name"><code>classes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Objects for handling potential impact fractions for a categorical exposure
considering an observed prevalence of  <code>p</code> and a relative risk
(or relative risk parameter) of <code>beta</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pif_class</span><span class="op">(</span></span>
<span>  pif <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"PIF"</span>,</span>
<span>  link <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="cn">NULL</span>,</span>
<span>  link_inv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="cn">NULL</span>,</span>
<span>  link_deriv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pif_atomic_class</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">p_cft</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">var_p</span>,</span>
<span>  <span class="va">var_beta</span>,</span>
<span>  <span class="va">rr_link</span>,</span>
<span>  <span class="va">rr_link_deriv</span>,</span>
<span>  <span class="va">link</span>,</span>
<span>  <span class="va">link_deriv</span>,</span>
<span>  <span class="va">link_inv</span>,</span>
<span>  <span class="va">conf_level</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">upper_bound_p</span>,</span>
<span>  <span class="va">upper_bound_beta</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pif_global_ensemble_class</span><span class="op">(</span></span>
<span>  <span class="va">pif_list</span>,</span>
<span>  <span class="va">pif_weights</span>,</span>
<span>  <span class="va">sigma_pif_weights</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  <span class="va">pif_transform</span>,</span>
<span>  <span class="va">pif_deriv_transform</span>,</span>
<span>  <span class="va">pif_inverse_transform</span>,</span>
<span>  <span class="va">link</span>,</span>
<span>  <span class="va">link_inv</span>,</span>
<span>  <span class="va">link_deriv</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pif_total_class</span><span class="op">(</span></span>
<span>  <span class="va">pif_list</span>,</span>
<span>  <span class="va">pif_weights</span>,</span>
<span>  <span class="va">sigma_pif_weights</span>,</span>
<span>  <span class="va">link</span>,</span>
<span>  <span class="va">link_inv</span>,</span>
<span>  <span class="va">link_deriv</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pif_ensemble_class</span><span class="op">(</span></span>
<span>  <span class="va">pif_list</span>,</span>
<span>  <span class="va">pif_weights</span>,</span>
<span>  <span class="va">sigma_pif_weights</span>,</span>
<span>  <span class="va">link</span>,</span>
<span>  <span class="va">link_inv</span>,</span>
<span>  <span class="va">link_deriv</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pif">pif<a class="anchor" aria-label="anchor" href="#arg-pif"></a></dt>
<dd><p>Potential Impact Fraction estimate</p></dd>


<dt id="arg-variance">variance<a class="anchor" aria-label="anchor" href="#arg-variance"></a></dt>
<dd><p>variance estimate for the potential impact fraction (i.e.
for <code>pif</code>)</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level for the confidence interval (default 0.95).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character either Potential Impact Fraction (<code>PIF</code>) or
Population Attributable Fraction (<code>PAF</code>)</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function such that the <code>pif</code> confidence intervals
stays within the expected bounds.</p></dd>


<dt id="arg-link-inv">link_inv<a class="anchor" aria-label="anchor" href="#arg-link-inv"></a></dt>
<dd><p>The inverse of <code>link</code>. For example if <code>link</code>
is <code>logit</code> this should be <code>inv_logit</code>.</p></dd>


<dt id="arg-link-deriv">link_deriv<a class="anchor" aria-label="anchor" href="#arg-link-deriv"></a></dt>
<dd><p>The derivative of <code>link</code>. For example if <code>link</code>
is <code>logit</code> this should be <code>deriv_logit</code> (i.e. <code>function(pif) 1 / (pif * (1 - pif))</code>).</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Prevalence (proportion) of the exposed individuals for
each of the <code>N</code> exposure levels.</p></dd>


<dt id="arg-p-cft">p_cft<a class="anchor" aria-label="anchor" href="#arg-p-cft"></a></dt>
<dd><p>Counterfactual prevalence (proportion) of the exposed
individuals for each of the <code>N</code> exposure levels.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Relative risk parameter for which standard deviation is
available (usually its either the relative risk directly or the log
of the relative risk as most RRs, ORs and HRs come from exponential
models).</p></dd>


<dt id="arg-var-p">var_p<a class="anchor" aria-label="anchor" href="#arg-var-p"></a></dt>
<dd><p>Estimate of the link_covariance matrix of <code>p</code> where the entry
<code>var_p[i,j]</code> represents the link_covariance between <code>p[i]</code> and <code>p[j]</code>.</p></dd>


<dt id="arg-var-beta">var_beta<a class="anchor" aria-label="anchor" href="#arg-var-beta"></a></dt>
<dd><p>Estimate of the link_covariance matrix of <code>beta</code> where the entry
<code>var_beta[i,j]</code> represents the link_covariance between <code>beta[i]</code> and <code>beta[j]</code>.</p></dd>


<dt id="arg-rr-link">rr_link<a class="anchor" aria-label="anchor" href="#arg-rr-link"></a></dt>
<dd><p>Link function such that the relative risk is given by
<code>rr_link(beta)</code>.</p></dd>


<dt id="arg-rr-link-deriv">rr_link_deriv<a class="anchor" aria-label="anchor" href="#arg-rr-link-deriv"></a></dt>
<dd><p>Derivative of the link function for the relative risk.
The constructor tries to build it automatically from <code>rr_link</code> using
<code><a href="https://rdrr.io/pkg/Deriv/man/Deriv.html" class="external-link">Deriv::Deriv()</a></code>.</p></dd>


<dt id="arg-upper-bound-p">upper_bound_p<a class="anchor" aria-label="anchor" href="#arg-upper-bound-p"></a></dt>
<dd><p>Whether the values for the <code>p</code> component
of the link_variance should be approximated by an upper bound.</p></dd>


<dt id="arg-upper-bound-beta">upper_bound_beta<a class="anchor" aria-label="anchor" href="#arg-upper-bound-beta"></a></dt>
<dd><p>Whether the values for the <code>beta</code> component
of the link_variance should be approximated by an upper bound.</p></dd>


<dt id="arg-pif-list">pif_list<a class="anchor" aria-label="anchor" href="#arg-pif-list"></a></dt>
<dd><p>A list of potential impact fractions <code>pif_class</code> so that
the total can be computed from it.</p></dd>


<dt id="arg-pif-weights">pif_weights<a class="anchor" aria-label="anchor" href="#arg-pif-weights"></a></dt>
<dd><p>pif_weights for calculating the total PIF (respectively PAF)
in <code>pif_total</code>.</p></dd>


<dt id="arg-sigma-pif-weights">sigma_pif_weights<a class="anchor" aria-label="anchor" href="#arg-sigma-pif-weights"></a></dt>
<dd><p>link_covariance matrix for the pif_weights when calculating the
total PIF (respectively PAF) in <code>pif_total</code>.</p></dd>


<dt id="arg-pif-transform">pif_transform<a class="anchor" aria-label="anchor" href="#arg-pif-transform"></a></dt>
<dd><p>Transform applied to the <code>pif</code> for summation
in a <code>pif_global_ensemble_class</code> (see section below).</p></dd>


<dt id="arg-pif-deriv-transform">pif_deriv_transform<a class="anchor" aria-label="anchor" href="#arg-pif-deriv-transform"></a></dt>
<dd><p>Derivative of the transform applied to the
<code>pif</code> for summation in a <code>pif_global_ensemble_class</code> (see section below).</p></dd>


<dt id="arg-pif-inverse-transform">pif_inverse_transform<a class="anchor" aria-label="anchor" href="#arg-pif-inverse-transform"></a></dt>
<dd><p>Inverse of the transform applied to the
<code>pif</code> for summation in a <code>pif_global_ensemble_class</code> (see section below).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="properties-of-a-pif-class">Properties of a  <code>pif_class</code><a class="anchor" aria-label="anchor" href="#properties-of-a-pif-class"></a></h2>


<p>Any object that is a <code>pif_class</code> contains a potential impact fraction
with intervals estimated as follows:
$$
 \text{CI}_{\text{Link}} = \text{link}\big(\text{PIF}\big) \pm Z_{\alpha/2}\cdot\sqrt{\textrm{link\_variance}}
$$
and then transformed back using the inverse of the link function <code>inv_link</code>:
$$
 \text{CI}_{\text{PIF}} = \text{link}^{-1}\Big(\text{CI}_{\text{Link}}\Big)
$$</p>
<p>The following are the properties of any <code>pif_class</code></p><dl><dt><code>ci</code></dt>
<dd><p><code>numeric(2)</code> — Lower and upper confidence limits at level <code>conf_level</code>.</p></dd>

<dt><code>link_vals</code></dt>
<dd><p><code>numeric</code> — Entrywise evaluation of the link function at pif: <code>link(pif)</code>.</p></dd>

<dt><code>link_deriv_vals</code></dt>
<dd><p><code>character</code> — Entrywise evaluation of the derivative of the link function (<code>link_deriv</code>) at pif: <code>link(pif)</code>.</p></dd>

<dt><code>link_variance</code></dt>
<dd><p><code>numeric</code> - Estimate for the linked potential impact fraction's variance: <code>variance(link(pif))</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="properties-of-a-pif-atomic-class">Properties of a  <code>pif_atomic_class</code><a class="anchor" aria-label="anchor" href="#properties-of-a-pif-atomic-class"></a></h2>



<p>The <code>pif_atomic_class</code> is a type of <code>pif_class</code> that contains enough
information to compute a potential impact fraction
through the classic formula by Walter:
$$
 \textrm{PIF} = \dfrac{
   \sum\limits_{i=1}^N p_i \text{RR}_i - \sum\limits_{i=1}^N p_i^{\text{cft}} \text{RR}_i
  }{
   \sum\limits_{i=1}^N p_i \text{RR}_i
  }
$$
where the relative risk is a function of a parameter \(\beta_i\)
$$
 \text{RR}_i = \text{rr\_link}(\beta_i)
$$</p>
<p>The <code>pif_atomic_class</code> inherits the properties of a <code>pif_class</code> as well as:</p><dl><dt><code>mu_obs</code></dt>
<dd><p><code>numeric</code> — Average relative risk in the observed population.</p></dd>

<dt><code>mu_cft</code></dt>
<dd><p><code>numeric</code> — Average relative risk in the counterfactual population.</p></dd>

<dt><code>pif</code></dt>
<dd><p><code>numeric</code> — Estimate of the potential impact fraction.</p></dd>

<dt><code>rr_link_deriv_vals</code></dt>
<dd><p><code>character</code> — Entrywise evaluation of the derivative of the link function (<code>link_deriv</code>) at pif: <code>link(pif)</code>.</p></dd>


</dl><p>Confidence intervals are estimated as with any <code>pif_class</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="properties-of-a-pif-global-ensemble-class">Properties of a  <code>pif_global_ensemble_class</code><a class="anchor" aria-label="anchor" href="#properties-of-a-pif-global-ensemble-class"></a></h2>



<p>The <code>pif_global_ensemble_class</code> creates a new potential impact
fraction by summing a weighted combination of potential
impact fractions. In general it computes the following expression:
$$
\textrm{PIF}_{\text{global}} =
 g^{-1}\bigg( \sum\limits_{i = 1}^{N} g\big(w_i \cdot \textrm{PIF}_i\big) \bigg)
$$
where \(g\) is refered to as the <code>pif_transform</code>, its derivative the
<code>pif_deriv_transform</code>, and its inverse <code>pif_inverse_transform</code>.</p>
<p>The <code>pif_global_ensemble_class</code> inherits the properties of a <code>pif_class</code> as well as:</p><dl><dt><code>pif_weights</code></dt>
<dd><p><code>numeric</code> - Vector of weights \(w_i\) for weighting the potential impact fraction.</p></dd>

<dt><code>sigma_pif_weights</code></dt>
<dd><p><code>numeric</code> - Covariance matrix for the <code>pif_weights</code></p></dd>

<dt><code>pif_transform</code></dt>
<dd><p><code>function</code> - Function \(g\) with which to transform the impact fraction before weighting.</p></dd>

<dt><code>pif_deriv_transform</code></dt>
<dd><p><code>function</code> - Derivative of the <code>pif_transform</code>.</p></dd>

<dt><code>pif_inverse_transform</code></dt>
<dd><p><code>function</code> - Inverse of the <code>pif_transform</code>.</p></dd>

<dt><code>type</code></dt>
<dd><p><code>character</code> - Whether the quantity represents a <code>PIF</code> or a <code>PAF</code></p></dd>

<dt><code>coefs</code></dt>
<dd><p><code>numeric</code> - Potential impact fractions used for the global ensemble (each of the \(\text{PIF}_i\).</p></dd>

<dt><code>sum_transformed_weighted_coefs</code></dt>
<dd><p><code>numeric</code> - Sum of the potential impact fractions involved \(\sum g(w_i \text{PIF}_i)\).</p></dd>

<dt><code>pif</code></dt>
<dd><p><code>numeric</code> — Estimate of the potential impact fraction.</p></dd>

<dt><code>covariance</code></dt>
<dd><p><code>numeric</code> — Covariance matrix between the potential impact fractions in <code>coefs</code> (i.e. each entry is\(\text{Cov}(\text{PIF}_i, \text{PIF}_j))\)</p></dd>

<dt><code>variance</code></dt>
<dd><p><code>numeric</code> — Estimate for the variance of <code>pif</code>.</p></dd>


</dl><p>Confidence intervals are estimated as with any <code>pif_class</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="properties-of-a-pif-total-class">Properties of a  <code>pif_total_class</code><a class="anchor" aria-label="anchor" href="#properties-of-a-pif-total-class"></a></h2>



<p>A <code>pif_total_class</code> estimated the potential impact fraction of the
weighted sum of fractions from different (disjoint) dispopulations:
$$
 \textrm{PIF}_{Total} = \sum\limits_{i = 1}^{N} w_i \cdot \textrm{PIF}_i
$$
with \(w_i\) representing the proportions of individuals in each category.
This is a type of <code>pif_global_ensemble_class</code> with <code>pif_transform = identity</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="properties-of-a-pif-ensemble-class">Properties of a  <code>pif_ensemble_class</code><a class="anchor" aria-label="anchor" href="#properties-of-a-pif-ensemble-class"></a></h2>



<p>The ensemble potential impact fraction (representing different relative risks)
for the same outcome is given by the weighted product:
$$
\textrm{PIF}_{Ensemble} = 1 - \prod\limits_{i = 1}^{N} \Big(1 - w_i \textrm{PIF}_i\Big)
$$</p>
<p>However it can be transformed into a <code>pif_global_ensemble_class</code> by
taking the log-complement:
$$
\ln\Big(1 - \textrm{PIF}_{Ensemble}\Big) =  \sum\limits_{i = 1}^{N} \ln\big(1 - w_i \textrm{PIF}_i\big)
$$
hence it is a  <code>pif_global_ensemble_class</code> with <code>pif_transform = log_complement</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rodrigo Zepeda-Tello.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

