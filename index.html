<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate Potential Impact and Population Attributable Fractions with Aggregated Data • deltapif</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimate Potential Impact and Population Attributable Fractions with Aggregated Data">
<meta name="description" content="Uses the delta method to estimate the Potential Impact Fraction (PIF) and the Population Attributable Fraction (PAF) from aggregated data. It creates point-estimates, confidence intervals, and estimates of the variance.">
<meta property="og:description" content="Uses the delta method to estimate the Potential Impact Fraction (PIF) and the Population Attributable Fraction (PAF) from aggregated data. It creates point-estimates, confidence intervals, and estimates of the variance.">
<meta property="og:image" content="https://rodrigozepeda.github.io/deltapif/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">deltapif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Introduction.html">Introduction</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="deltapif-">deltapif <a class="anchor" aria-label="anchor" href="#deltapif-"></a>
</h1>
</div>
<!-- badges: start -->

<p>Calculate both <strong>Potential Impact Fractions (PIF)</strong> and <strong>Population Attributable Fractions (PAF)</strong> for aggregated data and their confidence intervals using the delta method.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of pifes like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"RodrigoZepeda/deltapif"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculating-a-population-attributable-fraction">Calculating a population attributable fraction<a class="anchor" aria-label="anchor" href="#calculating-a-population-attributable-fraction"></a>
</h2>
<p>To estimate a population attributable fraction two ingredients are required:</p>
<ul>
<li>
<code>beta</code>: the relative risk or a value from which to calculate the relative risk (with variance <code>var_beta</code>).</li>
<li>
<code>p</code>: the exposure prevalence (with variance <code>var_p</code>).</li>
</ul>
<p>and in the case of potential impact fractions we also require: - <code>p_cft</code>: the counterfactual prevalence.</p>
<blockquote>
<p><strong>Note</strong> An important hypothesis of the current method is that the relative risk estimate and the prevalence of exposure are both independent in the sense that they were estimated in different populations and studies.</p>
</blockquote>
<p>For example <a href="https://doi.org/10.1001/jamanetworkopen.2022.19672" class="external-link">Lee et al</a> estimate the attributable fraction of smoking on dementia. For that purpose they report the following:</p>
<ul>
<li>A relative risk of <code>1.59 (1.15, 2.20)</code>
</li>
<li>An exposure prevalence of <code>8.5</code>
</li>
</ul>
<p>We can calculate a point estimate of the PAF as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rodrigozepeda.github.io/deltapif/">deltapif</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.085</span>, beta <span class="op">=</span> <span class="fl">1.59</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Population Attributable Fraction ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 4.776% [95% CI: 4.776% to 4.776%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.000</span></span>
<span><span class="co">#&gt; standard_deviation(link(paf)) = 0.000</span></span></code></pre></div>
<p>Note that this follows the formula by <a href="https://doi.org/10.1016/j.gloepi.2021.100062" class="external-link">Levin</a>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">PAF</mtext><mo>=</mo><mfrac><mrow><mi>p</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">RR</mtext><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>p</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">RR</mtext><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\textrm{PAF} = \frac{p \cdot (\text{RR} - 1)}{1 + p \cdot (\text{RR} - 1)}
</annotation></semantics></math></p>
<p>Additional examples show how to calculate the PAF for multiple categories.</p>
<div class="section level3">
<h3 id="adding-uncertainty">Adding uncertainty<a class="anchor" aria-label="anchor" href="#adding-uncertainty"></a>
</h3>
<p>Note that there is no uncertainty in the fraction as we have not inputed the standard deviation of <code>beta</code>. To do so we notice that the variance for the relative risk is actually for the log of beta. We follow the formula from <a href="https://handbook-5-1.cochrane.org/chapter_7/7_7_3_2_obtaining_standard_deviations_from_standard_errors_and.htm" class="external-link">Cochrane’s handbook</a>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">variance</mtext><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>=</mo><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><mfrac><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">upper limit</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">lower limit</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn><mo>×</mo><mn>1.95</mn></mrow></mfrac><msup><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
\text{variance}_{\ln(\beta)} = \Bigg(\frac{\ln(\text{upper limit}) - \ln(\text{lower limit})}{2\times 1.95}\Bigg)^2
</annotation></semantics></math></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.20</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">1.95</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.02766639</span></span></code></pre></div>
<p>And because the uncertainty was specified for the log of the relative risk we use the natural logarithm <code>ln</code> of <code>1.59</code> as our beta where <code>log(1.59) = 0.4637</code> and specify that the way to get our relative risk is through the exponential function. Finally as no uncertainty was given for <code>p</code> we set <code>var_p = 0</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.085</span>, beta <span class="op">=</span> <span class="fl">0.4637</span>, var_beta <span class="op">=</span> <span class="fl">0.02766639</span>, var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Population Attributable Fraction ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 4.775% [95% CI: 0.695% to 8.688%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 2.038</span></span>
<span><span class="co">#&gt; standard_deviation(link(paf)) = 0.021</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="calculating-a-potential-impact-fraction">Calculating a potential impact fraction<a class="anchor" aria-label="anchor" href="#calculating-a-potential-impact-fraction"></a>
</h2>
<p>The paper also considers the potential impact fraction of a 15% reduction of smoking this can be achieved with the <code>pif</code> function by specifying the counterfactual distribution (in this case the 15% reduction results in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.085</mn><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>0.15</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.07225</mn></mrow><annotation encoding="application/x-tex">0.085 \times (1 - 0.15) = 0.07225</annotation></semantics></math>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pifpaf.html">pif</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.085</span>, p_cft <span class="op">=</span> <span class="fl">0.07225</span>, beta <span class="op">=</span> <span class="fl">0.4637</span>, var_beta <span class="op">=</span> <span class="fl">0.02766639</span>, var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Potential Impact Fraction ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PIF = 0.716% [95% CI: 0.115% to 1.314%]</span></span>
<span><span class="co">#&gt; standard_deviation(pif %) = 0.306</span></span>
<span><span class="co">#&gt; standard_deviation(link(pif)) = 0.003</span></span></code></pre></div>
<p>Note that both the PIF and PAF result in similar point estimates and CIs as in <em>Lee et al</em> who report:</p>
<ul>
<li>
<strong>PAF</strong>: 4.9 (1.3-9.3)</li>
<li>
<strong>PIF</strong>: 0.7 (0.2-1.4)</li>
</ul>
</div>
<div class="section level2">
<h2 id="more">More<a class="anchor" aria-label="anchor" href="#more"></a>
</h2>
<p>Visit the <a href="https://rodrigozepeda.github.io/deltapif/">deltapif</a> website for more examples and additional operations you can do with <code>PIF</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing deltapif</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Rodrigo Zepeda-Tello <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=deltapif" class="external-link"><img src="https://www.r-pkg.org/badges/version/pifes" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/RodrigoZepeda/deltapif/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/RodrigoZepeda/pifes/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rodrigo Zepeda-Tello.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
