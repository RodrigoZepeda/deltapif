[{"path":"https://rodrigozepeda.github.io/deltapif/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 deltapif authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction","text":"deltapif package calculates Potential Impact Fractions (PIF) Population Attributable Fractions (PAF) summary data, along confidence intervals, using delta method. vignette provides practical introduction package’s core functionality.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"core-concepts-paf-and-pif","dir":"Articles","previous_headings":"Introduction","what":"Core Concepts: PAF and PIF","title":"Introduction","text":"Population Attributable Fraction (PAF) answers question: “fraction disease cases population prevented completely eliminated risk factor?” represents maximum possible reduction achievable often interpreted burden disease attributed exposure. Potential Impact Fraction (PIF) general measure. answers: “fraction disease cases prevented changed exposure current distribution specific counterfactual scenario?” PAF specific type PIF counterfactual scenario theoretical minimum risk exposure level (TMREL). remark TMREL always zero. example, TMREL sodium intake specific healthy range (e.g., ~1.6g/day), much little sodium harmful. exposures, smoking, TMREL can indeed zero exposure. Example: Trieu et al. (2021) estimates reduction cardiovascular disease cases sodium content packaged foods reduced meet Australian’s government targets. PIF. Estimating reduction sodium consumption changed ideal TMREL 1.6g/day PAF, representing maximum achievable benefit.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"why-the-delta-method","dir":"Articles","previous_headings":"Introduction","what":"Why the Delta Method?","title":"Introduction","text":"package uses delta method calculate confidence intervals PAF PIF. approach offers key advantages: Distribution-Free: doesn’t require assumptions underlying distribution exposure data population, can difficult verify lead bias misspecified. Computational Efficiency:provides direct algebraic formula variance, making faster stable simulation-based methods like Monte Carlo. Transparency: formula can derived understood, offering clarity “black box” methods.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"key-assumption-independent-summary-data-sources-","dir":"Articles","previous_headings":"Introduction","what":"Key assumption: Independent (summary) data sources.","title":"Introduction","text":"deltapif package designed specific, common scenario public health: estimate relative risk (beta) comes one source (e.g., published meta-analysis). estimate exposure prevalence (p) comes separate, independent source (e.g., national survey). delta method implementation relies independence. individual-level data exposure pifpaf package appropriate leverages individual-level variability. individual-level exposure outcome data available source graphPAF package ideal.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"example-1-estimating-the-paf-for-the-proportion-of-dementia-attributable-to-smoking","dir":"Articles","previous_headings":"Examples","what":"Example 1: Estimating the PAF for the proportion of dementia attributable to smoking","title":"Introduction","text":"article M. Lee et al. (2022) estimates PAF dementia associated 12 risk factors (logrr) US adults. package includes data well proportion exposed individuals respective race column (Hispanic, Asian, Black White): example, show calculate population attributable fraction Smoking among 4 race groups calculate Total Population Attributable Fraction overall population. Notice Smoking log relative risk : beta = 0.4637340 variance var_beta = 0.0273858 (= 0.165486566^2). Among hispanic individuals 6.9% (p = 0.069) smoke. Hence PAF : fractions can computed way noting 4.9% non-hispanic asians, 11.7% non-hispanic blacks 8.4% non-hispanic whites smoke:","code":"data(dementiarisk) #>            risk_factor     logrr       sdlog total hispanic asian black white #> 1       Less education 0.4637340 0.119140710  10.7     27.1   6.4  10.6   5.5 #> 2         Hearing loss 0.6626880 0.174038430  10.8     13.1   6.9   6.5  10.6 #> 3                  TBI 0.6097656 0.090990178  17.1     10.3   6.0   9.2  20.1 #> 4         Hypertension 0.4762342 0.167874478  42.2     38.5  38.5  61.0  39.8 #> 5    Excessive alcohol 0.1655144 0.054020949   3.6      2.0   0.7   2.7   4.2 #> 6              Obesity 0.4700036 0.091750556  44.0     48.3  14.6  54.3  43.5 #> 7              Smoking 0.4637340 0.165486566   8.5      6.9   4.9  11.7   8.4 #> 8           Depression 0.6418539 0.103984905   7.4     10.7   4.3   6.6   7.2 #> 9     Social isolation 0.4510756 0.086112272  11.9     24.0   8.0  12.1  10.8 #> 10 Physical inactivity 0.3293037 0.092961816  62.8     68.6  56.6  73.2  61.3 #> 11            Diabetes 0.4317824 0.075776055  28.6     41.0  44.1  37.2  25.4 #> 12       Air pollution 0.0861777 0.009362766  22.8     44.4  55.2  41.3  17.2 paf_hispanic <- paf(p = 0.069, beta = 0.4637340, var_beta = 0.0273858, var_p = 0,                     rr_link = exp, label = \"Hispanic\") paf_hispanic #>  #> ── Population Attributable Fraction: [Hispanic] ── #>  #> PAF = 3.912% [95% CI: 0.569% to 7.142%] #> standard_deviation(paf %) = 1.676 paf_asian <- paf(p = 0.049, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"Asian\") paf_black <- paf(p = 0.117, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"Black\") paf_white <- paf(p = 0.084, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"White\")"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"combining-subpopulations-into-a-total","dir":"Articles","previous_headings":"Examples > Example 1: Estimating the PAF for the proportion of dementia attributable to smoking","what":"Combining subpopulations into a total","title":"Introduction","text":"can calculate total population attributable fraction combining fractions subpopulations weighted proportion population. According Wikipedia distribution 2020 US population race follows: paf_total function computes aggregated paf whole population: set var_weights = 0 covariance matrix known race distribution data (exist just Wikipedia). paf total implements following formula: \\[ \\textrm{PAF}_{\\text{Total}} = w_1 \\cdot \\text{PAF}_{\\text{White}} +   w_2 \\cdot \\text{PAF}_{\\text{Hispanic}} +   w_3 \\cdot \\text{PAF}_{\\text{Black}} +   w_4 \\cdot \\text{PAF}_{\\text{Asian}} \\] weights stand proportion population subgroup. coef, confint, summary, .data.frame functions extended allow user extract information paf (pif): Attributable cases can calculated example using estimates Dhana et al. (2023). estimate number people Alzheimer’s Disease New York, USA 426.5 (400.2, 452.7) thousand. implies variance ((452.7 - 400.2) / 2*qnorm(0.975))^2 = 2647.005.","code":"weights <- c(\"white\" = 0.5784, \"hispanic\" = 0.1873,               \"black\" = 0.1205, \"asian\" = 0.0592)  #Normalized weights to sum to 1 weights <- weights / sum(weights) paf_population <- paf_total(paf_white, paf_hispanic, paf_black,                              paf_asian, weights = weights, var_weights = 0,                             label = \"All\") paf_population #>  #> ── Population Attributable Fraction: [All] ── #>  #> PAF = 4.663% [95% CI: 4.486% to 4.839%] #> standard_deviation(paf %) = 1.979 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 4.722% (sd %: 2.006) --- [White] #> • 3.912% (sd %: 1.676) --- [Hispanic] #> • 6.457% (sd %: 2.694) --- [Black] #> • 2.810% (sd %: 1.218) --- [Asian] #> ──────────────────────────────────────────────────────────────────────────────── as.data.frame(paf_population) #>        value standard_deviation     ci_low      ci_up confidence type label #> 1 0.04662895         0.01979259 0.04486196 0.04839268       0.95  PAF   All attributable_cases(426.5, paf_population, variance = 2647) #>  #> ── Attributable cases: [All] ── #>  #> Attributable cases = 19.887 [95% CI: 2.572 to 37.203] #> standard_deviation(attributable cases) = 883.469"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"why-are-we-using-the-log-relative-risk","dir":"Articles","previous_headings":"Examples > Example 1: Estimating the PAF for the proportion of dementia attributable to smoking","what":"Why are we using the log relative risk?","title":"Introduction","text":"common question case using log relative risk (logrr) exp link relative risks directly. reason depends standard deviation can properly recovered. Recall classic (Wald-type) confidence intervals distance point estimate (case RR) bounds. can see happen example case smoking RR 1.59 [1.15-2.20] : distances ! However log-scale much similar: suggests uncertainty estimated log-scale hence need use log relative risk beta exponentiate (link = exp). Furthermore can go original paper, check methodology conclude confidence interval (hence variance!) estimated using log-relative risk exponentiated. Hence uncertainty propagated log risk exponentiated. Mathematically explanation happens usually relative risks, odds ratios hazard ratios transformed log-scale estimate confidence intervals. can see Wikipedia, example, classic formulas relative risks CIs odds ratios involve log-transform.","code":"2.20 - 1.59 #> [1] 0.61 1.59 - 1.15 #> [1] 0.44 log(2.20) - log(1.59) #> [1] 0.3247233 log(1.59) - log(1.15) #> [1] 0.3239721"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"example-2-estimating-the-pif-for-the-proportion-of-dementia-reduced-by-a-15-reduction-in-smoking-","dir":"Articles","previous_headings":"Examples","what":"Example 2: Estimating the PIF for the proportion of dementia reduced by a 15% reduction in smoking.","title":"Introduction","text":"M. Lee et al. (2022) also estimates proportion dementia cases reduced 15% decrease smoking prevalence. 15% reduction corresponds multiplying current smoking prevalence 1 - 0.15 = 0.85 specified prevalence counterfactual (p_cft) variable: total fraction overall population can aggregated pif_total: can use .data.frame function create data.frame results: Graphically can visualize fractions:  Averted cases can calculated number averted_cases function:","code":"pif_hispanic <- pif(p = 0.069, p_cft = 0.069*0.85, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"Hispanic\") pif_asian    <- pif(p = 0.049, p_cft = 0.049*0.85, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"Asian\") pif_black    <- pif(p = 0.117, p_cft = 0.117*0.85, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"Black\") pif_white    <- pif(p = 0.084, p_cft = 0.084*0.85, beta = 0.4637340, var_beta = 0.0273858,                      var_p = 0, rr_link = exp, label = \"White\") pif_population <- pif_total(pif_white, pif_hispanic, pif_black,                              pif_asian, weights = weights, var_weights = 0,                             label = \"All\") pif_population #>  #> ── Potential Impact Fraction: [All] ── #>  #> PIF = 0.699% [95% CI: 0.695% to 0.703%] #> standard_deviation(pif %) = 0.297 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 0.708% (sd %: 0.301) --- [White] #> • 0.587% (sd %: 0.251) --- [Hispanic] #> • 0.969% (sd %: 0.404) --- [Black] #> • 0.421% (sd %: 0.183) --- [Asian] #> ──────────────────────────────────────────────────────────────────────────────── df <- as.data.frame(pif_population, pif_white, pif_black, pif_hispanic, pif_asian) df #>         value standard_deviation       ci_low       ci_up confidence type #> 1 0.006994343        0.002968888 0.0069537857 0.007034899       0.95  PIF #> 2 0.007082968        0.003009649 0.0011666075 0.012964284       0.95  PIF #> 3 0.009685883        0.004040705 0.0017344947 0.017573937       0.95  PIF #> 4 0.005867629        0.002514437 0.0009271875 0.010783639       0.95  PIF #> 5 0.004214654        0.001826806 0.0006277357 0.007788699       0.95  PIF #>      label #> 1      All #> 2    White #> 3    Black #> 4 Hispanic #> 5    Asian if (requireNamespace(\"ggplot2\", quietly = TRUE)){   library(ggplot2)      df$label <- factor(df$label, levels = df$label)      ggplot(df) +     geom_errorbar(aes(x = label, ymin = ci_low, ymax = ci_up, color = label)) +     geom_point(aes(x = label, y = value, color = label)) +     theme_bw() +     labs(       x = \"Race/Ethnicity\",       y = \"Potential Impact Fraction\",       title = \"Prevented dementia cases\",       subtitle = \"15% reduction in smoking\"     ) +     theme(legend.position = \"none\") +     scale_y_continuous(label = scales::percent_format()) } averted_cases(426.5, pif_population, variance = 2647) #>  #> ── Averted cases: [All] ── #>  #> Averted cases = 2.983 [95% CI: 0.386 to 5.580] #> standard_deviation(averted cases) = 132.520"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"example-3-a-categorical-population-attributable-fraction","dir":"Articles","previous_headings":"Examples","what":"Example 3: A categorical population attributable fraction","title":"Introduction","text":"Pandeya et al. (2015) estimate population attributable fraction different cancers given distinct levels alcohol consumption Australian population. alcohol dataframe included package contains estimate intake alcohol sex well proportion individuals intake-categories: relative risk alcohol varies consumption level (alcohol_g). example case rectal cancer estimated relative risk 1.10 (1.07–1.12) per 10g/day. need compute relative risk consumption level groups using median intake follows: want add uncertainty can approximate covariance relative risk follows: can repeat process females: total fraction can computed paf_total assuming males females 50% population:","code":"data(alcohol) #>     sex alcohol_g median_intake age_18_plus #> 1  MALE      None           0.0        47.2 #> 2  MALE   >0-<1 g           0.8         1.4 #> 3  MALE     1-<2g           1.6         2.2 #> 4  MALE     2-<5g           3.2         8.1 #> 5  MALE    5-<10g           7.1         8.1 #> 6  MALE   10-<15g          12.6         6.9 #> 7  MALE   15-<20g          17.4         4.6 #> 8  MALE   20-<30g          24.5         7.3 #> 9  MALE   30-<40g          34.7         4.2 #> 10 MALE   40-<50g          44.2         3.2 #> 11 MALE   50-<60g          54.4         2.0 #> 12 MALE      ≥60g          85.2         4.8 #Get alcohol intake for men divided by 10 cause RR is per 10g/day alcohol_men_intake <- c(0, 0.8, 1.6, 3.2, 7.1, 12.6, 17.4, 24.5, 34.7, 44.2, 54.4, 85.2) / 10   #Divided by 10 cause risk is per 10 g/day relative_risk <- exp(log(1.10)*alcohol_men_intake)  #Divide by 100 to get the prevalence in decimals prevalence    <- c(0.472, 0.014, 0.022, 0.081, 0.081, 0.069, 0.046, 0.073, 0.042, 0.032, 0.02, 0.048)  #Calculate the paf paf(prevalence, beta = relative_risk, var_p = 0, var_b = 0) #>  #> ── Population Attributable Fraction: [deltapif-0102908670119104] ── #>  #> PAF = 70.114% [95% CI: 70.114% to 70.114%] #> standard_deviation(paf %) = 0.000 #Calculate covariance of the betas given by variance*intake_i*intake_j beta_sd <- (1.12 - 1.07) / (2*qnorm(0.975)) beta_var <- matrix(NA, ncol = length(prevalence), nrow = length(prevalence)) for (k in 1:length(prevalence)){   for (j in 1:length(prevalence)){     beta_var[k,j] <- beta_sd^2*(alcohol_men_intake[j])*(alcohol_men_intake[k])   } }  #Calculate the paf paf_males <- paf(prevalence, beta = relative_risk, var_p = 0, var_b = beta_var,                 label = \"Males\") paf_males #>  #> ── Population Attributable Fraction: [Males] ── #>  #> PAF = 70.114% [95% CI: 68.480% to 71.663%] #> standard_deviation(paf %) = 0.812 #Get alcohol intake for women divided by 10 cause RR is per 10g/day alcohol_female_intake <- c(0, 0.8, 1.6, 3.9, 7.1, 12.6, 17.4, 24.5, 34.7, 44.2, 54.4, 78.1) / 10  #Divided by 10 cause risk is per 10 g/day relative_risk <- exp(log(1.10)*alcohol_female_intake)  #Divide by 100 to get the prevalence in decimals prevalence    <- c(0.603, 0.02, 0.054, 0.091, 0.081, 0.061, 0.026, 0.034, 0.015, 0.007, 0.003, 0.005)  #Calculate covariance of the betas given by variance*intake_i*intake_j beta_sd <- (1.12 - 1.07) / (2*qnorm(0.975)) beta_var <- matrix(NA, ncol = length(prevalence), nrow = length(prevalence)) for (k in 1:length(prevalence)){   for (j in 1:length(prevalence)){     beta_var[k,j] <- beta_sd^2*(alcohol_female_intake[j])*(alcohol_female_intake[k])   } }  #Calculate the paf paf_females <- paf(prevalence, beta = relative_risk, var_p = 0, var_b = beta_var,                     label = \"Females\")  paf_females #>  #> ── Population Attributable Fraction: [Females] ── #>  #> PAF = 65.264% [95% CI: 64.737% to 65.784%] #> standard_deviation(paf %) = 0.267 paf_total(paf_males, paf_females, weights = c(0.5, 0.5)) #>  #> ── Population Attributable Fraction: [deltapif-0974069593265456] ── #>  #> PAF = 67.689% [95% CI: 67.426% to 67.950%] #> standard_deviation(paf %) = 0.427 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 70.114% (sd %: 0.812) --- [Males] #> • 65.264% (sd %: 0.267) --- [Females] #> ────────────────────────────────────────────────────────────────────────────────"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"example-4-combining-fractions-of-different-risks-into-an-ensemble","dir":"Articles","previous_headings":"Examples","what":"Example 4: Combining fractions of different risks into an ensemble","title":"Introduction","text":"M. Lee et al. (2022) combines multiple population attributable fractions different risk exposures can combined single fraction. example, can create attributable fraction behavioral risk factors joining fractions : smoking, physical inactivity, excesive alcohol consumption one fraction represents reduction cases exposures taken level minimum risk. purpose calculate fractions separately use paf_ensemble function join . first obtain log-relative risk, standard deviation, total proportion individuals exposed (highlight part table): calculate population attributable fraction : paf_ensemble function allows calculate ensemble paf estimating product: \\[ \\textrm{PAF}_{\\text{Ensemble}} = 1 - (1 - w_1 \\cdot\\textrm{PAF}_{\\text{Alcohol}})\\cdot (1 - w_2 \\cdot\\textrm{PAF}_{\\text{Smoking}})\\cdot (1 - w_3\\cdot \\textrm{PAF}_{\\text{Physical}}) \\] weights oftentimes calculated via communality correction set 1 disjointed risks. case paper communality estimates : Physical inactivity: 31.1 Smoking: 5.9 Excessive alcohol: 3.8 hence can use weights argument: Finally, variance among weights can implemented var_weights argument providing variance-covariance matrix:","code":"data(dementiarisk) #>            risk_factor     logrr      sdlog total #> 5    Excessive alcohol 0.1655144 0.05402095   3.6 #> 7              Smoking 0.4637340 0.16548657   8.5 #> 10 Physical inactivity 0.3293037 0.09296182  62.8 paf_alcohol  <- paf(p = 0.036, beta = 0.1655144, var_beta = 0.05402095^2,                      var_p = 0, label = \"Alcohol\") paf_smoking  <- paf(p = 0.085, beta = 0.4637340, var_beta = 0.16548657^2,                      var_p = 0, label = \"Smoking\") paf_physical <- paf(p = 0.628, beta = 0.3293037, var_beta = 0.09296182^2,                      var_p = 0, label = \"Physical Activity\") paf_ensemble(paf_alcohol, paf_physical, paf_smoking,               weights = c(0.038, 0.311, 0.059),              label = \"Behavioural factors\") #>  #> ── Population Attributable Fraction: [Behavioural factors] ── #>  #> PAF = 6.406% [95% CI: 6.202% to 6.610%] #> standard_deviation(paf %) = 1.627 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 0.644% (sd %: 0.227) --- [Alcohol] #> • 19.674% (sd %: 5.236) --- [Physical Activity] #> • 4.776% (sd %: 2.028) --- [Smoking] #> ──────────────────────────────────────────────────────────────────────────────── #Variance covariance matrix weight_variance <- matrix(   c( 1.00, 0.21, -0.02,       0.21, 1.00,  0.09,     -0.02, 0.09,  1.00), byrow = TRUE, ncol = 3 ) colnames(weight_variance) <- c(\"Alcohol\", \"Physical inactivity\", \"Smoking\") rownames(weight_variance) <- c(\"Alcohol\", \"Physical inactivity\", \"Smoking\")  paf_ensemble(paf_alcohol, paf_physical, paf_smoking,               weights     = c(0.038, 0.311, 0.059),              var_weights = weight_variance,              label       = \"Behavioural factors\") #>  #> ── Population Attributable Fraction: [Behavioural factors] ── #>  #> PAF = 6.406% [95% CI: 3.807% to 9.005%] #> standard_deviation(paf %) = 20.699 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 0.644% (sd %: 0.227) --- [Alcohol] #> • 19.674% (sd %: 5.236) --- [Physical Activity] #> • 4.776% (sd %: 2.028) --- [Smoking] #> ────────────────────────────────────────────────────────────────────────────────"},{"path":"https://rodrigozepeda.github.io/deltapif/articles/Introduction.html","id":"example-6-ensuring-non-negative-fractions","dir":"Articles","previous_headings":"Examples","what":"Example 6: Ensuring non-negative fractions","title":"Introduction","text":"S. Lee et al. (2024) show example relative risk rr = 7.0 (log relative risk 1.94591) log-variance 0.35. results negative confidence interval applying directly delta method: pif paf functions contain logit link option guaranteeing positivity fraction’s intervals: remark option turned default positivity fraction depends : relative risk strictly greater 1. Epidemiological rationale fraction positive.","code":"paf(p = 0.05, beta = 1.94, var_beta = 0.591^2, var_p = 0) #>  #> ── Population Attributable Fraction: [deltapif-048005348427113] ── #>  #> PAF = 22.955% [95% CI: -5.100% to 43.520%] #> standard_deviation(paf %) = 12.206 paf(p = 0.05, beta = 1.94, var_beta = 0.591^2, var_p = 0, link = \"logit\") #>  #> ── Population Attributable Fraction: [deltapif-0604829354215209] ── #>  #> PAF = 22.955% [95% CI: 7.152% to 53.541%] #> standard_deviation(paf %) = 12.206"},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rodrigo Zepeda-Tello. Author, maintainer.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zepeda-Tello R (2026). deltapif: Estimate Potential Impact Population Attributable Fractions Aggregated Data. R package version 0.4.1, https://rodrigozepeda.github.io/deltapif/.","code":"@Manual{,   title = {deltapif: Estimate Potential Impact and Population Attributable Fractions with Aggregated Data},   author = {Rodrigo Zepeda-Tello},   year = {2026},   note = {R package version 0.4.1},   url = {https://rodrigozepeda.github.io/deltapif/}, }"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"deltapif-","dir":"","previous_headings":"","what":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"deltapif R package calculates Potential Impact Fractions (PIF) Population Attributable Fractions (PAF) aggregated data. uses delta method derive confidence intervals, providing robust approach quantifying burden disease attributable risk factors potential impact interventions.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"can install development version deltapif GitHub :","code":"remotes::install_github(\"RodrigoZepeda/deltapif\")"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"package provides two core functions: paf(): Calculates Population Attributable Fraction. pif(): Calculates Potential Impact Fraction. functions require: p: exposure prevalence population. beta: log-relatieve risk coefficient(s) (value relative risk can obtained). var_p, var_beta: Variances prevalence log-relative risk estimates. pif() function additionally requires: p_cft: counterfactual exposure prevalence intervention scenario. Note key assumption delta method implementation relative risk exposure prevalence estimates independent (.e., derived different studies populations).","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"population-attributable-fraction-paf","dir":"","previous_headings":"Usage","what":"Population Attributable Fraction (PAF)","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Lee et al. (2022) estimated fraction dementia cases attributable smoking US. reported: relative risk 1.59 (95% CI: 1.15, 2.20) smoking prevalence 8.5% point estimate PAF can calculated using Levin’s formula:","code":"library(deltapif)  paf(p = 0.085, beta = 1.59, quiet = TRUE) #>  #> ── Population Attributable Fraction: [deltapif-063978701225508] ── #>  #> PAF = 24.915% [95% CI: 24.915% to 24.915%] #> standard_deviation(paf %) = 0.000"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"incorporating-uncertainty","dir":"","previous_headings":"Usage > Population Attributable Fraction (PAF)","what":"Incorporating Uncertainty","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"calculate confidence intervals, need variance log-relative risk. variance can derived confidence interval following Cochrane Handbook: provide log-relative risk (log(1.59)) variance paf(), specifying rr_link exp convert coefficient relative risk exponentiating log. Since prevalence variance reported, set var_p = 0. results match reported Lee et al.: PAF = 4.9% (95% CI: 1.3–9.3).","code":"var_log_rr <- ((log(2.20) - log(1.15)) / (2 * 1.96))^2 var_log_rr #> [1] 0.0273848 paf_dementia <- paf(   p = 0.085,    beta = log(1.59),    var_beta = var_log_rr,    var_p = 0,    rr_link = exp ) paf_dementia #>  #> ── Population Attributable Fraction: [deltapif-0685736966379462] ── #>  #> PAF = 4.776% [95% CI: 0.717% to 8.669%] #> standard_deviation(paf %) = 2.028"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"potential-impact-fraction-pif","dir":"","previous_headings":"Usage","what":"Potential Impact Fraction (PIF)","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Lee et al. (2022) also considered scenario reducing smoking prevalence 15% (8.5% 7.225%). PIF intervention : result consistent reported estimate: PIF = 0.7% (95% CI: 0.2–1.4).","code":"lee_pif <- pif(   p = 0.085,    p_cft = 0.085 * (1 - 0.15), # 15% reduction   beta = log(1.59),    var_beta = var_log_rr,    var_p = 0,    rr_link = exp ) lee_pif #>  #> ── Potential Impact Fraction: [deltapif-146652105400366] ── #>  #> PIF = 0.716% [95% CI: 0.118% to 1.311%] #> standard_deviation(pif %) = 0.304"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"attributable-and-averted-cases","dir":"","previous_headings":"Usage","what":"Attributable and averted cases","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Attributable averted cases can calculated attributable_cases function. example Dhana et al estimate number people Alzheimer’s Disease New York, USA 426.5 (400.2, 452.7) thousand. implies variance ((452.7 - 400.2) / 2*qnorm(0.975))^2 = 2647.005. number cases (thousands) averted reduced smoking 15% assuming prevalence smoking identical rest US given : used link = \"log\" transformation guarantee positivity confidence interval. Attributable cases can likewise estimated using previous paf :","code":"averted_cases(426.5, lee_pif, variance = 2647.005, link = \"log\") #>  #> ── Averted cases: [deltapif-146652105400366] ── #>  #> Averted cases = 3.055 [95% CI: 0.937 to 9.956] #> standard_deviation(averted cases) = 184.148 attributable_cases(426.5, paf_dementia, variance = 2647.005, link = \"log\") #>  #> ── Attributable cases: [deltapif-0685736966379462] ── #>  #> Attributable cases = 20.368 [95% CI: 6.250 to 66.374] #> standard_deviation(attributable cases) = 1,227.655"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"combining-fractions-from-subpopulations","dir":"","previous_headings":"Usage","what":"Combining fractions from subpopulations","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Multiple fractions can combined totals ensembles. example fraction among men women can combined overall fraction specifying distribution subgroups population: Assuming distribution 51% women 49% men: equivalent calculating: \\[ \\textrm{PAF}_{\\text{}} = 0.49 \\cdot \\text{PAF}_{\\text{Men}} + 0.51 \\cdot \\text{PAF}_{\\text{Women}} \\]","code":"paf_men   <- paf(p = 0.41, beta = 0.31, var_p = 0.001,                  var_beta = 0.14,                  label = \"Men\") paf_women <- paf(p = 0.37, beta = 0.35, var_p = 0.001,                   var_beta = 0.16,                  label = \"Women\") paf_total(paf_men, paf_women, weights = c(0.49, 0.51)) #>  #> ── Population Attributable Fraction: [deltapif-0892382911349468] ── #>  #> PAF = 13.201% [95% CI: 11.287% to 15.073%] #> standard_deviation(paf %) = 7.885 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 12.968% (sd %: 15.867) --- [Men] #> • 13.424% (sd %: 15.773) --- [Women] #> ────────────────────────────────────────────────────────────────────────────────"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"combining-fractions-from-multiple-risks","dir":"","previous_headings":"Usage","what":"Combining fractions from multiple risks","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Fractions disjointed risks can calculated ensemble. example fraction exposure lead fraction exposure asbestus: fraction environmental exposure considering can calculated multiplying inverse fractions, assuming commonality correction (say c(0.1, 0.2)): quantity estimates: \\[ \\textrm{PAF}_{\\text{Ensemble}} = 1 - (1 - 0.1 \\cdot \\textrm{PAF}_{\\text{Lead}}) \\cdot (1 - 0.2 \\cdot \\textrm{PAF}_{\\text{Asbestus}}) \\]","code":"paf_lead  <- paf(p = 0.41, beta = 0.31, var_p = 0.001,                  var_beta = 0.14,                  label = \"Lead\") paf_absts <- paf(p = 0.37, beta = 0.35, var_p = 0.001,                   var_beta = 0.16,                  label = \"Asbestus\") paf_ensemble(paf_lead, paf_absts, weights = c(0.1, 0.2)) #>  #> ── Population Attributable Fraction: [deltapif-0671407130462526] ── #>  #> PAF = 3.947% [95% CI: 3.778% to 4.116%] #> standard_deviation(paf %) = 2.186 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 12.968% (sd %: 15.867) --- [Lead] #> • 13.424% (sd %: 15.773) --- [Asbestus] #> ────────────────────────────────────────────────────────────────────────────────"},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"learn-more","dir":"","previous_headings":"","what":"Learn More","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"detailed examples, including multi-category risk factors, combining fractions total see package’s website. See vignette: Introduction deltapif","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Estimate Potential Impact and Population Attributable Fractions with Aggregated Data","text":"Contributions welcome! Please file issues pull requests GitHub.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/alcohol.html","id":null,"dir":"Reference","previous_headings":"","what":"Alcohol consumption in Australia from Pandeya et al — alcohol","title":"Alcohol consumption in Australia from Pandeya et al — alcohol","text":"Alcohol consumption among Australian adults grams/day","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/alcohol.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alcohol consumption in Australia from Pandeya et al — alcohol","text":"","code":"alcohol"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/alcohol.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Alcohol consumption in Australia from Pandeya et al — alcohol","text":"data frame 12 rows 11 columns: sex Whether individuals male female alcohol_g Category measure grams alcohol consumption median_intake median intake group age_18_24, age_25_34, age_35_44, age_45_54, age_55_64, age_65_74, age_75_plus, age_18_plus Proportion adults alcohol_g categories (age group).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/alcohol.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alcohol consumption in Australia from Pandeya et al — alcohol","text":"Pandeya, Nirmala, et al. \"Cancers Australia 2010 attributable consumption alcohol.\" Australian New Zealand journal public health 39.5 (2015): 408-413.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.data.frame.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform a pif object into a data.frame — as.data.frame","title":"Transform a pif object into a data.frame — as.data.frame","text":"Gets potential impact fraction value, link_variance confidence interval values","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.data.frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform a pif object into a data.frame — as.data.frame","text":"x pif_class object. ... Additional parameters (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.data.frame.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform a pif object into a data.frame — as.data.frame","text":"","code":"#Transform one pif my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1,     var_beta = 0.2, label = \"My pif\") as.data.frame(my_pif) #>      value standard_deviation     ci_low     ci_up confidence type  label #> 1 0.285835          0.2689564 -0.4940436 0.6586233       0.95  PIF My pif  #Transform more than one pif my_paf <- paf(p = 0.5, beta = 1.3, var_p = 0.1, var_beta = 0.2,     label = \"My paf\") as.data.frame(my_pif, my_paf) #>      value standard_deviation     ci_low     ci_up confidence type  label #> 1 0.285835          0.2689564 -0.4940436 0.6586233       0.95  PIF My pif #> 2 0.571670          0.2159692 -0.1507069 0.8405618       0.95  PAF My paf  #Transform averted cases cases_1 <- averted_cases(16234, my_paf) as.data.frame(cases_1) #>     value standard_deviation   ci_low    ci_up confidence  label #> 1 9280.49           3506.044 2408.769 16152.21       0.95 My paf  #Transform multiple averted cases cases_2 <- averted_cases(87980, my_pif) as.data.frame(cases_1, cases_2) #>      value standard_deviation     ci_low    ci_up confidence  label #> 1  9280.49           3506.044   2408.769 16152.21       0.95 My paf #> 2 25147.76          23662.784 -21230.442 71525.97       0.95 My pif"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert to list — as.list","title":"Convert to list — as.list","text":"Converts object list.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert to list — as.list","text":"x Either covariance_structure, pif_atomic_class pif_global_ensemble_class ... Additional parameters (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert to list — as.list","text":"object list","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert to list — as.list","text":"","code":"#FOR POTENTIAL IMPACT FRACTIONS #------------------------------------------------------------------------ #Potential impact fraction for women paf_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001,     label = \"Lead women\") paf_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001,     label = \"Radiation women\") paf_women      <- paf_ensemble(paf_lead_women, paf_rad_women,     label = \"Women\")  as.list(paf_women) #> $Women #>  #> ── Population Attributable Fraction: [Women] ── #>  #> PAF = 75.299% [95% CI: 71.706% to 78.892%] #> standard_deviation(paf %) = 2.435 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 68.422% (sd %: 2.531) --- [Lead women] #> • 21.778% (sd %: 4.489) --- [Radiation women] #> ──────────────────────────────────────────────────────────────────────────────── #>  #> $`Lead women` #>  #> ── Population Attributable Fraction: [Lead women] ── #>  #> PAF = 68.422% [95% CI: 63.051% to 73.012%] #> standard_deviation(paf %) = 2.531 #>  #> $`Radiation women` #>  #> ── Population Attributable Fraction: [Radiation women] ── #>  #> PAF = 21.778% [95% CI: 12.466% to 30.100%] #> standard_deviation(paf %) = 4.489 #>   #FOR COVARIANCE STRUCTURES #------------------------------------------------------------------------ cov_str <- default_parameter_covariance_structure(paf_women) as.list(cov_str) #> $Women #> $Women$Women #> [1] 0 #>  #> $Women$`Lead women` #> [1] 0 #>  #> $Women$`Radiation women` #> [1] 0 #>  #>  #> $`Lead women` #> $`Lead women`$Women #> [1] 0 #>  #> $`Lead women`$`Lead women` #> [1] 0.001 #>  #> $`Lead women`$`Radiation women` #> [1] 0 #>  #>  #> $`Radiation women` #> $`Radiation women`$Women #> [1] 0 #>  #> $`Radiation women`$`Lead women` #> [1] 0 #>  #> $`Radiation women`$`Radiation women` #> [1] 0.001 #>  #>"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a covariance_structure to matrix — as.matrix","title":"Convert a covariance_structure to matrix — as.matrix","text":"Transforms covariance_structure matrix.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a covariance_structure to matrix — as.matrix","text":"x covariance_structure ... Additional parameters (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as.matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a covariance_structure to matrix — as.matrix","text":"","code":"as.matrix(covariance_structure_class(list(b = list(a = 1:3)))) #>      [,1] #> [1,]    1 #> [2,]    2 #> [3,]    3"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as_covstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform into a covariance structure — as_covstr","title":"Transform into a covariance structure — as_covstr","text":"Transforms either matrix vector covariance structure.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as_covstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform into a covariance structure — as_covstr","text":"","code":"as_covariance_structure(x, col_names = NULL, row_names = NULL, ...)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as_covstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform into a covariance structure — as_covstr","text":"x matrix vector col_names Names assign columns row_names Names assign rows ... Additional arguments (currently ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/as_covstr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform into a covariance structure — as_covstr","text":"","code":"mat <- matrix(c(1,3,2,4), ncol = 2,           dimnames = list(list(\"pif1\", \"pif2\"), list(\"pif1\", \"pif2\"))) as_covariance_structure(mat) #>      pif1 pif2 #> pif1 1    2    #> pif2 3    4     #Different colnames than dimnames as_covariance_structure(mat, col_names = c(\"first\", \"second\")) #>      first second #> pif1 1     2      #> pif2 3     4       #Also with a number as_covariance_structure(2, col_names = \"col\", row_names = \"row\") #>     col #> row 2    #Or with a vector as_covariance_structure(seq(0.1, 0.2, length.out = 4),     row_names = c(\"r1\",\"r2\",\"r3\",\"r4\"), col_names = \"col\") #>    col               #> r1 0.1               #> r2 0.133333333333333 #> r3 0.166666666666667 #> r4 0.2                #As well as a data.frame data_mat <- as.data.frame(mat) as_covariance_structure(data_mat, row_names = c(\"r1\",\"r2\")) #>    pif1 pif2 #> r1 1    2    #> r2 3    4"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cancer_rr.html","id":null,"dir":"Reference","previous_headings":"","what":"Relative risks for cancer from Pandeya et al — cancer_rr","title":"Relative risks for cancer from Pandeya et al — cancer_rr","text":"Relative risks cancer given different levels alcohol consumption","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cancer_rr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relative risks for cancer from Pandeya et al — cancer_rr","text":"","code":"cancer_rr"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cancer_rr.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Relative risks for cancer from Pandeya et al — cancer_rr","text":"data frame 24 rows 5 columns: cancer_type type cancer associated relative risk dose Dose grams/day relative risk estimated RR Relative risk cancer given dose alcohol lower_CI, upper_CI Lower upper bounds 95% confidence interval","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cancer_rr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Relative risks for cancer from Pandeya et al — cancer_rr","text":"Pandeya, Nirmala, et al. \"Cancers Australia 2010 attributable consumption alcohol.\" Australian New Zealand journal public health 39.5 (2015): 408-413.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":null,"dir":"Reference","previous_headings":"","what":"Attributable cases — casecalc","title":"Attributable cases — casecalc","text":"Calculates number attributable cases number cases averted counterfactual scenario given fraction (either paf pif).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attributable cases — casecalc","text":"","code":"averted_cases(   cases,   pif,   variance = 0,   conf_level = 0.95,   link = \"identity\",   link_inv = NULL,   link_deriv = NULL )  attributable_cases(   cases,   paf,   variance = 0,   conf_level = 0.95,   link = \"identity\",   link_inv = NULL,   link_deriv = NULL )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attributable cases — casecalc","text":"cases overall number cases population. pif potential impact fraction object created pif, paf, pif_total, pif_ensemble, paf_total paf_ensemble. variance estimated variance cases (default = 0). conf_level Confidence level confidence interval (default 0.95). link Link function case confidence intervals stay within expected bounds (either logit identity). link_inv inverse link. example link logit inv_logit. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv(). paf population attributable fraction object created paf, paf_total paf_ensemble.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attributable cases — casecalc","text":"cases_class object attributable cases.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attributable cases — casecalc","text":"Negative cases interpreted cases caused intervention.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"formulas","dir":"Reference","previous_headings":"","what":"Formulas","title":"Attributable cases — casecalc","text":"attributable cases calculated : $$ \\text{Attributable cases} = \\textrm{PAF} \\times \\textrm{Cases} $$ averted cases respectively: $$ \\text{Averted cases} = \\textrm{PIF} \\times \\textrm{Cases} $$ variance estimated using product-variance formula: $$ \\textrm{Var}[\\text{Averted cases}] =  \\sigma^2_{\\textrm{Cases}} \\cdot \\big( \\textrm{PIF}\\big)^2 +  \\sigma^2_{\\textrm{PIF}} \\cdot \\big( \\textrm{Cases} \\big)^2 +  \\sigma^2_{\\textrm{PIF}} \\cdot \\sigma^2_{\\textrm{Cases}} $$","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/casecalc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Attributable cases — casecalc","text":"","code":"frac <- paf(p = 0.499, beta = log(3.6), var_p = 0.002, var_beta = FALSE) attributable_cases(100, paf = frac) #>  #> ── Attributable cases: [deltapif-275541757533686] ── #>  #> Attributable cases = 56.473 [95% CI: 52.155 to 60.790] #> standard_deviation(attributable cases) = 220.300  frac <- pif(p = 0.499, beta = log(3.6), p_cft = 0.1, var_p = 0.002, var_beta = FALSE) averted_cases(100, pif = frac) #>  #> ── Averted cases: [deltapif-00465313804441933] ── #>  #> Averted cases = 45.155 [95% CI: 39.715 to 50.596] #> standard_deviation(averted cases) = 277.578"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/change_link.html","id":null,"dir":"Reference","previous_headings":"","what":"Change the link — change_link","title":"Change the link — change_link","text":"Change link function potential impact fraction population attributable fraction different link.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/change_link.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Change the link — change_link","text":"","code":"change_link(x, link = \"identity\", link_inv = NULL, link_deriv = NULL)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/change_link.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Change the link — change_link","text":"x pif_class object link Link function pif confidence intervals stays within expected bounds. link_inv inverse link. example link logit inv_logit. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv().","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/change_link.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Change the link — change_link","text":"pif_class object different link.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/change_link.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Change the link — change_link","text":"","code":"#A potential impact fraction pif1 <- pif(p = 0.2, p_cft = 0.1, beta = 1.2, var_p = 0.01,   var_beta = 0.2) pif1 #>  #> ── Potential Impact Fraction: [deltapif-0118194874409683] ── #>  #> PIF = 15.848% [95% CI: -19.419% to 40.699%] #> standard_deviation(pif %) = 15.028  #Now change the pif to logit to control the negatives pif1_logit <- change_link(pif1, link = \"logit\") pif1_logit #>  #> ── Potential Impact Fraction: [deltapif-0118194874409683] ── #>  #> PIF = 15.848% [95% CI: 2.027% to 63.158%] #> standard_deviation(pif %) = 15.028"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/children.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the children labels from a pif_class — children","title":"Get the children labels from a pif_class — children","text":"Gets labels pif elements make pif_global_ensemble_class.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/children.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the children labels from a pif_class — children","text":"","code":"children(x, ...)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/children.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the children labels from a pif_class — children","text":"x pif_global_ensemble_class ... Additional arguments (currently ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/children.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the children labels from a pif_class — children","text":"character vector names fractions make x","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/children.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Get the children labels from a pif_class — children","text":"result NULL x pif_atomic_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":null,"dir":"Reference","previous_headings":"","what":"Potential Impact Fraction related classes — classes","title":"Potential Impact Fraction related classes — classes","text":"Objects handling potential impact fractions categorical exposure considering observed prevalence  p relative risk (relative risk parameter) beta.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Potential Impact Fraction related classes — classes","text":"","code":"pif_class(   pif = integer(0),   variance = integer(0),   conf_level = integer(0),   label = character(0),   type = \"PIF\",   link = function() NULL,   link_inv = function() NULL,   link_deriv = function() NULL )  cases_class(   overall_cases,   pif_obj,   variance_cases,   link,   link_deriv,   link_inv,   conf_level )  pif_atomic_class(   p,   p_cft,   beta,   var_p,   var_beta,   rr_link,   rr_link_deriv,   link,   link_deriv,   link_inv,   conf_level,   type,   label,   upper_bound_p,   upper_bound_beta )  pif_global_ensemble_class(   pif_list,   weights,   var_weights,   var_pif_weights,   pif_transform,   pif_deriv_transform,   pif_inverse_transform,   link,   link_inv,   link_deriv,   conf_level = 0.95,   label )  pif_total_class(   pif_list,   weights,   var_weights,   var_pif_weights,   link,   link_inv,   link_deriv,   conf_level = 0.95,   label )  pif_ensemble_class(   pif_list,   weights,   var_weights,   var_pif_weights,   link,   link_inv,   link_deriv,   conf_level = 0.95,   label )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Potential Impact Fraction related classes — classes","text":"pif Potential Impact Fraction estimate variance variance estimate potential impact fraction (.e. pif) conf_level Confidence level confidence interval (default 0.95). label Character identifier impact fraction. type Character either Potential Impact Fraction (PIF) Population Attributable Fraction (PAF) link Link function pif confidence intervals stays within expected bounds. link_inv inverse link. example link logit inv_logit. link_deriv derivative link. example link logit deriv_logit (.e. function(pif) 1 / (pif * (1 - pif))). overall_cases Overall number cases attributable cases given overall_cases * pif_obj pif_obj pif_class calculate percentage cases . variance_cases Variance cases estimate. p Prevalence (proportion) exposed individuals N exposure levels. p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. beta Relative risk parameter standard deviation available (usually either relative risk directly log relative risk RRs, ORs HRs come exponential models). var_p Estimate link_covariance matrix p entry var_p[,j] represents link_covariance p[] p[j]. var_beta Estimate link_covariance matrix beta entry var_beta[,j] represents link_covariance beta[] beta[j]. rr_link Link function relative risk given rr_link(beta). rr_link_deriv Derivative link function relative risk. constructor tries build automatically rr_link using Deriv::Deriv(). upper_bound_p Whether values p component link_variance approximated upper bound. upper_bound_beta Whether values beta component link_variance approximated upper bound. pif_list list potential impact fractions pif_class total can computed . weights weights calculating total PIF (respectively PAF) pif_total. var_weights covariance matrix weights calculating total PIF (respectively PAF) pif_total. var_pif_weights covariance matrix row column j representing covariance -th potential impact fraction list j-th weight pif_transform Transform applied pif summation pif_global_ensemble_class (see section ). pif_deriv_transform Derivative transform applied pif summation pif_global_ensemble_class (see section ). pif_inverse_transform Inverse transform applied pif summation pif_global_ensemble_class (see section ).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"properties-of-a-pif-class","dir":"Reference","previous_headings":"","what":"Properties of a  pif_class","title":"Potential Impact Fraction related classes — classes","text":"object pif_class contains potential impact fraction intervals estimated follows: $$  \\text{CI}_{\\text{Link}} = \\text{link}\\big(\\text{PIF}\\big) \\pm Z_{\\alpha/2}\\cdot\\sqrt{\\textrm{link\\_variance}} $$ transformed back using inverse link function inv_link: $$  \\text{CI}_{\\text{PIF}} = \\text{link}^{-1}\\Big(\\text{CI}_{\\text{Link}}\\Big) $$ following properties pif_class ci numeric(2) — Lower upper confidence limits level conf_level. link_vals numeric — Entrywise evaluation link function pif: link(pif). link_deriv_vals character — Entrywise evaluation derivative link function (link_deriv) pif: link(pif). link_variance numeric - Estimate linked potential impact fraction's variance: variance(link(pif)).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"properties-of-a-pif-atomic-class","dir":"Reference","previous_headings":"","what":"Properties of a  pif_atomic_class","title":"Potential Impact Fraction related classes — classes","text":"pif_atomic_class type pif_class contains enough information compute potential impact fraction classic formula Walter: $$  \\textrm{PIF} = \\dfrac{    \\sum\\limits_{=1}^N p_i \\text{RR}_i - \\sum\\limits_{=1}^N p_i^{\\text{cft}} \\text{RR}_i   }{    \\sum\\limits_{=1}^N p_i \\text{RR}_i   } $$ relative risk function parameter \\(\\beta_i\\) $$  \\text{RR}_i = \\text{rr\\_link}(\\beta_i) $$ pif_atomic_class inherits properties pif_class well : mu_obs numeric — Average relative risk observed population. mu_cft numeric — Average relative risk counterfactual population. pif numeric — Estimate potential impact fraction. rr_link_deriv_vals character — Entrywise evaluation derivative link function (link_deriv) pif: link(pif). Confidence intervals estimated pif_class.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"properties-of-a-pif-global-ensemble-class","dir":"Reference","previous_headings":"","what":"Properties of a  pif_global_ensemble_class","title":"Potential Impact Fraction related classes — classes","text":"pif_global_ensemble_class creates new potential impact fraction summing weighted combination potential impact fractions. general computes following expression: $$ \\textrm{PIF}_{\\text{global}} =  g^{-1}\\bigg( \\sum\\limits_{= 1}^{N} g\\big(w_i \\cdot \\textrm{PIF}_i\\big) \\bigg) $$ \\(g\\) refered pif_transform, derivative pif_deriv_transform, inverse pif_inverse_transform. pif_global_ensemble_class inherits properties pif_class well : weights numeric - Vector weights \\(w_i\\) weighting potential impact fraction. var_weights numeric - Covariance matrix weights pif_transform function - Function \\(g\\) transform impact fraction weighting. pif_deriv_transform function - Derivative pif_transform. pif_inverse_transform function - Inverse pif_transform. type character - Whether quantity represents PIF PAF coefs numeric - Potential impact fractions used global ensemble (\\(\\text{PIF}_i\\). sum_transformed_weighted_coefs numeric - Sum potential impact fractions involved \\(\\sum g(w_i \\text{PIF}_i)\\). pif numeric — Estimate potential impact fraction. covariance numeric — Covariance matrix potential impact fractions coefs (.e. entry \\(\\text{Cov}(\\text{PIF}_i, \\text{PIF}_j))\\) variance numeric — Estimate variance pif. Confidence intervals estimated pif_class.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"properties-of-a-pif-total-class","dir":"Reference","previous_headings":"","what":"Properties of a  pif_total_class","title":"Potential Impact Fraction related classes — classes","text":"pif_total_class estimated potential impact fraction weighted sum fractions different (disjoint) dispopulations: $$  \\textrm{PIF}_{Total} = \\sum\\limits_{= 1}^{N} w_i \\cdot \\textrm{PIF}_i $$ \\(w_i\\) representing proportions individuals category. type pif_global_ensemble_class pif_transform = identity.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/classes.html","id":"properties-of-a-pif-ensemble-class","dir":"Reference","previous_headings":"","what":"Properties of a  pif_ensemble_class","title":"Potential Impact Fraction related classes — classes","text":"ensemble potential impact fraction (representing different relative risks) outcome given weighted product: $$ \\textrm{PIF}_{Ensemble} = 1 - \\prod\\limits_{= 1}^{N} \\Big(1 - w_i \\textrm{PIF}_i\\Big) $$ However can transformed pif_global_ensemble_class taking log-complement: $$ \\ln\\Big(1 - \\textrm{PIF}_{Ensemble}\\Big) =  \\sum\\limits_{= 1}^{N} \\ln\\big(1 - w_i \\textrm{PIF}_i\\big) $$ hence  pif_global_ensemble_class pif_transform = log_complement.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients of a pif object — coef","title":"Extract coefficients of a pif object — coef","text":"Gets potential impact fraction value","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients of a pif object — coef","text":"object pif_class object. ... Additional parameters pass coef (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/coef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract coefficients of a pif object — coef","text":"","code":"my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1, var_beta = 0.2) coef(my_pif) #> [1] 0.285835"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract confidence intervals of a pif object — confint","title":"Extract confidence intervals of a pif object — confint","text":"Gets confidence interval potential impact fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract confidence intervals of a pif object — confint","text":"object pif_class object. level Level confidence desired. ... Additional parameters pass confint (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/confint.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract confidence intervals of a pif object — confint","text":"","code":"my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1, var_beta = 0.2) #Default 95% CI confint(my_pif) #> [1] -0.4940436  0.6586233  #Custom 90% ci: confint(my_pif, level = 0.90) #> [1] -0.3268596  0.6156099"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_atomic_pif.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance between two atomic pifs — cov_atomic_pif","title":"Covariance between two atomic pifs — cov_atomic_pif","text":"Calculates approximate covariance two atomic pif class expressions using delta method.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_atomic_pif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance between two atomic pifs — cov_atomic_pif","text":"","code":"cov_atomic_pif(pif1, pif2, var_p = NULL, var_beta = NULL)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_atomic_pif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance between two atomic pifs — cov_atomic_pif","text":"pif1 pif_atomic_class object. pif2 second pif_atomic_class object. var_p covariance matrix prevalences pif1 pif2. Default NULL (correlation). var_beta covariance matrix parameter beta pif1 pif2. Default NULL (correlation).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_atomic_pif.html","id":"computation","dir":"Reference","previous_headings":"","what":"Computation","title":"Covariance between two atomic pifs — cov_atomic_pif","text":" cov_atomic_pif computes approximate covariance two potential impact fractions \\(\\text{PIF}_1\\) \\(\\text{PIF}_2\\) follows: $$ \\text{Cov}\\Big(\\text{PIF}_1, \\text{PIF}_2 \\Big) \\approx \\Bigg(  \\dfrac{\\partial \\text{PIF}_1}{\\partial p_1}^{\\top}  \\Sigma_p  \\dfrac{\\partial \\text{PIF}_2}{\\partial p_2} +  \\dfrac{\\partial \\text{PIF}_1}{\\partial \\beta_1}^{\\top}  \\Sigma_{\\beta}  \\dfrac{\\partial \\text{PIF}_2}{\\partial \\beta_2} \\Bigg) $$ \\(\\Sigma_p\\) var_p  \\(\\Sigma_{\\beta}\\) var_beta. parameters \\(p_1\\) \\(\\beta_1\\) refer prevalence (p) relative risk exposure parameter beta first potential impact fraction pif1  \\(p_2\\) \\(\\beta_2\\) respective parameters pif2.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_atomic_pif.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Covariance between two atomic pifs — cov_atomic_pif","text":"","code":"if (FALSE) { # \\dontrun{ p1 <- pif(p = 0.5, p_cft = 0.1, beta = 0.2, 0.003, 0.04, label = \"Population 1\") p2 <- pif(p = 0.4, p_cft = 0.1, beta = 0.2, 0.003, 0.04, label = \"Population 2\")  #Positive covariance as program automatically detects same beta and p cov_atomic_pif(p1, p2)  #Zero covariance as they have no covariates in common p3 <- pif(p = 0.6, p_cft = 0.1, beta = 0.12, 0.003, 0.04, label = \"Population 3\") cov_atomic_pif(p1, p3)  #Covariance has to be given to specify the covariance between p and/or beta parameters cov_atomic_pif(p1, p3, var_p = 0.12, var_beta = 0.11)  #Works with parameters of different dimensions with entry i-j being the #covariance between entry p[i] of pif1 and entry p[j] of pif2 #(same with the betas) p_dim_3 <- paf(p = c(0.5, 0.2, 0.1), beta = c(0.2, 0.1, 0.4),   label = \"Population 1\", quiet = TRUE) p_dim_2 <- pif(p = c(0.4, 0.1), p_cft = c(0.1, 0.05), beta = c(0.3, 0.8),   label = \"Population 2\", quiet = TRUE) cov_atomic_pif(p_dim_2, p_dim_3,   var_p = matrix(c(0.1, 0.2, 0.4, 0.5, 0.6, 0.08), ncol = 3)) } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_atomic.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","title":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","text":"Calculates covariance potential impact fraction pif_global_ensemble_class  pif_atomic","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_atomic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","text":"","code":"cov_ensemble_atomic(   pif_ensemble,   pif_atomic,   var_p = NULL,   var_beta = NULL,   var_pifs = NULL,   var_pif_weights = NULL,   recursive = !is.null(var_pifs),   warning = TRUE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_atomic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","text":"pif_ensemble pif_global_ensemble_class pif_atomic pif_atomic_class var_pifs Covariance vector potential impact fractions pif_ensemble pif_atomic. refers term \\(\\operatorname{Cov}\\Big( \\textrm{PIF}_{,}, \\widehat{\\textrm{PIF}}_{B,j}\\Big)\\) equation . set NULL automatically calculated. var_pif_weights Covariance vector weights  pif_ensemble pif_atomic. refers term \\(\\operatorname{Cov}\\Big( \\hat{q}_i,\\widehat{\\textrm{PIF}}_{B,j}\\Big)\\) equation . set NULL automatically calculated.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_atomic.html","id":"formula","dir":"Reference","previous_headings":"","what":"Formula","title":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","text":"Given pif_global_ensemble: $$ \\widehat{\\textrm{PIF}}_{1} = g^{-1}\\Bigg(\\sum\\limits_{=1}^{M_1} g(\\hat{q}_i \\cdot \\widehat{\\textrm{PIF}}_{1,})\\Bigg) $$ second pif_global_ensemble: $$ \\widehat{\\textrm{PIF}}_{2} = h^{-1}\\Bigg(\\sum\\limits_{j=1}^{M_2} h(\\hat{w}_j \\cdot \\widehat{\\textrm{PIF}}_{2,j})\\Bigg) $$ function computes covariance first impact fraction coefficients second fraction computing: $$ \\operatorname{Cov}(\\widehat{\\textrm{PIF}}_A, \\widehat{\\textrm{PIF}}_{B,j}) \\approx \\frac{1}{g'\\big(\\widehat{\\textrm{PIF}}_A\\big)}\\sum\\limits_{=1}^{M_1}g'(\\hat{q}_i \\cdot \\widehat{\\textrm{PIF}}_{,}) \\Bigg[ \\hat{q}_i \\operatorname{Cov}\\Big( \\textrm{PIF}_{,}, \\widehat{\\textrm{PIF}}_{B,j}\\Big) +  \\widehat{\\textrm{PIF}}_{,} \\operatorname{Cov}\\Big( \\hat{q}_i, \\widehat{\\textrm{PIF}}_{B,j}\\Big) \\Bigg] $$ \\(\\widehat{\\textrm{PIF}}_{1,:} = (\\widehat{\\textrm{PIF}}_{1,1}, \\widehat{\\textrm{PIF}}_{1,2}, \\dots, \\widehat{\\textrm{PIF}}_{1,M_1})^{\\top}\\)","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_atomic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Covariance between pif_global_ensemble_class and a pif_atomic — cov_ensemble_atomic","text":"","code":"if (FALSE) { # \\dontrun{ #Works for two atomic fractions p1 <- paf(c(0.1, 0.2), beta = c(0.01, 0.14), var_p = diag(c(0.01, 0.011)),   var_beta = diag(c(0.51, 0.3)), label =\"1\") p2 <- paf(c(0.2, 0.3), beta = c(0.01, 0.14), var_p = diag(c(0.06, 0.052)),   var_beta = diag(c(0.51, 0.3)), label = \"2\") cov_ensemble_atomic(p1, p2)  #Works for fractions with ensembles pt1 <- paf_total(p1, p2, weights = c(0.1, 0.9), var_weights = diag(c(0.6, 0.2)),   label =\"total\") p3 <- paf(c(0.1, 0.2), beta = c(0.01, 0.14), var_p = diag(c(0.01, 0.011)),   var_beta = 0, label = \"3\") cov_ensemble_atomic(pt1, p3)  #Changes if it changes to ensemble p4 <- paf(c(0.2, 0.3), beta = c(0.01, 0.15), var_p = diag(c(0.06, 0.052)),   var_beta = 0, label = \"4\") p5 <- paf(c(0.2, 0.3), beta = c(0.01, 0.15), var_p = diag(c(0.06, 0.052)),   var_beta = 0, label = \"5\") pe1 <- paf_ensemble(p3, p4, p5, weights = c(0.1, 0.5, 0.4),   var_weights = diag(c(0.6, 0.2, 0.1)), label = \"ensemble\")  #This returns the correlation of pt1 with its weights cov_ensemble_atomic(pe1, p1)  #You can also specify var_weights as either a matrix var_pif_weights <- matrix(c(0.01, 0.03, 0.021), ncol = 1) cov_ensemble_atomic(pe1, p1, var_pif_weights = var_pif_weights)  #or a covariance structure: var_pif_weights2     <- default_weight_covariance_structure2(pe1, p1) var_pif_weights2[[p3@label]][[p1@label]]  <- var_pif_weights[1] var_pif_weights2[[p1@label]][[p3@label]]  <- var_pif_weights[1] var_pif_weights2[[p4@label]][[p1@label]]  <- var_pif_weights[2] var_pif_weights2[[p1@label]][[p4@label]]  <- var_pif_weights[2] var_pif_weights2[[p5@label]][[p1@label]]  <- var_pif_weights[3] var_pif_weights2[[p1@label]][[p5@label]]  <- var_pif_weights[3]  cov_ensemble_atomic(pe1, p1, var_pif_weights = var_pif_weights2)  } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance between a pif and a weight — cov_ensemble_weights","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"Calculates covariance weight potential impact fraction pif_global_ensemble_class second pif_global_ensemble_class pif_atomic_class.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"","code":"cov_ensemble_weights(   pif1,   pif2,   var_weights = NULL,   var_pif_weights = NULL,   recursive = !is.null(var_pif_weights) )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"pif1 pif_global_ensemble_class weight taken. pif2 pif_global_ensemble_class pif_atomic_class compute covariance var_weights Covariance matrix weights pif1 weights pif2. Entry var_weights[,j] covariance ith weight pif1 jth weight pif2. refers term \\(\\operatorname{Cov}\\Big( \\hat{q}_i,\\hat{w}_j\\Big)\\) equation . var_pif_weights Covariance structure potential impact fractions pif1 weights pif2. Entry var_pif_weights[,j] covariance ith fraction pif1 jth weight pif2. refers term \\(\\operatorname{Cov}\\Big(\\widehat{\\textrm{PIF}}_{,}, \\hat{w}_j\\Big)\\) equation .","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"model currently works assumption pif_atomic_class independent weights. Hence return 0 pif2 atomic pif.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":"formula","dir":"Reference","previous_headings":"","what":"Formula","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"Given pif_global_ensemble: $$ \\widehat{\\textrm{PIF}}_{1} = g^{-1}\\Bigg(\\sum\\limits_{=1}^{M_1} g(\\hat{q}_i \\cdot \\widehat{\\textrm{PIF}}_{1,})\\Bigg) $$ second pif_global_ensemble: $$ \\widehat{\\textrm{PIF}}_{2} = h^{-1}\\Bigg(\\sum\\limits_{j=1}^{M_2} h(\\hat{w}_j \\cdot \\widehat{\\textrm{PIF}}_{2,j})\\Bigg) $$ function computes covariance first impact fraction weights second fraction. returns vector jth entry given : $$ \\operatorname{Cov}(\\widehat{\\textrm{PIF}}_A, \\hat{w}_j) \\approx \\frac{1}{g'\\big(\\widehat{\\textrm{PIF}}_A\\big)}\\sum\\limits_{=1}^{M_1}g'(\\hat{q}_i \\cdot \\widehat{\\textrm{PIF}}_{,}) \\Bigg[ \\hat{q}_i \\operatorname{Cov}\\Big( \\widehat{\\textrm{PIF}}_{,}, \\hat{w}_j\\Big) + \\widehat{\\textrm{PIF}}_{,} \\operatorname{Cov}\\Big( \\hat{q}_i, \\hat{w}_j\\Big) \\Bigg] $$ \\(\\widehat{\\textrm{PIF}}_{1,:} = (\\widehat{\\textrm{PIF}}_{1,1}, \\widehat{\\textrm{PIF}}_{1,2}, \\dots, \\widehat{\\textrm{PIF}}_{1,M_1})^{\\top}\\)","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_ensemble_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Covariance between a pif and a weight — cov_ensemble_weights","text":"","code":"if (FALSE) { # \\dontrun{ p1 <- paf(c(0.1, 0.2), beta = c(0.01, 0.14), var_p = diag(c(0.01, 0.011)),   var_beta = 0, label =\"1\") p2 <- paf(c(0.2, 0.3), beta = c(0.01, 0.15), var_p = diag(c(0.06, 0.052)),   var_beta = 0, label = \"2\") var_weights <- matrix(c(0.1, 0.01, -0.03, 0.01, 0.4, 0.02, -0.03, 0.02, 0.01), ncol = 3) pt1 <- paf_total(p1, p2, weights = c(0.1, 0.9), var_weights = var_weights[1:2,1:2],   label =\"total\")  #This gives 0 as the assumption is that atomic pifs don't correlate with anything cov_ensemble_weights(p1, p2, var_weights = NULL, var_pif_weights = NULL)  #This returns the correlation of pt1 with its weights cov_ensemble_weights(pt1, pt1, var_weights = NULL, var_pif_weights = NULL)  #Changes if it changes to ensemble p3 <- paf(c(0.1, 0.2), beta = c(0.01, 0.14), var_p = diag(c(0.01, 0.011)),   var_beta = 0, label = \"3\") p4 <- paf(c(0.2, 0.3), beta = c(0.01, 0.15), var_p = diag(c(0.06, 0.052)),   var_beta = 0, label = \"4\") p5 <- paf(c(0.2, 0.3), beta = c(0.01, 0.15), var_p = diag(c(0.06, 0.052)),   var_beta = 0, label = \"5\") pe1 <- paf_ensemble(p3, p4, p5, weights = c(0.1, 0.5, 0.4),   var_weights = var_weights, label = \"ensemble\")  #This returns the correlation of pt1 with its weights cov_ensemble_weights(pe1, pe1, var_weights = NULL, var_pif_weights = NULL)  #You can also specify var_weights as either a matrix var_weights     <- matrix(c(0.1, 0.2, 0.1, 0.3, 0.4, -0.2), ncol = 2) var_pif_weights <- matrix(c(0.01, 0.03, 0.021, -0.02, 0.004, -0.5), ncol = 2) cov_ensemble_weights(pe1, pt1, var_weights = var_weights,   var_pif_weights = var_pif_weights)  #or a covariance structure: var_weights2     <- default_weight_covariance_structure2(pe1, pt1) var_weights2[[pe1@label]][[pt1@label]] <- var_weights var_weights2[[pt1@label]][[pe1@label]] <- var_weights  var_pif_weights2 <- default_weight_pif_covariance_structure2(pe1, pt1) var_pif_weights2[[pe1@label]][[pt1@label]] <- var_pif_weights var_pif_weights2[[pt1@label]][[pe1@label]] <- var_pif_weights cov_ensemble_weights(pe1, pt1, var_weights = var_weights2,   var_pif_weights = var_pif_weights2)  } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_total_pif.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance function for a pif_global_ensemble_class — cov_total_pif","title":"Covariance function for a pif_global_ensemble_class — cov_total_pif","text":"Recursively obtains covariance matrix pif_global_ensemble_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_total_pif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance function for a pif_global_ensemble_class — cov_total_pif","text":"","code":"cov_total_pif(   pif1,   pif2,   var_p = NULL,   var_beta = NULL,   var_weights = NULL,   var_pif_weights = NULL,   var_pifs = NULL,   warning = TRUE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_total_pif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance function for a pif_global_ensemble_class — cov_total_pif","text":"pif1 Either pif_atomic_class pif_global_ensemble_class pif2 Either pif_atomic_class pif_global_ensemble_class var_p covariance matrix prevalences pif1 pif2. Default NULL (correlation). var_beta covariance matrix parameter beta pif1 pif2. Default NULL (correlation). var_weights Covariance weights fractions contained pif1 fractions contained pif2.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/cov_total_pif.html","id":"computation","dir":"Reference","previous_headings":"","what":"Computation","title":"Covariance function for a pif_global_ensemble_class — cov_total_pif","text":"computes: $$ \\operatorname{Cov}(\\widehat{\\textrm{PIF}}_{}, \\widehat{\\textrm{PIF}}_{B})  \\approx \\frac{1}{g'\\big(\\widehat{\\textrm{PIF}}_A\\big)}\\sum\\limits_{=1}^{M_1}g'(\\hat{q}_i \\cdot \\widehat{\\textrm{PIF}}_{,}) \\Bigg[ \\mathbb{E}[\\hat{q}_i] \\operatorname{Cov}\\Big( \\textrm{PIF}_{,}, \\widehat{\\textrm{PIF}}_{B}\\Big) +  \\mathbb{E}[\\textrm{PIF}_{,}] \\operatorname{Cov}\\Big( \\hat{q}_i, \\widehat{\\textrm{PIF}}_{B}\\Big) \\Bigg] $$ \\(\\operatorname{Cov}\\Big( \\textrm{PIF}_{,}, \\widehat{\\textrm{PIF}}_{B}\\Big)\\) computed cov_ensemble_atomic() case \\(\\widehat{\\textrm{PIF}}_{,}\\) atomic formula case ensemble. expression \\(\\operatorname{Cov}\\Big( \\hat{q}_i, \\widehat{\\textrm{PIF}}_{B}\\Big) \\) computed  cov_ensemble_weights() weight \\(q_j\\).","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance components — covariance_from_parameters","title":"Covariance components — covariance_from_parameters","text":"Calculates covariance p beta component two potential impact fractions well complete variance covariance parameters.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance components — covariance_from_parameters","text":"","code":"from_parameters_covariance_p_component(   p1,   p2,   p1_cft,   p2_cft,   rr1,   rr2,   var_p,   upper_bound )  from_parameters_covariance_beta_component(   p1,   p2,   p1_cft,   p2_cft,   rr1,   rr2,   rr_link_deriv_vals1,   rr_link_deriv_vals2,   var_beta,   upper_bound )  from_parameters_pif_covariance(   p1,   p2,   p1_cft,   p2_cft,   rr1,   rr2,   rr_link_deriv_vals1,   rr_link_deriv_vals2,   var_p,   var_beta,   upper_bound_p = FALSE,   upper_bound_beta = FALSE )  from_parameters_pif_variance(   p,   p_cft,   rr,   rr_link_deriv_vals,   var_p,   var_beta,   upper_bound_p = FALSE,   upper_bound_beta = FALSE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance components — covariance_from_parameters","text":"p1 Observed proportion exposed first potential impact fraction p2 Observed proportion exposed first potential impact fraction p1_cft Counterfactual proportion exposed first potential impact fraction p2_cft Counterfactual proportion exposed first potential impact fraction rr1 Relative risk first potential impact fraction rr2 Relative risk second potential impact fraction var_p Covariance matrix entry var_p[,j] corresponding covariance p1[] p2[j]. upper_bound Whether variance calculated upper bound variance (assuming perfect correlation). rr_link_deriv_vals1 Values derivative relative risk function evaluated theta (relative risk parameter). rr_link_deriv_vals2 Values derivative relative risk function evaluated theta (relative risk parameter). var_beta Estimate link_covariance matrix beta entry var_beta[,j] represents link_covariance beta[] beta[j]. upper_bound_p Whether values p component link_variance approximated upper bound. upper_bound_beta Whether values beta component link_variance approximated upper bound. p Prevalence (proportion) exposed individuals N exposure levels. p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. rr relative risk exposure levels. rr_link_deriv_vals derivative relative risk function g respect parameter beta evaluated beta.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Covariance components — covariance_from_parameters","text":"covariance component either p beta","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Covariance components — covariance_from_parameters","text":"estimation require pif_class object instead built parameters.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_from_parameters.html","id":"formulas","dir":"Reference","previous_headings":"","what":"Formulas","title":"Covariance components — covariance_from_parameters","text":"following represents covariance components. p: $$ \\text{CC}_{p} = \\dfrac{  \\partial \\textrm{PIF}_i}{\\partial p_i}^{\\top}  \\textrm{covariance}\\big( \\hat{p}_i, \\hat{p}_j\\big)  \\dfrac{\\partial \\textrm{PIF}_j}{\\partial p_j} $$ beta: $$ \\text{CC}_{\\beta} =  \\dfrac{ \\partial \\textrm{PIF}_i}{\\partial \\beta_i}^{\\top} \\textrm{covariance}\\big( \\hat{\\beta}_i, \\hat{\\beta}_j\\big) \\dfrac{\\partial \\textrm{PIF}_j}{\\partial \\beta_j} $$ total covariance approximated sum: $$ \\text{Cov}(\\text{PIF}_i, \\text{PIF}_j) \\approx \\text{CC}_{p} + \\text{CC}_{\\beta} $$","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structure_class.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance structure class — covariance_structure_class","title":"Covariance structure class — covariance_structure_class","text":"covariance structure class represents collection matrices 0's cov[[]][[j]] contains covariance elements -th potential impact fraction j-th potential impact fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structure_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance structure class — covariance_structure_class","text":"","code":"covariance_structure_class(cov_list = list())"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structure_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance structure class — covariance_structure_class","text":"cov_list Named list list[[]][[j]] represents covariance elements -th potential impact fraction j-th potential impact fraction.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structure_class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Covariance structure class — covariance_structure_class","text":"","code":"#A simple covariance structure cov <- covariance_structure_class(   list(     \"pif1\" = list(\"pif1\" = 0.21, \"pif2\" = 0.12, \"pif3\" = 0.31),     \"pif2\" = list(\"pif1\" = 0.12, \"pif2\" = 0.33, \"pif3\" = -0.01),     \"pif3\" = list(\"pif1\" = 0.31, \"pif2\" = -0.01, \"pif3\" = 0.80)   ) ) cov #>      pif1 pif2  pif3  #> pif1 0.21 0.12  0.31  #> pif2 0.12 0.33  -0.01 #> pif3 0.31 -0.01 0.8    #Values can be extracted as in matrices cov[[1]][[3]] #> [1] 0.31 cov[[\"pif1\"]][[\"pif1\"]] #> [1] 0.21  #And assignment also works cov[[1]][[3]] <- 100 cov[[\"pif1\"]][[\"pif1\"]] <- 500 cov #>      pif1 pif2  pif3  #> pif1 500  0.12  100   #> pif2 0.12 0.33  -0.01 #> pif3 0.31 -0.01 0.8    #Covariance structures are designed to contain the covariance between #numbers or vectors (or between numbers and vectors). Hence they can #contain matrices or vectors too: mat <- matrix(c(0.1, 0.21, 0.47, -0.3), ncol = 2) vec <- c(0.22, -0.9, 0.01)  cov2 <- covariance_structure_class(   list(     \"pif1\" = list(\"pif1\" = 0.21, \"pif2\" = mat, \"pif3\" = 0.31),     \"pif2\" = list(\"pif1\" = mat, \"pif2\" = 0.33, \"pif3\" = vec),     \"pif3\" = list(\"pif1\" = 0.31, \"pif2\" = vec, \"pif3\" = 0.80)   ) ) cov2 #>      pif1 pif2 pif3 #> pif1 0.21 2x2  0.31 #> pif2 2x2  0.33 1x3  #> pif3 0.31 1x3  0.8  cov2[[\"pif1\"]][[\"pif2\"]] #>      [,1]  [,2] #> [1,] 0.10  0.47 #> [2,] 0.21 -0.30"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":null,"dir":"Reference","previous_headings":"","what":"Default covariance structures — covariance_structures","title":"Default covariance structures — covariance_structures","text":"multidimensional arrays lists entry list[[]][[j]] exists represents covariance elements -th potential impact fraction j-th potential impact fraction. particularly useful handling ensembles totals.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default covariance structures — covariance_structures","text":"","code":"covariance_structure(pif, is_variance = FALSE, warning = TRUE)  covariance_structure2(pif1, pif2, warning = TRUE)  default_weight_covariance_structure(pif, is_variance = FALSE, warning = TRUE)  default_weight_covariance_structure2(pif1, pif2, warning = TRUE)  default_parameter_covariance_structure(   pif,   parameter = \"p\",   is_variance = FALSE,   warning = TRUE )  default_parameter_covariance_structure2(   pif1,   pif2,   parameter = \"p\",   warning = TRUE )  default_pif_covariance_structure(pif, is_variance = FALSE, warning = TRUE)  default_pif_covariance_structure2(pif1, pif2, warning = TRUE)  default_weight_pif_covariance_structure(   pif,   is_variance = FALSE,   warning = TRUE )  default_weight_pif_covariance_structure2(pif1, pif2, warning = TRUE)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default covariance structures — covariance_structures","text":"pif potential impact fraction is_variance Whether covariance structure corresponds variance (.e. pif1 pif2 identical) warning Whether throw warning pif1 pif2 common labels pif1 potential impact fraction obtain covariance structure pif2. pif2 potential impact fraction obtain covariance structure pif1, parameter Either beta p. Indicating parameter calculating covariance .","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default covariance structures — covariance_structures","text":"nested list lists entry [[]][[j]] representing covariance elements j.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Default covariance structures — covariance_structures","text":"covariance_structures ending 2 meant obtain default covariance structure two fractions pif1 pif2 ones end 2 meant obtain covariance structure fraction .","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covariance_structures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default covariance structures — covariance_structures","text":"","code":"pif_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001, var_beta = 0.015,                       label = \"Women lead\") pif_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001, var_beta = 0.022,                       label = \"Women radiation\") pif_women      <- pif_ensemble(pif_lead_women, pif_rad_women, label = \"Women\",                                weights = c(0.8, 0.72),                                var_weights = matrix(c(0.3, 0.1, 0.1, 0.4), ncol = 2))  pif_lead_men   <- paf(0.30, 2.2, quiet = TRUE, var_p = 0.001, var_beta = 0.015,                        label = \"Men lead\") pif_rad_men    <- paf(0.10, 1.2, quiet = TRUE, var_p = 0.001, var_beta = 0.022,                         label = \"Men radiation\") pif_men        <- pif_ensemble(pif_lead_men, pif_rad_men, label = \"Men\",                         weights = c(0.65, 0.68),                         var_weights = matrix(c(0.1, -0.2, -0.2, 0.5), ncol = 2)) pif_tot        <- pif_total(pif_men, pif_women,                         weights = c(0.49, 0.51), label = \"Population\",                         var_weights = matrix(c(0.22, 0.4, 0.4, 0.8), ncol = 2))  #This is the default constructor of a covariance. Use it for custom covariances covariance_structure(pif_lead_women) #>            Women lead #> Women lead .          covariance_structure2(pif_lead_women, pif_lead_men) #>            Women lead Men lead #> Women lead .          .        #> Men lead   .          .        default_weight_covariance_structure2(pif_men, pif_men) #>               Men Men lead Men radiation #> Men           2x2 .        .             #> Men lead      .   .        .             #> Men radiation .   .        .             default_weight_covariance_structure(pif_tot) #>                 Population Men Men lead Men radiation Women Women lead #> Population      2x2        .   .        .             .     .          #> Men             .          2x2 .        .             .     .          #> Men lead        .          .   .        .             .     .          #> Men radiation   .          .   .        .             .     .          #> Women           .          .   .        .             2x2   .          #> Women lead      .          .   .        .             .     .          #> Women radiation .          .   .        .             .     .          #>                 Women radiation #> Population      .               #> Men             .               #> Men lead        .               #> Men radiation   .               #> Women           .               #> Women lead      .               #> Women radiation .               default_weight_covariance_structure2(pif_men, pif_women) #>                 Men Men lead Men radiation Women Women lead Women radiation #> Men             2x2 .        .             .     .          .               #> Men lead        .   .        .             .     .          .               #> Men radiation   .   .        .             .     .          .               #> Women           .   .        .             2x2   .          .               #> Women lead      .   .        .             .     .          .               #> Women radiation .   .        .             .     .          .               default_parameter_covariance_structure(pif_tot, parameter = \"beta\") #>                 Population Men Men lead Men radiation Women Women lead #> Population      .          .   .        .             .     .          #> Men             .          .   .        .             .     .          #> Men lead        .          .   0.015    .             .     0.015      #> Men radiation   .          .   .        0.022         .     .          #> Women           .          .   .        .             .     .          #> Women lead      .          .   0.015    .             .     0.015      #> Women radiation .          .   .        0.022         .     .          #>                 Women radiation #> Population      .               #> Men             .               #> Men lead        .               #> Men radiation   0.022           #> Women           .               #> Women lead      .               #> Women radiation 0.022           default_parameter_covariance_structure2(pif_lead_women, pif_lead_men, parameter = \"beta\") #>            Women lead Men lead #> Women lead 0.015      0.015    #> Men lead   0.015      0.015"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covcor.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance matrix, correlation matrix, variance and standard deviation for potential impact fractions — covcor","title":"Covariance matrix, correlation matrix, variance and standard deviation for potential impact fractions — covcor","text":"Computes covariance (covariance) correlation (correlation) multiple potential impact fractions variance variance standard deviation standard_deviationfor potential impact fractions.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covcor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance matrix, correlation matrix, variance and standard deviation for potential impact fractions — covcor","text":"","code":"covariance(   x,   ...,   var_p = NULL,   var_beta = NULL,   var_weights = NULL,   var_pif_weights = NULL,   var_pifs = NULL )  variance(x, ...)  standard_deviation(x, ...)  correlation(x, ..., var_p = NULL, var_beta = NULL)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covcor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance matrix, correlation matrix, variance and standard deviation for potential impact fractions — covcor","text":"x potential impact fraction ... Multiple additional potential impact fraction objects separated commas. var_p covariance matrix prevalences pif1 pif2. Default NULL (correlation). var_beta covariance matrix parameter beta pif1 pif2. Default NULL (correlation). var_weights Covariance weights fractions contained pif1 fractions contained pif2. var_pif_weights Covariance structure potential impact fractions pif1 weights pif2. Entry var_pif_weights[,j] covariance ith fraction pif1 jth weight pif2. refers term \\(\\operatorname{Cov}\\Big(\\widehat{\\textrm{PIF}}_{,}, \\hat{w}_j\\Big)\\) equation . var_pifs Covariance vector potential impact fractions pif_ensemble pif_atomic. refers term \\(\\operatorname{Cov}\\Big( \\textrm{PIF}_{,}, \\widehat{\\textrm{PIF}}_{B,j}\\Big)\\) equation . set NULL automatically calculated.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/covcor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Covariance matrix, correlation matrix, variance and standard deviation for potential impact fractions — covcor","text":"","code":"# Get the approximate link_variance of a pif object my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3,               var_p = 0.1, var_beta = 0.2) variance(my_pif) #> [1] 0.07233754  # This is the same as link_covariance with just 1 pIF covariance(my_pif) #>            [,1] #> [1,] 0.07233754  # Calculate the link_covariance between 3 fractions with shared relative risk beta <- 0.3 var_beta <- 0.1 pif1 <- pif(0.5, 0.2, beta, var_p = 0.5 * (1 - 0.5) / 100, var_beta = var_beta) pif2 <- pif(0.3, 0.1, beta, var_p = 0.3 * (1 - 0.3) / 100, var_beta = var_beta) pif3 <- pif(0.7, 0.3, beta, var_p = 0.7 * (1 - 0.7) / 100, var_beta = var_beta) covariance(pif1, pif2, pif3) #>             [,1]        [,2]        [,3] #> [1,] 0.008789254 0.006486541 0.010220324 #> [2,] 0.006486541 0.005074095 0.007703812 #> [3,] 0.010220324 0.007703812 0.012268945  # The link_covariance between a pif and itself only has the link_variance as entries covariance(pif1, pif1) #>             [,1]        [,2] #> [1,] 0.008789254 0.008789254 #> [2,] 0.008789254 0.008789254  # Or if there is a link_covariance structure between different betas you can specify with # var_beta in the link_covariance betas <- c(1.3, 1.2, 1.27)  # link_covariance among all betas var_beta <- matrix(c(   1.0000000, -0.12123053, 0.35429369,   -0.1212305, 1.00000000, -0.04266409,   0.3542937, -0.04266409, 1.00000000 ), byrow = TRUE, ncol = 3) pif1 <- pif(0.5, 0.2, betas[1], var_p = 0.5 * (1 - 0.5) / 100, var_beta = var_beta[1, 1]) pif2 <- pif(0.3, 0.1, betas[2], var_p = 0.3 * (1 - 0.3) / 100, var_beta = var_beta[2, 2]) pif3 <- pif(0.3, 0.1, betas[3], var_p = 0.3 * (1 - 0.3) / 100, var_beta = var_beta[3, 3]) covariance(pif1, pif2, pif3, var_beta = var_beta) #>              [,1]          [,2]          [,3] #> [1,]  0.042197697 -5.651801e-03  1.629740e-02 #> [2,] -0.005651801  5.536138e-02 -9.642887e-05 #> [3,]  0.016297402 -9.642887e-05  5.410105e-02  # Compute the correlation correlation(pif1, pif2, pif3, var_beta = var_beta) #>            [,1]         [,2]         [,3] #> [1,]  1.0000000 -0.116933525  0.341091700 #> [2,] -0.1169335  1.000000000 -0.001761979 #> [3,]  0.3410917 -0.001761979  1.000000000"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deltapif-package.html","id":null,"dir":"Reference","previous_headings":"","what":"deltapif: Estimate Potential Impact and Population Attributable Fractions with Aggregated Data — deltapif-package","title":"deltapif: Estimate Potential Impact and Population Attributable Fractions with Aggregated Data — deltapif-package","text":"Uses delta-method estimate Potential Impact Fraction (PIF) Population Attributable Fraction (PAF) summary data. creates point-estimates, confidence intervals, estimates variance.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deltapif-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"deltapif: Estimate Potential Impact and Population Attributable Fractions with Aggregated Data — deltapif-package","text":"Maintainer: Rodrigo Zepeda-Tello rzepeda17@gmail.com","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiacov.html","id":null,"dir":"Reference","previous_headings":"","what":"Relative risk covariance from Lee et al — dementiacov","title":"Relative risk covariance from Lee et al — dementiacov","text":"Covariances relative risks Lee et al","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiacov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relative risk covariance from Lee et al — dementiacov","text":"","code":"dementiacov"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiacov.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Relative risk covariance from Lee et al — dementiacov","text":"covariance matrix 12 rows 12 columns. entry represents covariance .","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiacov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Relative risk covariance from Lee et al — dementiacov","text":"Lee, Mark, et al. \"Variation population attributable fraction dementia associated potentially modifiable risk factors race ethnicity US.\" JAMA network open 5.7 (2022): e2219672-e2219672.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiarisk.html","id":null,"dir":"Reference","previous_headings":"","what":"Exposure and Relative Risk data from Lee et Al — dementiarisk","title":"Exposure and Relative Risk data from Lee et Al — dementiarisk","text":"Relative risk exposure data dementia risk-factors","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiarisk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exposure and Relative Risk data from Lee et Al — dementiarisk","text":"","code":"dementiarisk"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiarisk.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Exposure and Relative Risk data from Lee et Al — dementiarisk","text":"data frame 12 rows 11 columns: risk_factor risk factor dementia RR relative risk dementia associated risk factor lower_CI, upper_CI Lower upper bounds 95% confidence interval logrr logarithm relative risk log(RR) sdlog variance logarithm relative risk variance(log(RR)) total proportion individuals exposed overall population hispanic proportion hispanic individuals exposed asian proportion non-hispanic asian individuals exposed black proportion non-hispanic black individuals exposed white proportion non-hispanic white individuals exposed","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/dementiarisk.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Exposure and Relative Risk data from Lee et Al — dementiarisk","text":"Lee, Mark, et al. \"Variation population attributable fraction dementia associated potentially modifiable risk factors race ethnicity US.\" JAMA network open 5.7 (2022): e2219672-e2219672.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deriv_linkfuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Derivatives of link functions — deriv_linkfuns","title":"Derivatives of link functions — deriv_linkfuns","text":"collection derivatives link functions potential impact fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deriv_linkfuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derivatives of link functions — deriv_linkfuns","text":"","code":"deriv_logit(pif)  deriv_log_complement(pif)  deriv_hawkins(pif)  deriv_identity(pif)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deriv_linkfuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derivatives of link functions — deriv_linkfuns","text":"pif value potential impact fraction population attributable fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/deriv_linkfuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Derivatives of link functions — deriv_linkfuns","text":"functions programmed follows $$  \\text{deriv\\_logit}(\\text{PIF}) = \\dfrac{    1   }{    \\text{PIF} \\cdot (1 - \\text{PIF})   }, $$ $$  \\text{deriv\\_log-complement}(\\text{PIF}) = \\dfrac{    1   }{    \\text{PIF} - 1   }, $$ $$  \\text{deriv\\_Hawkins}(\\text{PIF}) = \\dfrac{    1   }{    \\sqrt{\\text{PIF}^2 + 1}   }, $$","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":null,"dir":"Reference","previous_headings":"","what":"Partial derivatives of PIF — derivatives","title":"Partial derivatives of PIF — derivatives","text":"Calculates partial derivatives potential impact fraction respect parameters p beta.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Partial derivatives of PIF — derivatives","text":"","code":"deriv_pif_p(p, p_cft, rr, mu_obs = NULL, mu_cft = NULL)  deriv_pif_beta(p, p_cft, rr, rr_link_deriv_vals, mu_obs = NULL, mu_cft = NULL)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Partial derivatives of PIF — derivatives","text":"p Prevalence (proportion) exposed individuals N exposure levels. p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. rr relative risk exposure levels. mu_obs average value relative risk observed population. mu_cft average value counterfactual relative risk population. rr_link_deriv_vals derivative relative risk function g respect parameter beta evaluated beta.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Partial derivatives of PIF — derivatives","text":"partial derivative (usually vector)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Partial derivatives of PIF — derivatives","text":"p beta usually vectors vector-valued derivatives.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/derivatives.html","id":"formulas","dir":"Reference","previous_headings":"","what":"Formulas","title":"Partial derivatives of PIF — derivatives","text":"partial derivative PIF respect p : $$ \\dfrac{\\partial \\textrm{PIF}}{\\partial p} = \\dfrac{\\mu^{\\text{cft}}}{\\big(\\mu^{\\text{obs}}\\big)^2} \\cdot \\big( \\text{RR}(\\beta) - 1) $$ partial derivative PIF respect beta : $$ \\dfrac{\\partial \\textrm{PIF}}{\\partial \\beta} = \\Bigg(\\dfrac{  \\mu^{\\text{cft}} \\cdot p - \\mu^{\\text{obs}} \\cdot p_{*} }{  \\Big( \\mu^{\\text{obs}}\\Big)^2 }\\Bigg)\\odot \\text{RR}'(\\beta)$$ \\(\\odot\\) representing Hadamard (elementwise) product.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/flatten_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Names of a PIF's components — flatten_names","title":"Names of a PIF's components — flatten_names","text":"Returns character vector names fractions make pif object. particularly useful pif_total pif_ensemble obtain names build .","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/flatten_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Names of a PIF's components — flatten_names","text":"","code":"flatten_names(pif)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/flatten_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Names of a PIF's components — flatten_names","text":"pif potential impact fraction either pif_atomic_class pif_global_ensemble_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/flatten_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Names of a PIF's components — flatten_names","text":"character vector names fractions make pif.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/flatten_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Names of a PIF's components — flatten_names","text":"","code":"paf_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001,         label = \"Women lead\") paf_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001,         label = \"Women radiation\") paf_women      <- paf_ensemble(paf_lead_women, paf_rad_women,         label = \"Women\") paf_lead_men   <- paf(0.30, 2.2, quiet = TRUE, var_p = 0.001,         label = \"Men lead\") paf_rad_men    <- paf(0.10, 1.2, quiet = TRUE, var_p = 0.001,         label = \"Men radiation\") paf_men        <- paf_ensemble(paf_lead_men, paf_rad_men,         label = \"Men\") paf_tot        <- paf_total(paf_men, paf_women, weights = c(0.49, 0.51),         label = \"Population\")  #For a single PIF return the names flatten_names(paf_lead_women) #> [1] \"Women lead\"  #For an ensemble return the ones that make them up flatten_names(paf_women) #> [1] \"Women\"           \"Women lead\"      \"Women radiation\"  #For totals return the ones that make them up flatten_names(paf_tot) #> [1] \"Population\"      \"Men\"             \"Men lead\"        \"Men radiation\"   #> [5] \"Women\"           \"Women lead\"      \"Women radiation\""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/fraction_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the type of the fraction — fraction_type","title":"Get the type of the fraction — fraction_type","text":"Obtain whether fraction potential impact fraction (PIF) population attributable fraction (PAF)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/fraction_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the type of the fraction — fraction_type","text":"","code":"fraction_type(x)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/fraction_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the type of the fraction — fraction_type","text":"x pif_class object","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/fraction_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the type of the fraction — fraction_type","text":"character either PIF PAF depending object","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/fraction_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the type of the fraction — fraction_type","text":"","code":"#A potential impact fraction pif1 <- pif(p = 0.2, p_cft = 0.1, beta = 1.2, quiet = TRUE) fraction_type(pif1) #> [1] \"PIF\"  #A population attributable fraction paf1 <- paf(p = 0.2, beta = 1.2, quiet = TRUE) fraction_type(paf1) #> [1] \"PAF\""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/getters.html","id":null,"dir":"Reference","previous_headings":"","what":"Getters — getters","title":"Getters — getters","text":"Collection functions potential impact fraction class work getters properties. function constructed get_property","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/getters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Getters — getters","text":"","code":"get_rr(self)  get_mu_obs(self)  get_mu_cft(self)  get_pif(self)  get_link_vals(self)  get_link_vals_cases(self)  get_link_deriv_vals_cases(self)  get_cases(self)  get_link_deriv_vals(self)  get_rr_link_deriv_vals(self)  get_link_variance(self)  get_variance_cases(self)  get_variance_atomic(self)  get_ci(self)  get_ensemble_coefs(self)  get_sum_transformed_weighted_coefs(self)  get_global_ensemble_pif(self)  get_ensemble_pif(self)  get_total_pif(self)  get_ensemble_type(self)  get_covariance(self)  get_variance(self)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/getters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Getters — getters","text":"self pif_class pif_atomic_class object created S7.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/helper_print_pif_global_ensemble_class.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a pif_global_ensemble_class — helper_print_pif_global_ensemble_class","title":"Print a pif_global_ensemble_class — helper_print_pif_global_ensemble_class","text":"Prints pif_global_ensemble_class object.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/helper_print_pif_global_ensemble_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a pif_global_ensemble_class — helper_print_pif_global_ensemble_class","text":"","code":"helper_print_pif_global_ensemble_class(x, accuracy)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/helper_print_pif_global_ensemble_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a pif_global_ensemble_class — helper_print_pif_global_ensemble_class","text":"x pif_global_ensemble_class accuracy accuracy parameter scales::percent.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/helper_print_pif_global_ensemble_class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a pif_global_ensemble_class — helper_print_pif_global_ensemble_class","text":"Called side-effects printing console","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/inv_linkfuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverses of link functions — inv_linkfuns","title":"Inverses of link functions — inv_linkfuns","text":"collection inverses link functions potential impact fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/inv_linkfuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverses of link functions — inv_linkfuns","text":"","code":"inv_logit(x)  inv_log_complement(x)  inv_hawkins(x)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/inv_linkfuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverses of link functions — inv_linkfuns","text":"x value inv_link(x) potential impact fraction population attributable fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/inv_linkfuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverses of link functions — inv_linkfuns","text":"functions programmed follows $$  \\text{inv\\_logit}(\\text{PIF}) = \\dfrac{    1   }{    1 + \\exp(-x)   }, $$ $$  \\text{inv\\_log-complement}(\\text{PIF}) = 1 - \\exp(x), $$ $$  \\text{inv\\_Hawkins}(\\text{PIF}) =   \\frac{1}{2} \\exp(-x) \\cdot \\big(\\exp(x) - 1\\big) \\cdot \\big(\\exp(x) + 1\\big) $$","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/length.html","id":null,"dir":"Reference","previous_headings":"","what":"Length of a covariance_structure — length","title":"Length of a covariance_structure — length","text":"Gets length covariance structure Gets length pif_ensemble_class Gets length pif_atomic_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/length.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Length of a covariance_structure — length","text":"x pif_atomic_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_deriv_vals.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the values of the derivative of link — link_deriv_vals","title":"Get the values of the derivative of link — link_deriv_vals","text":"Obtain values derivative link function potential impact fraction (PIF) population attributable fraction (PAF) pif","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_deriv_vals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the values of the derivative of link — link_deriv_vals","text":"","code":"link_deriv_vals(x)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_deriv_vals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the values of the derivative of link — link_deriv_vals","text":"x pif_class object","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_deriv_vals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the values of the derivative of link — link_deriv_vals","text":"number indicating derivative link() evaluated pif.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_deriv_vals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the values of the derivative of link — link_deriv_vals","text":"","code":"if (FALSE) { # \\dontrun{ #Create a pif object pif_obj <- pif(p = 0.499, beta = log(3.6), p_cft = 0.499/2, var_p = 0.001,   var_beta = 0.1, link = \"logit\", quiet = TRUE)  #Obtain the value of the link at the derivative link_deriv_vals(pif_obj)  #This is the same as the derivative of logit evaluated at 0.2823 deriv_logit(coef(pif_obj)) } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":null,"dir":"Reference","previous_headings":"","what":"Link parsers — link_parsers","title":"Link parsers — link_parsers","text":"Functions parse link (inverse link) word function","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Link parsers — link_parsers","text":"","code":"parse_link(link_name)  parse_inv_link(link_name)  parse_deriv_link(link_name)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Link parsers — link_parsers","text":"link_name name link function.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Link parsers — link_parsers","text":"function corresponding link_name.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Link parsers — link_parsers","text":"following valid link names: identity function f(x) = x.inverse finv(x) = x logit function f(x) = ln(x / (1 - x)) inverse finv(x) = 1 / (1 + exp(-x)) log-complement function f(x) = ln(1 - x) inverse finv(x) = 1 - exp(x) hawkins function f(x) = ln(x + sqrt(x^2 + 1)) inverse finv(x) = 0.5 * exp(-x) * (exp(2 * x) - 1) exponential function f(x) = exp(x) inverse f(x) = ln(x)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/link_parsers.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Link parsers — link_parsers","text":"function supplied link_name function returned","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkcheck.html","id":null,"dir":"Reference","previous_headings":"","what":"Function that checks the link — linkcheck","title":"Function that checks the link — linkcheck","text":"Takes link relative risk link pif paf checks correctly specified.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkcheck.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function that checks the link — linkcheck","text":"","code":"check_links(link, link_deriv, link_inv)  check_rr_links(rr_link, rr_link_deriv)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkcheck.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function that checks the link — linkcheck","text":"link Link function pif confidence intervals stays within expected bounds. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv(). link_inv inverse link. example link logit inv_logit. rr_link Link function relative risk given rr_link(beta). rr_link_deriv Derivative link function relative risk. function tries build automatically rr_link using Deriv::Deriv().","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkcheck.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function that checks the link — linkcheck","text":"Invisible. Called side effects","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkfuns.html","id":null,"dir":"Reference","previous_headings":"","what":"Link functions — linkfuns","title":"Link functions — linkfuns","text":"collection common link functions, calculating link_variance  potential impact fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkfuns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Link functions — linkfuns","text":"","code":"logit(pif)  log_complement(pif)  hawkins(pif)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkfuns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Link functions — linkfuns","text":"pif value potential impact fraction population attributable fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkfuns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Link functions — linkfuns","text":"functions programmed follows $$  \\text{logit}(\\text{PIF}) = \\ln\\Bigg(\\dfrac{    \\text{PIF}   }{    1 - \\text{PIF}   }\\Bigg), $$ $$  \\text{log-complement}(\\text{PIF}) = \\ln\\big(1 - \\text{PIF}\\big), $$ $$  \\text{Hawkins}(\\text{PIF}) = \\ln\\Big(\\text{PIF} + \\sqrt{\\text{PIF}^2 + 1}\\Big). $$","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/linkfuns.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Link functions — linkfuns","text":"used, link_variance calculated linkfun(pif).","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_cft_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the mean under the counterfactual prevalence — mu_cft_fun","title":"Compute the mean under the counterfactual prevalence — mu_cft_fun","text":"Calculates mean average relative risk population counterfactual prevalence: $$ E[\\text{RR}] = \\sum\\limits_{=1}^{n} p_i^{\\text{cft}} \\cdot \\text{RR}_i $$","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_cft_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the mean under the counterfactual prevalence — mu_cft_fun","text":"","code":"mu_cft_fun(p_cft, rr)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_cft_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the mean under the counterfactual prevalence — mu_cft_fun","text":"p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. rr relative risk exposure levels.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_cft_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the mean under the counterfactual prevalence — mu_cft_fun","text":"mean relative risk counterfactual prevalence","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_cft_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the mean under the counterfactual prevalence — mu_cft_fun","text":"","code":"if (FALSE) { # \\dontrun{ #Consider a popualtion with 3 exposure categories with #relative risks 1.0, 1.1, 1.3 and prevalences 0.6, 0.3, 0.1 #Notice that the reference relative risk (1) is not added pval  <- c(0.4, 0.0) #Prevalences on counterfactual scenarios rrval <- c(1.1, 1.3) #Risks mu_cft_fun(p_cft = pval, rr = rrval) #Average relative risk } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_obs_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the mean under the observed prevalence — mu_obs_fun","title":"Compute the mean under the observed prevalence — mu_obs_fun","text":"Calculates mean average relative risk population observed prevalence: $$ E[\\text{RR}] = \\sum\\limits_{=1}^{n} p_i \\cdot \\text{RR}_i $$","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_obs_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the mean under the observed prevalence — mu_obs_fun","text":"","code":"mu_obs_fun(p, rr)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_obs_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the mean under the observed prevalence — mu_obs_fun","text":"p Prevalence (proportion) exposed individuals N exposure levels. rr relative risk exposure levels.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_obs_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the mean under the observed prevalence — mu_obs_fun","text":"mean relative risk observed prevalence","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/mu_obs_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the mean under the observed prevalence — mu_obs_fun","text":"","code":"if (FALSE) { # \\dontrun{ #Consider a popualtion with 3 exposure categories with #relative risks 1.0, 1.1, 1.3 and prevalences 0.6, 0.3, 0.1 #Notice that the reference relative risk (1) is not added pval  <- c(0.3, 0.1) #Prevalences rrval <- c(1.1, 1.3) #Risks mu_obs_fun(p = pval, rr = rrval) #Average relative risk } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/names.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the label of a PIF or PAF — names","title":"Get the label of a PIF or PAF — names","text":"Gets label potential impact fraction population attributable fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the label of a PIF or PAF — names","text":"x pif_class object. ... Additional parameters (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the label of a PIF or PAF — names","text":"","code":"#A simple example my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1,                 var_beta = 0.2, label = \"Test\") names(my_pif) #> [1] \"Test\"  #A pif composed of others my_pif1 <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1,                 var_beta = 0.2, label = \"Test 1\") my_pif2 <- pif(p = 0.4, p_cft = 0.1, beta = 1.3, var_p = 0.1,                 var_beta = 0.2, label = \"Test 2\") pif_tot <- pif_total(my_pif1, my_pif2, weights = c(0.2, 0.8),                 label = \"Parent\") names(pif_tot) #> [1] \"Test 1\" \"Test 2\""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_atomic_ci.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence interval for a potential impact fraction — pif_atomic_ci","title":"Confidence interval for a potential impact fraction — pif_atomic_ci","text":"Confidence interval potential impact fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_atomic_ci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence interval for a potential impact fraction — pif_atomic_ci","text":"","code":"pif_atomic_ci(link_vals, link_variance, conf_level, link_inv)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_atomic_ci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence interval for a potential impact fraction — pif_atomic_ci","text":"link_vals Values link function evaluated pif (.e. link(pif)) link_variance Link_variance estimate linked potential impact fraction (.e. link(pif)) conf_level Confidence level interval link_inv Inverse link function used compute link_vals link_variance.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_atomic_ci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence interval for a potential impact fraction — pif_atomic_ci","text":"vector lower upper bounds confidence interval","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the potential impact fraction — pif_fun","title":"Compute the potential impact fraction — pif_fun","text":"Calculates potential impact fraction following formula: $$ \\text{PIF} = \\dfrac{ \\sum\\limits_{=1}^n p_i \\cdot \\text{RR}_i - \\sum\\limits_{=1}^n p_i^{\\text{cft}} \\cdot \\text{RR}_i }{ \\sum\\limits_{=1}^n p_i \\cdot \\text{RR}_i } $$","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the potential impact fraction — pif_fun","text":"","code":"pif_fun(p, p_cft, rr)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the potential impact fraction — pif_fun","text":"p Prevalence (proportion) exposed individuals N exposure levels. p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. rr relative risk exposure levels.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the potential impact fraction — pif_fun","text":"potential impact fraction (numeric)","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the potential impact fraction — pif_fun","text":"","code":"if (FALSE) { # \\dontrun{ #This example comes from Levin 1953 #Relative risk of lung cancer given smoking was 3.6 #Proportion of individuals smoking where 49.9% #Counterfactual is 0% smoking pif_fun(0.499, 0.0, 3.6)  #You can also use multiple exposure categories. As an example #These are the relative risks for age-group 25-59 for each BMI level: rr <- c(\"<18.5\" = 1.38, \"25 to <30\" = 0.83,   \"30 to <35\" = 1.20, \">=35\" = 1.83)  #While the prevalences are: p <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,   \"30 to <35\" = 17.3, \">=35\" = 13.3) / 100  #A counterfactual of reducing the prevalence of >=35 by half and #having them be on the \"30 to <35\" category instead p_cft <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,   \"30 to <35\" = 17.3 + 13.3/2, \">=35\" = 13.3/2) / 100  pif_fun(p = p, p_cft = p_cft, rr = rr) } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun2.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the potential impact fraction — pif_fun2","title":"Compute the potential impact fraction — pif_fun2","text":"Compute potential impact fraction","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the potential impact fraction — pif_fun2","text":"","code":"pif_fun2(mu_obs, mu_cft)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the potential impact fraction — pif_fun2","text":"mu_obs average value relative risk observed population. mu_cft average value counterfactual relative risk population.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the potential impact fraction — pif_fun2","text":"potential impact fraction (numeric)","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_fun2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the potential impact fraction — pif_fun2","text":"","code":"if (FALSE) { # \\dontrun{ #This example comes from Levin 1953 #Relative risk of lung cancer given smoking was 3.6 #Proportion of individuals smoking where 49.9% #Counterfactual is 0% smoking mu_obs <- mu_obs_fun(p = 0.499, rr = 3.6) mu_cft <- mu_cft_fun(p_cft = 0.0, rr = 3.6) pif_fun2(mu_obs, mu_cft)  #You can also use multiple exposure categories. As an example #These are the relative risks for age-group 25-59 for each BMI level: rr <- c(\"<18.5\" = 1.38, \"25 to <30\" = 0.83,   \"30 to <35\" = 1.20, \">=35\" = 1.83)  #While the prevalences are: p <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,   \"30 to <35\" = 17.3, \">=35\" = 13.3) / 100  #A counterfactual of reducing the prevalence of >=35 by half and #having them be on the \"30 to <35\" category instead p_cft <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,   \"30 to <35\" = 17.3 + 13.3/2, \">=35\" = 13.3/2) / 100  mu_obs <- mu_obs_fun(p = p, rr = rr) mu_cft <- mu_cft_fun(p_cft = p_cft, rr = rr) pif_fun2(mu_obs, mu_cft) } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_validate_ensemble.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare a global_ensemble — pif_validate_ensemble","title":"Prepare a global_ensemble — pif_validate_ensemble","text":"Helper function helps validate inputs global ensemble","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_validate_ensemble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare a global_ensemble — pif_validate_ensemble","text":"","code":"pif_validate_ensemble(   pif1,   ...,   weights,   var_weights,   var_pif_weights,   conf_level,   link,   link_inv,   link_deriv,   quiet,   is_paf = FALSE,   weights_sum_to_1 = FALSE,   label )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_validate_ensemble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare a global_ensemble — pif_validate_ensemble","text":"pif1 potential impact fraction (class pif_class) ... remaining potential impact fractions (respectively) population attributable fractions. weights vector containing proportion population categories (pifs given). var_weights link_covariance structure weights. Can 0 (default) weights random, vector link_variances weights available link_covariance matrix. var_pif_weights covariance matrix row column j representing covariance -th potential impact fraction list j-th weight conf_level Confidence level confidence interval (default 0.95). link Link function pif confidence intervals stays within expected bounds. link_inv inverse link. example link logit inv_logit. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv(). quiet Whether show messages. is_paf Whether computed quantity population attributable fraction weights_sum_to_1 Boolean flag indicating weights sum 1 (normalized weights) (unnormalized). label Character identifier impact fraction. ","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pif_validate_ensemble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare a global_ensemble — pif_validate_ensemble","text":"list validated values use pif_total pif_ensemble.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Potential Impact fraction and Population Attributable Fraction — pifpaf","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"Calculates potential impact fraction pif population attributable fraction paf categorical exposure considering observed prevalence  p relative risk (relative risk parameter) beta.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"","code":"paf(   p,   beta,   var_p = NULL,   var_beta = NULL,   rr_link = \"exponential\",   rr_link_deriv = NULL,   link = \"log-complement\",   link_inv = NULL,   link_deriv = NULL,   conf_level = 0.95,   quiet = FALSE,   label = NULL )  pif(   p,   p_cft = rep(0, length(p)),   beta,   var_p = NULL,   var_beta = NULL,   rr_link = \"exponential\",   rr_link_deriv = NULL,   link = \"log-complement\",   link_inv = NULL,   link_deriv = NULL,   conf_level = 0.95,   type = \"PIF\",   quiet = FALSE,   label = NULL )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"p Prevalence (proportion) exposed individuals N exposure levels. beta Relative risk parameter standard deviation available (usually either relative risk directly log relative risk RRs, ORs HRs come exponential models). var_p Estimate link_covariance matrix p entry var_p[,j] represents link_covariance p[] p[j]. var_beta Estimate link_covariance matrix beta entry var_beta[,j] represents link_covariance beta[] beta[j]. rr_link Link function relative risk given rr_link(beta). rr_link_deriv Derivative link function relative risk. function tries build automatically rr_link using Deriv::Deriv(). link Link function pif confidence intervals stays within expected bounds. link_inv inverse link. example link logit inv_logit. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv(). conf_level Confidence level confidence interval (default 0.95). quiet Whether show messages. label Character identifier impact fraction. p_cft Counterfactual prevalence (proportion) exposed individuals N exposure levels. type Character either Potential Impact Fraction (PIF) Population Attributable Fraction (PAF)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"function assumes p beta pre-computed data individual-level data accessible researchers. either data individual-level prevalence exposure p data individual-level risk estimate beta can accessed researcher methods (pifpaf package preferred).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"formulas","dir":"Reference","previous_headings":"","what":"Formulas","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"function computed potential impact fraction confidence intervals using Walter's formula: $$ \\textrm{PIF} =  \\dfrac{    \\sum\\limits_{=1}^N p_i \\text{RR}_i -    \\sum\\limits_{=1}^N p_i^{\\text{cft}} \\text{RR}_i   }{    \\sum\\limits_{=1}^N p_i \\text{RR}_i   }, \\quad \\text{ } \\quad \\textrm{PAF} =  \\dfrac{    \\sum\\limits_{=1}^N p_i \\text{RR}_i - 1   }{    \\sum\\limits_{=1}^N p_i \\text{RR}_i   } $$ case N exposure categories equivalent Levine's formula 1 exposure category: $$ \\textrm{PIF} =  \\dfrac{    p (\\text{RR} - 1) - p^{\\text{cft}} (\\text{RR} - 1)   }{    1 + p (\\text{RR} - 1)   }   \\quad \\textrm{ } \\quad \\textrm{PAF} =  \\dfrac{    p (\\text{RR} - 1)   }{    1 + p (\\text{RR} - 1)   } $$ construction confidence intervals done via link function. variance given : $$ \\sigma_f^2 = \\text{Var}\\Big[ f(\\textrm{PIF}) \\Big] \\approx \\Big(f'(\\textrm{PIF})\\Big)^2 \\text{Var}\\Big[ \\textrm{PIF} \\Big] $$ intervals constructed : $$ \\text{CI} = f^{-1}\\Big(  f(\\textrm{PIF})  \\pm Z_{\\alpha/2} \\cdot \\sigma_f \\Big) $$ function \\(f\\) called link function PIF, \\(f^{-1}\\) represents inverse, \\(f'\\) derivative.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"link-functions-for-the-pif","dir":"Reference","previous_headings":"","what":"Link functions for the PIF","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"default pif paf calculations use log-complement link guarantees impact fractions' intervals valid values (-Inf 1). Depending application following link functions also implemented: log-complement achieve fractions -Inf 1. function f(x) = ln(1 - x) inverse finv(x) = 1 - exp(x) logit achieve strictly positive fractions 0 1. function f(x) = ln(x / (1 - x)) inverse finv(x) = 1 / (1 + exp(-x)) identity approximation fractions guarantee confidence intervals valid regions. function f(x) = x.inverse finv(x) = x hawkins Hawkins' fraction controlling variance. function f(x) = ln(x + sqrt(x^2 + 1)) inverse finv(x) = 0.5 * exp(-x) * (exp(2 * x) - 1) custom User specified (see ). general, logit preferred known certain fractions can positive (.e. relative risks (including CIs) > 1 prevalence > 0 epidemiological / biological justification). Custom link functions can implemented long invertible range interest providing: link function link_inv inverse function link link_deriv derivative link derivative provided package attempts estimate symbolically using Deriv::Deriv() however guarantee work non-standard functions (.e. logarithm / trigonometric / exponential) example considering implementing square root custom link:","code":"# The link is square root link      <- sqrt  # Inverse of sqrt(x) is x^2 link_inv  <- function(x) x^2  # The derivative of sqrt(x) is 1/(2 * sqrt(x)) link_deriv <- function(pif) 1 / (2 * sqrt(pif))  # Then the pif can be calculated as: pif(p = 0.499, beta = 1.6, p_cft = 0.499/2, var_p = 0.1, var_beta = 0.2,      link = link, link_inv = link_inv, link_deriv = link_deriv)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"link-functions-for-beta","dir":"Reference","previous_headings":"","what":"Link functions for beta","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"default pif paf use exponential link means values beta log-relative risks variance var_beta corresponds log-relative risk's variance. Depending relative risk's source following options available: exponential relative risks correspond exponential another parameter, usually called beta. exponential function f(beta) = exp(beta) inverse finv(rr) = log(rr) = beta identity relative risk variance reported directly. function f(beta) = beta inverse finv(rr) = rr = beta custom User specified (see ). Note cases including contingency tables, Poisson Logistic regressions, Cox Proportional Hazards, relative risks estimated exponentiating parameter. previous section, custom link functions beta can implemented long invertible range interest providing function rr_link derivative rr_link_deriv. derivative provided package attempt estimate symbolically using Deriv::Deriv() however guarantee work non-standard functions (.e. logarithm / trigonometric / exponential)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"population-attributable-fraction","dir":"Reference","previous_headings":"","what":"Population Attributable Fraction","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"population attributable fraction corresponds potential impact fraction theoretical minimum risk level. assumed theoretical minimum risk level relative risk 1. counterfactual prevalence p_cft specified, model computes population attributable fraction.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/pifpaf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Potential Impact fraction and Population Attributable Fraction — pifpaf","text":"","code":"#EXAMPLE 1: ONE EXPOSURE CATEGORY (CLASSIC LEVIN) #--------------------------------------------------------------------------- # This example comes from Levin 1953 # Relative risk of lung cancer given smoking was 3.6 # Proportion of individuals smoking where 49.9% # Calculates PAF (i.e. counterfactual is no smoking) paf(p = 0.499, beta = log(3.6)) #> ! Assuming parameters `p` have no variance Use `var_p` to input their link_variances and/or covariance #> ! Assuming parameters `beta` have no variance Use `var_beta` to input their link_variances and/or covariance #>  #> ── Population Attributable Fraction: [deltapif-112383884326229] ── #>  #> PAF = 56.473% [95% CI: 56.473% to 56.473%] #> standard_deviation(paf %) = 0.000  # Assuming that beta and p had a link_variance paf(p = 0.499, beta = log(3.6), var_p = 0.001, var_beta = 0.1) #>  #> ── Population Attributable Fraction: [deltapif-0397001493059625] ── #>  #> PAF = 56.473% [95% CI: 28.972% to 73.326%] #> standard_deviation(paf %) = 10.875  # If the link_variance was to high a logistic transform would be required # Generates incorrect values for the interval: paf(p = 0.499, beta = log(3.6), var_p = 0.1, var_beta = 0.3) #>  #> ── Population Attributable Fraction: [deltapif-0823261150567127] ── #>  #> PAF = 56.473% [95% CI: -29.969% to 85.422%] #> standard_deviation(paf %) = 24.294  # Logit fixes it paf(p = 0.499, beta = log(3.6), var_p = 0.1, var_beta = 0.3,     link = \"logit\", quiet = TRUE) #>  #> ── Population Attributable Fraction: [deltapif-05788846247121] ── #>  #> PAF = 56.473% [95% CI: 15.753% to 90.002%] #> standard_deviation(paf %) = 24.294  # If the counterfactual was reducing the smoking population by 1/2 pif(p = 0.499, beta = log(3.6), p_cft = 0.499/2, var_p = 0.001,     var_beta = 0.1, link = \"logit\", quiet = TRUE) #>  #> ── Potential Impact Fraction: [deltapif-17637893775715] ── #>  #> PIF = 28.236% [95% CI: 18.101% to 41.192%] #> standard_deviation(pif %) = 5.963  #EXAMPLE 2: MULTIPLE EXPOSURE CATEGORIES #--------------------------------------------------------------------------- #In \"Excess Deaths Associated With Underweight, Overweight, and Obesity\" #the PAF of mortality associated to different BMI levels is calculated  #These are the relative risks for age-group 25-59 for each BMI level: rr <- c(\"<18.5\" = 1.38, \"25 to <30\" = 0.83 ,         \"30 to <35\" = 1.20, \">=35\" = 1.83)  #While the prevalences are: p <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,         \"30 to <35\" = 17.3, \">=35\" = 13.3) / 100  #The variance of the relative risk is obtained from the CIs: var_log_rr <- c(\"<18.5\" = 0.2653156, \"25 to <30\" =  0.1247604,                 \"30 to <35\" = 0.1828293, \">=35\" = 0.1847374)^2  #Note that we are omitting the group \"18.5 to < 25\" as it is the #reference (RR = 1) paf(p = p, beta = rr, var_beta = var_log_rr, var_p = 0, quiet = TRUE,     link = \"logit\") #>  #> ── Population Attributable Fraction: [deltapif-0132992146404077] ── #>  #> PAF = 61.599% [95% CI: 50.274% to 71.792%] #> standard_deviation(paf %) = 5.571  #We can compute a potential impact fraction of, for example, reducing the #amount of people over 35 to 0 and having them in the \"30 to <35\": p_cft <- c(\"<18.5\" = 1.9, \"25 to <30\" = 34.8,             \"30 to <35\" = 17.3 + 13.3, \">=35\" = 0) / 100  #The potential impact fraction is as follows: pif(p = p, p_cft = p_cft, beta = rr, link = \"logit\",   var_beta = var_log_rr, var_p = 0, quiet = TRUE) #>  #> ── Potential Impact Fraction: [deltapif-0376499328478288] ── #>  #> PIF = 14.882% [95% CI: 13.702% to 16.144%] #> standard_deviation(pif %) = 0.623"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print.html","id":null,"dir":"Reference","previous_headings":"","what":"Print or show a potential impact fraction — print","title":"Print or show a potential impact fraction — print","text":"Function print show potential impact fraction object Function print show covariance_structure_class","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print or show a potential impact fraction — print","text":"accuracy accuracy printed value x covariance_structure_class ... Additional arguments pass print","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print or show a potential impact fraction — print","text":"","code":"my_pif <- pif(p = 0.2, beta = 1.3, var_beta = 0.1) #> ! Assuming parameters `p` have no variance Use `var_p` to input their link_variances and/or covariance print(my_pif) #>  #> ── Potential Impact Fraction: [deltapif-124126307530705] ── #>  #> PIF = 34.805% [95% CI: 12.300% to 51.535%] #> standard_deviation(pif %) = 9.864  # Change the ammount of digits to show just 1 print(my_pif, accuracy = 0.1) #>  #> ── Potential Impact Fraction: [deltapif-124126307530705] ── #>  #> PIF = 34.8% [95% CI: 12.3% to 51.5%] #> standard_deviation(pif %) = 9.9 pif_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001, var_beta = 0.015,                       label = \"Women lead\") pif_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001, var_beta = 0.022,                       label = \"Women radiation\") pif_women      <- pif_ensemble(pif_lead_women, pif_rad_women, label = \"Women\",                                weights = c(0.8, 0.72),                                var_weights = matrix(c(0.3, 0.1, 0.1, 0.4), ncol = 2))  pif_lead_men   <- paf(0.30, 2.2, quiet = TRUE, var_p = 0.001, var_beta = 0.015,                        label = \"Men lead\") pif_rad_men    <- paf(0.10, 1.2, quiet = TRUE, var_p = 0.001, var_beta = 0.022,                         label = \"Men radiation\") pif_men        <- pif_ensemble(pif_lead_men, pif_rad_men, label = \"Men\",                         weights = c(0.65, 0.68),                         var_weights = matrix(c(0.1, -0.2, -0.2, 0.5), ncol = 2)) pif_tot        <- pif_total(pif_men, pif_women,                         weights = c(0.49, 0.51), label = \"Population\",                         var_weights = matrix(c(0.22, 0.4, 0.4, 0.8), ncol = 2))  print(covariance_structure(pif_lead_women)) #>            Women lead #> Women lead .          print(covariance_structure2(pif_lead_women, pif_lead_men)) #>            Women lead Men lead #> Women lead .          .        #> Men lead   .          .        print(default_weight_covariance_structure2(pif_men, pif_women)) #>                 Men Men lead Men radiation Women Women lead Women radiation #> Men             2x2 .        .             .     .          .               #> Men lead        .   .        .             .     .          .               #> Men radiation   .   .        .             .     .          .               #> Women           .   .        .             2x2   .          .               #> Women lead      .   .        .             .     .          .               #> Women radiation .   .        .             .     .          .               print(default_parameter_covariance_structure(pif_tot, parameter = \"beta\")) #>                 Population Men Men lead Men radiation Women Women lead #> Population      .          .   .        .             .     .          #> Men             .          .   .        .             .     .          #> Men lead        .          .   0.015    .             .     0.015      #> Men radiation   .          .   .        0.022         .     .          #> Women           .          .   .        .             .     .          #> Women lead      .          .   0.015    .             .     0.015      #> Women radiation .          .   .        0.022         .     .          #>                 Women radiation #> Population      .               #> Men             .               #> Men lead        .               #> Men radiation   0.022           #> Women           .               #> Women lead      .               #> Women radiation 0.022"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_cases_class.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a cases_class — print_cases_class","title":"Print a cases_class — print_cases_class","text":"Prints cases_class object.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_cases_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a cases_class — print_cases_class","text":"","code":"print_cases_class(x, accuracy)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_cases_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a cases_class — print_cases_class","text":"x cases_class accuracy accuracy parameter scales::comma.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_cases_class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a cases_class — print_cases_class","text":"Called side-effects printing console","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_pif_class.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a pif_class — print_pif_class","title":"Print a pif_class — print_pif_class","text":"Prints pif_class object.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_pif_class.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a pif_class — print_pif_class","text":"","code":"print_pif_class(x, accuracy)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_pif_class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a pif_class — print_pif_class","text":"x pif_class accuracy accuracy parameter scales::percent.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/print_pif_class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a pif_class — print_pif_class","text":"Called side-effects printing console","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/rowcol.html","id":null,"dir":"Reference","previous_headings":"","what":"Row and Column names — rowcol","title":"Row and Column names — rowcol","text":"Retrieve row column names covariance_structure","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/rowcol.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Row and Column names — rowcol","text":"","code":"row_names(x)  col_names(x)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/rowcol.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Row and Column names — rowcol","text":"x covariance_structure","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/setters.html","id":null,"dir":"Reference","previous_headings":"","what":"Setters — setters","title":"Setters — setters","text":"Collection functions potential impact fraction class work setters properties. function constructed set_property","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/setters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setters — setters","text":"self pif_class object created S7.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a covariance_structure — subset","title":"Subset a covariance_structure — subset","text":"Obtains smaller covariance_structure entries given select option vector.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a covariance_structure — subset","text":"x covariance_structure select vector covariate names keep covariance_structure. cols vector covariate column names keep covariance_structure. rows vector covariate row names keep covariance_structure. negate TRUE subsets variables specified ... Additional parameters (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a covariance_structure — subset","text":"","code":"pif_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001, var_beta = 0.015,                       label = \"Women lead\") pif_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001, var_beta = 0.022,                       label = \"Women radiation\") covstr <- default_parameter_covariance_structure2(pif_lead_women, pif_rad_women, parameter = \"beta\") subset(covstr, \"Women lead\") #>            Women lead #> Women lead 0.015      subset(covstr, \"Women lead\", negate = TRUE) #>                 Women radiation #> Women radiation 0.022           subset(covstr, c(\"Women radiation\", \"Women lead\")) #>                 Women lead Women radiation #> Women lead      0.015      .               #> Women radiation .          0.022           subset(covstr, 2) #>                 Women radiation #> Women radiation 0.022           subset(covstr, 1:2) #>                 Women lead Women radiation #> Women lead      0.015      .               #> Women radiation .          0.022"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset_col.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to get the rows out of a covariance_structure — subset_col","title":"Function to get the rows out of a covariance_structure — subset_col","text":"Function get rows covariance_structure","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset_col.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to get the rows out of a covariance_structure — subset_col","text":"","code":"subset_col(x, select, ...)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset_row.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to get the rows out of a covariance_structure — subset_row","title":"Function to get the rows out of a covariance_structure — subset_row","text":"Function get rows covariance_structure","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/subset_row.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to get the rows out of a covariance_structure — subset_row","text":"","code":"subset_row(x, select, ...)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of a pif object — summary","title":"Summary of a pif object — summary","text":"Gets potential impact fraction summary","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of a pif object — summary","text":"object pif_class object. ... Additional parameters pass summary (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary of a pif object — summary","text":"","code":"my_pif <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1, var_beta = 0.2) summary(my_pif) #>                PIF standard_deviation             ci_low              ci_up  #>          0.2858350          0.2689564         -0.4940436          0.6586233  #>         confidence  #>          0.9500000"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"Combine potential impact fractions population attributable fractions either generate total fraction fractions subpopulations (pif_total/paf_total) ensemble fraction population different (independent) exposures.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"","code":"paf_total(   paf1,   ...,   weights,   var_weights = 0,   var_pif_weights = NULL,   conf_level = 0.95,   link = \"log-complement\",   link_inv = NULL,   link_deriv = NULL,   quiet = FALSE,   label = NULL )  pif_total(   pif1,   ...,   weights,   var_weights = 0,   var_pif_weights = NULL,   conf_level = 0.95,   link = \"log-complement\",   link_inv = NULL,   link_deriv = NULL,   quiet = FALSE,   label = NULL,   is_paf = FALSE,   weights_sum_to_1 = TRUE )  paf_ensemble(   paf1,   ...,   weights = NULL,   var_weights = 0,   var_pif_weights = NULL,   link = \"identity\",   link_inv = NULL,   link_deriv = NULL,   conf_level = 0.95,   label = NULL,   quiet = FALSE )  pif_ensemble(   pif1,   ...,   weights = NULL,   var_weights = 0,   var_pif_weights = NULL,   link = \"identity\",   link_inv = NULL,   link_deriv = NULL,   conf_level = 0.95,   quiet = FALSE,   label = NULL,   is_paf = FALSE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"paf1 population attributable fraction (class pif_class) ... remaining potential impact fractions (respectively) population attributable fractions. weights vector containing proportion population categories (pifs given). var_weights link_covariance structure weights. Can 0 (default) weights random, vector link_variances weights available link_covariance matrix. var_pif_weights covariance matrix row column j representing covariance -th potential impact fraction list j-th weight conf_level Confidence level confidence interval (default 0.95). link Link function pif confidence intervals stays within expected bounds. link_inv inverse link. example link logit inv_logit. link_deriv Derivative link function. function tries build automatically link using Deriv::Deriv(). quiet Whether show messages. label Character identifier impact fraction. pif1 potential impact fraction (class pif_class) is_paf Whether computed quantity population attributable fraction weights_sum_to_1 Boolean flag indicating weights sum 1 (normalized weights) (unnormalized).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":"total-potential-impact-fraction","dir":"Reference","previous_headings":"","what":"Total potential impact fraction","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"Assuming overall population can subdivided \\(N\\) distinct subpopulations different potential impact fraction (population attributable fraction) can estimate total population attributable fraction potential impact fraction whole population : $$  \\text{PIF}_{\\text{Total}} = \\sum\\limits_{= 1}^{N} \\pi_i \\cdot \\text{PIF}_i $$ \\(\\text{PIF}_i\\) corresponds potential impact fraction -th subpopulation \\(\\pi_i\\) correspond proportion total population occupied \\(\\text{PIF}_i\\). weights \\(\\sum_{=1}^{N} \\pi_i = 1\\).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":"ensemble-potential-impact-fraction","dir":"Reference","previous_headings":"","what":"Ensemble potential impact fraction","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"population exposed \\(K\\) different independent risk factors ensemble impact fraction combination factors can written : $$  \\text{PIF}_{\\text{Ensemble}} = 1 - \\prod\\limits_{\\ell = 1}^{K} \\Big(1 - \\pi_{\\ell} \\cdot  \\text{PIF}_{\\ell}\\Big) $$ \\(\\text{PIF}_{\\ell}\\) corresponds potential impact fraction \\(\\ell\\)-th risk factor population.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/totalpifpaf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine Potential Impact Fractions and Population Attributable Fractions — totalpifpaf","text":"","code":"#Potential impact fraction for women pif_women <- pif(0.32, 0.1, 1.2, quiet = TRUE, var_p = 0.1)  #Potential impact fraction for men pif_men <- pif(0.27, 0.1, 1.3, quiet = TRUE, var_p = 0.1)  #Population potential impact fraction with 49% men and 51% women pif_total(pif_men, pif_women, weights = c(0.49, 0.51), link = \"logit\") #>  #> ── Potential Impact Fraction: [deltapif-127051311021181] ── #>  #> PIF = 27.862% [95% CI: 22.944% to 33.377%] #> standard_deviation(pif %) = 23.319 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 26.372% (sd %: 36.119) --- [deltapif-0786362576309776] #> • 29.294% (sd %: 29.772) --- [deltapif-0340637876031232] #> ────────────────────────────────────────────────────────────────────────────────  #Population attributable  fraction for women paf_women <- paf(0.32, 1.3, quiet = TRUE, var_p = 0.1)  #Population attributable  fraction for men paf_men <- paf(0.27, 1.3, quiet = TRUE, var_p = 0.1) paf_total(paf_men, paf_women, weights = c(0.49, 0.51), link = \"logit\") #>  #> ── Population Attributable Fraction: [deltapif-131763369782387] ── #>  #> PAF = 44.018% [95% CI: 38.601% to 49.581%] #> standard_deviation(paf %) = 18.760 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 41.884% (sd %: 28.509) --- [deltapif-090281494922007] #> • 46.068% (sd %: 24.552) --- [deltapif-16865047424422] #> ────────────────────────────────────────────────────────────────────────────────  # Calculate the ensemble from lead and radiation exposure paf_lead <- paf(0.2, 2.2, quiet = TRUE, var_p = 0.001) paf_rad  <- paf(0.1, 1.2, quiet = TRUE, var_p = 0.0001) pif_ensemble(paf_lead, paf_rad) #>  #> ── Population Attributable Fraction: [deltapif-0239959572121817] ── #>  #> PAF = 68.841% [95% CI: 64.670% to 73.013%] #> standard_deviation(paf %) = 3.092 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 61.612% (sd %: 3.740) --- [deltapif-096812583702407] #> • 18.832% (sd %: 1.529) --- [deltapif-0102603036376881] #> ────────────────────────────────────────────────────────────────────────────────  # Totals and ensembles can be combined pif_lead_women <- paf(0.27, 2.2, quiet = TRUE, var_p = 0.001) pif_rad_women  <- paf(0.12, 1.2, quiet = TRUE, var_p = 0.001) pif_women      <- pif_ensemble(pif_lead_women, pif_rad_women) pif_lead_men   <- paf(0.30, 2.2, quiet = TRUE, var_p = 0.001) pif_rad_men    <- paf(0.10, 1.2, quiet = TRUE, var_p = 0.001) pif_men        <- pif_ensemble(pif_lead_men, pif_rad_men)  pif_total(pif_men, pif_women, weights = c(0.49, 0.51)) #>  #> ── Population Attributable Fraction: [deltapif-106446420865157] ── #>  #> PAF = 75.731% [95% CI: 74.815% to 76.612%] #> standard_deviation(paf %) = 1.668 #> ────────────────────────────────── Components: ───────────────────────────────── #> • 76.180% (sd %: 2.271) --- [deltapif-0356124415722617] #> • 75.299% (sd %: 2.435) --- [deltapif-0876777326556075] #> ────────────────────────────────────────────────────────────────────────────────"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/validators.html","id":null,"dir":"Reference","previous_headings":"","what":"Validators Functions used in the validations of classes — validators","title":"Validators Functions used in the validations of classes — validators","text":"Validators Functions used validations classes Validate generic ensemble including pif total","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/validators.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validators Functions used in the validations of classes — validators","text":"","code":"validate_global_ensemble(self)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/validators.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validators Functions used in the validations of classes — validators","text":"self pif_class pif_atomic_class object created S7.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/var_prod.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance product formula — var_prod","title":"Variance product formula — var_prod","text":"Implements variance product formula product two random variables. formula var(X*Y) given : $$ \\text{Var}[XY] = Y^2\\cdot\\text{Var}[X]  + X^2\\cdot \\text{Var}[Y] + \\text{Var}[X] \\cdot \\text{Var}[Y] $$","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/var_prod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance product formula — var_prod","text":"","code":"var_prod(x, y, var_x, var_y)"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/var_prod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance product formula — var_prod","text":"x Numeric value representing mean first random variable X. y Numeric value representing mean second random variable Y. var_x Numeric value representing variance X. Must non-negative. var_y Numeric value representing variance Y. Must non-negative.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/var_prod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance product formula — var_prod","text":"Numeric value representing variance product X*Y.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/var_prod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance product formula — var_prod","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage var_prod(x = 2, y = 3, var_x = 0.5, var_y = 0.8)  # When one variable has zero variance var_prod(x = 5, y = 4, var_x = 0, var_y = 1.2)  # When both variables have zero variance var_prod(x = 10, y = 20, var_x = 0, var_y = 0)  # With larger variances var_prod(x = 100, y = 200, var_x = 25, var_y = 36) } # }"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted Adjusted Fractions — weighted_adjusted_fractions","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"Calculates weighted adjusted potential impact fractions (population attributable fractions). individual fraction \\(\\widehat{\\text{PIF}}_i\\) rescaled proportionally together consistent ensemble fraction.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"","code":"weighted_adjusted_fractions(   pif1,   ...,   pif_total_link = \"log-complement\",   pif_total_link_inv = NULL,   pif_total_link_deriv = NULL,   pif_ensemble_link = \"identity\",   pif_ensemble_link_inv = NULL,   pif_ensemble_link_deriv = NULL,   weights_ensemble = NULL,   var_weights_ensemble = 0,   var_pif_weights_ensemble = NULL,   var_p = NULL,   var_beta = NULL,   conf_level = 0.95,   label_ensemble = NULL,   label_sum = NULL,   quiet = FALSE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"pif1 potential impact fraction (class pif_class). first individual fractions adjusted. ... remaining potential impact fractions (class pif_class). fractions must type (PIF PAF). pif_total_link Link pass pif_total denominator adjustment pif_total_link_inv Inverse link pass pif_total denominator adjustment pif_total_link_deriv Derivative link pass pif_total denominator adjustment pif_ensemble_link Link pass pif_ensemble numerator adjustment pif_ensemble_link_inv Inverse link pass pif_ensemble numerator adjustment pif_ensemble_link_deriv Derivative link pass pif_ensemble numerator adjustment weights_ensemble Weights ensemble (pif_ensemble). Passed directly pif_ensemble() / paf_ensemble(). Defaults NULL (equal weights 1 fraction). var_weights_ensemble Covariance structure weights_ensemble. Passed directly pif_ensemble() / paf_ensemble(). Defaults 0. var_pif_weights_ensemble Covariance matrix individual fractions weights_ensemble. Passed pif_ensemble() / paf_ensemble(). Defaults NULL. var_p Covariance matrix prevalence parameters p across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. var_beta Covariance matrix relative-risk parameters beta across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. conf_level Confidence level confidence interval (default 0.95). label_ensemble Character label internally constructed ensemble fraction. Defaults NULL (auto-generated). label_sum Character label internally constructed sum (total) fraction. Defaults NULL (auto-generated). quiet Whether show messages.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"named list pif_class objects, one per input fraction, element \\(\\widehat{\\text{PIF}}_i^{\\text{adj}}\\). Names taken label slots input fractions.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"formula","dir":"Reference","previous_headings":"","what":"Formula","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"weighted adjusted fraction \\(\\)-th exposure : $$   \\widehat{\\text{PIF}}_i^{\\text{adj}} =     \\frac{\\widehat{\\text{PIF}}_i}{\\sum_{j=1}^{n} \\widehat{\\text{PIF}}_j}     \\cdot \\widehat{\\text{PIF}}_{\\text{Ensemble}} $$ Using log-transform, variance : $$ \\begin{aligned}   \\operatorname{Var}\\!\\Big[\\ln \\widehat{\\text{PIF}}_i^{\\text{adj}}\\Big]     &= \\operatorname{Var}\\!\\left[\\ln \\widehat{\\text{PIF}}_i\\right]      + \\operatorname{Var}\\!\\left[\\ln \\textstyle\\sum_j \\widehat{\\text{PIF}}_j\\right]      + \\operatorname{Var}\\!\\left[\\ln \\widehat{\\text{PIF}}_{\\text{Ensemble}}\\right] \\\\     &\\quad + 2\\Bigg[         \\operatorname{Cov}\\!\\Big(\\ln \\widehat{\\text{PIF}}_i,           \\ln \\widehat{\\text{PIF}}_{\\text{Ensemble}}\\Big)       - \\operatorname{Cov}\\!\\Big(\\ln \\widehat{\\text{PIF}}_i,           \\ln \\textstyle\\sum_j \\widehat{\\text{PIF}}_j\\Big)       - \\operatorname{Cov}\\!\\Big(\\ln \\widehat{\\text{PIF}}_{\\text{Ensemble}},           \\ln \\textstyle\\sum_j \\widehat{\\text{PIF}}_j\\Big)       \\Bigg] \\end{aligned} $$ log-covariance approximated via delta method: $$   \\operatorname{Cov}\\!\\big(\\ln X, \\ln Y\\big) \\approx     \\frac{\\operatorname{Cov}(X, Y)}{X \\cdot Y} $$ covariances \\(\\operatorname{Cov}(\\widehat{\\text{PIF}}_i, \\cdot)\\) computed cov_total_pif() applied individual fraction internally constructed sum/ensemble objects, automatically propagates full uncertainty structure already embedded objects.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"internal-construction","dir":"Reference","previous_headings":"","what":"Internal construction","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"Internally function builds: sum fraction via pif_total_class() weights equal 1, pif slot equals \\(\\sum_i \\widehat{\\text{PIF}}_i\\). ensemble fraction via pif_ensemble() / paf_ensemble(). cross-covariances computed automatically recursive cov_total_pif() machinery already handles atomic, total, ensemble fractions.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_fractions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted Adjusted Fractions — weighted_adjusted_fractions","text":"","code":"paf_lead <- paf(0.2, 2.2, quiet = TRUE, var_p = 0.001, label = \"Lead\") paf_rad  <- paf(0.1, 1.2, quiet = TRUE, var_p = 0.0001, label = \"Radiation\")  # Adjusted fractions (covariances computed automatically) adj <- weighted_adjusted_fractions(paf_lead, paf_rad) adj$Lead #>  #> ── Population Attributable Fraction: [Lead_adj] ── #>  #> PAF = 52.726% [95% CI: 46.604% to 58.847%] #> standard_deviation(paf %) = 3.123 adj$Radiation #>  #> ── Population Attributable Fraction: [Radiation_adj] ── #>  #> PAF = 16.116% [95% CI: 13.560% to 18.671%] #> standard_deviation(paf %) = 1.304  # With correlated prevalences adj2 <- weighted_adjusted_fractions(paf_lead, paf_rad, var_p = 0.0001) adj2$Lead #>  #> ── Population Attributable Fraction: [Lead_adj] ── #>  #> PAF = 52.726% [95% CI: 44.538% to 60.913%] #> standard_deviation(paf %) = 4.177"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_paf.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted Adjusted PAF — weighted_adjusted_paf","title":"Weighted Adjusted PAF — weighted_adjusted_paf","text":"Convenience wrapper around weighted_adjusted_fractions() population attributable fractions (PAF).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_paf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted Adjusted PAF — weighted_adjusted_paf","text":"","code":"weighted_adjusted_paf(   paf1,   ...,   weights_ensemble = NULL,   var_weights_ensemble = 0,   var_pif_weights_ensemble = NULL,   var_p = NULL,   var_beta = NULL,   conf_level = 0.95,   label_ensemble = NULL,   label_sum = NULL,   quiet = FALSE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_paf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted Adjusted PAF — weighted_adjusted_paf","text":"paf1 population attributable fraction (class pif_class type = \"PAF\"). ... remaining potential impact fractions (class pif_class). fractions must type (PIF PAF). weights_ensemble Weights ensemble (pif_ensemble). Passed directly pif_ensemble() / paf_ensemble(). Defaults NULL (equal weights 1 fraction). var_weights_ensemble Covariance structure weights_ensemble. Passed directly pif_ensemble() / paf_ensemble(). Defaults 0. var_pif_weights_ensemble Covariance matrix individual fractions weights_ensemble. Passed pif_ensemble() / paf_ensemble(). Defaults NULL. var_p Covariance matrix prevalence parameters p across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. var_beta Covariance matrix relative-risk parameters beta across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. conf_level Confidence level confidence interval (default 0.95). label_ensemble Character label internally constructed ensemble fraction. Defaults NULL (auto-generated). label_sum Character label internally constructed sum (total) fraction. Defaults NULL (auto-generated). quiet Whether show messages.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_paf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted Adjusted PAF — weighted_adjusted_paf","text":"named list pif_class objects (type \"PAF\"), one per input fraction, weighted adjusted PAF.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_paf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted Adjusted PAF — weighted_adjusted_paf","text":"","code":"paf_lead <- paf(0.2, 2.2, quiet = TRUE, var_p = 0.001, label = \"Lead\") paf_rad  <- paf(0.1, 1.2, quiet = TRUE, var_p = 0.0001, label = \"Radiation\")  weighted_adjusted_paf(paf_lead, paf_rad) #> $Lead #>  #> ── Population Attributable Fraction: [Lead_adj] ── #>  #> PAF = 52.726% [95% CI: 46.604% to 58.847%] #> standard_deviation(paf %) = 3.123 #>  #> $Radiation #>  #> ── Population Attributable Fraction: [Radiation_adj] ── #>  #> PAF = 16.116% [95% CI: 13.560% to 18.671%] #> standard_deviation(paf %) = 1.304 #>"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_pif.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted Adjusted PIF — weighted_adjusted_pif","title":"Weighted Adjusted PIF — weighted_adjusted_pif","text":"Convenience wrapper around weighted_adjusted_fractions() potential impact fractions (PIF).","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_pif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted Adjusted PIF — weighted_adjusted_pif","text":"","code":"weighted_adjusted_pif(   pif1,   ...,   weights_ensemble = NULL,   var_weights_ensemble = 0,   var_pif_weights_ensemble = NULL,   var_p = NULL,   var_beta = NULL,   pif_total_link = \"log-complement\",   pif_total_link_inv = NULL,   pif_total_link_deriv = NULL,   pif_ensemble_link = \"identity\",   pif_ensemble_link_inv = NULL,   pif_ensemble_link_deriv = NULL,   conf_level = 0.95,   label_ensemble = NULL,   label_sum = NULL,   quiet = FALSE )"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_pif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted Adjusted PIF — weighted_adjusted_pif","text":"pif1 potential impact fraction (class pif_class). first individual fractions adjusted. ... remaining potential impact fractions (class pif_class). fractions must type (PIF PAF). weights_ensemble Weights ensemble (pif_ensemble). Passed directly pif_ensemble() / paf_ensemble(). Defaults NULL (equal weights 1 fraction). var_weights_ensemble Covariance structure weights_ensemble. Passed directly pif_ensemble() / paf_ensemble(). Defaults 0. var_pif_weights_ensemble Covariance matrix individual fractions weights_ensemble. Passed pif_ensemble() / paf_ensemble(). Defaults NULL. var_p Covariance matrix prevalence parameters p across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. var_beta Covariance matrix relative-risk parameters beta across fractions. Passed cov_total_pif() computing cross-covariances. Defaults NULL. pif_total_link Link pass pif_total denominator adjustment pif_total_link_inv Inverse link pass pif_total denominator adjustment pif_total_link_deriv Derivative link pass pif_total denominator adjustment pif_ensemble_link Link pass pif_ensemble numerator adjustment pif_ensemble_link_inv Inverse link pass pif_ensemble numerator adjustment pif_ensemble_link_deriv Derivative link pass pif_ensemble numerator adjustment conf_level Confidence level confidence interval (default 0.95). label_ensemble Character label internally constructed ensemble fraction. Defaults NULL (auto-generated). label_sum Character label internally constructed sum (total) fraction. Defaults NULL (auto-generated). quiet Whether show messages.","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_pif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted Adjusted PIF — weighted_adjusted_pif","text":"named list pif_class objects (type \"PIF\"), one per input fraction, weighted adjusted PIF.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weighted_adjusted_pif.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted Adjusted PIF — weighted_adjusted_pif","text":"","code":"pif_lead <- pif(0.2, p_cft = 0.1, beta = log(2.2), quiet = TRUE,                 var_p = 0.001, label = \"Lead\") pif_rad  <- pif(0.1, p_cft = 0.05, beta = log(1.2), quiet = TRUE,                 var_p = 0.0001, label = \"Radiation\")  weighted_adjusted_pif(pif_lead, pif_rad) #> $Lead #>  #> ── Potential Impact Fraction: [Lead_adj] ── #>  #> PIF = 9.591% [95% CI: 4.226% to 14.956%] #> standard_deviation(pif %) = 2.737 #>  #> $Radiation #>  #> ── Potential Impact Fraction: [Radiation_adj] ── #>  #> PIF = 0.972% [95% CI: 0.595% to 1.349%] #> standard_deviation(pif %) = 0.192 #>"},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract weights of a pif_global_ensemble — weights","title":"Extract weights of a pif_global_ensemble — weights","text":"Gets weights pif_global_ensemble object","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract weights of a pif_global_ensemble — weights","text":"object pif_global_ensemble object. ... Additional parameters pass weights (ignored)","code":""},{"path":"https://rodrigozepeda.github.io/deltapif/reference/weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract weights of a pif_global_ensemble — weights","text":"","code":"my_pif1 <- pif(p = 0.5, p_cft = 0.25, beta = 1.3, var_p = 0.1, var_beta = 0.2) my_pif2 <- pif(p = 0.3, p_cft = 0.1, beta = 1.5, var_p = 0.1, var_beta = 0.2) my_pif  <- pif_total(my_pif1, my_pif2, weights = c(0.8, 0.2)) weights(my_pif) #> [1] 0.8 0.2"}]
