<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples • deltapif</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deltapif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Examples</h1>
            
      

      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rodrigozepeda.github.io/deltapif/">deltapif</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-estimating-the-paf-for-the-proportion-of-dementia-attributable-to-smoking">Example 1: Estimating the PAF for the proportion of dementia
attributable to smoking<a class="anchor" aria-label="anchor" href="#example-1-estimating-the-paf-for-the-proportion-of-dementia-attributable-to-smoking"></a>
</h3>
<p>The article by <a href="https://doi.org/10.1001/jamanetworkopen.2022.19672" class="external-link"><span class="citation">M. Lee et al. (2022)</span></a> estimates the PAF of
dementia associated with 12 risk factors (<code>logrr</code>) in US
adults. The package includes this data as well as the proportion of
exposed individuals in the respective race column (Hispanic, Asian,
Black and White):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dementiarisk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            risk_factor     logrr       sdlog total hispanic asian black white</span></span>
<span><span class="co">#&gt; 1       Less education 0.4637340 0.119140710  10.7     27.1   6.4  10.6   5.5</span></span>
<span><span class="co">#&gt; 2         Hearing loss 0.6626880 0.174038430  10.8     13.1   6.9   6.5  10.6</span></span>
<span><span class="co">#&gt; 3                  TBI 0.6097656 0.090990178  17.1     10.3   6.0   9.2  20.1</span></span>
<span><span class="co">#&gt; 4         Hypertension 0.4762342 0.167874478  42.2     38.5  38.5  61.0  39.8</span></span>
<span><span class="co">#&gt; 5    Excessive alcohol 0.1655144 0.054020949   3.6      2.0   0.7   2.7   4.2</span></span>
<span><span class="co">#&gt; 6              Obesity 0.4700036 0.091750556  44.0     48.3  14.6  54.3  43.5</span></span>
<span><span class="co">#&gt; 7              Smoking 0.4637340 0.165486566   8.5      6.9   4.9  11.7   8.4</span></span>
<span><span class="co">#&gt; 8           Depression 0.6418539 0.103984905   7.4     10.7   4.3   6.6   7.2</span></span>
<span><span class="co">#&gt; 9     Social isolation 0.4510756 0.086112272  11.9     24.0   8.0  12.1  10.8</span></span>
<span><span class="co">#&gt; 10 Physical inactivity 0.3293037 0.092961816  62.8     68.6  56.6  73.2  61.3</span></span>
<span><span class="co">#&gt; 11            Diabetes 0.4317824 0.075776055  28.6     41.0  44.1  37.2  25.4</span></span>
<span><span class="co">#&gt; 12       Air pollution 0.0861777 0.009362766  22.8     44.4  55.2  41.3  17.2</span></span></code></pre>
<p>In this example, we show how to calculate the population attributable
fraction for <strong>Smoking</strong> among the 4 race groups and then
how to calculate the <strong>Total Population Attributable
Fraction</strong> of the overall population.</p>
<p>Notice that <strong>Smoking</strong> has a log relative risk of:</p>
<ul>
<li><code>beta = 0.4637340</code></li>
</ul>
<p>with variance of</p>
<ul>
<li>
<code>var_beta = 0.0273858</code>
(<code>= 0.165486566^2</code>).</li>
</ul>
<p>Among hispanic individuals 6.9% (<code>p = 0.069</code>) smoke. Hence
their PAF is:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paf_hispanic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.069</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, var_p <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                    rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Hispanic"</span><span class="op">)</span></span>
<span><span class="va">paf_hispanic</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Hispanic]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 3.912% [<span style="font-style: italic;">95% CI</span>: 0.569% to 7.142%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 1.676</span></span></code></pre></div>
<p>The other fractions can be computed in the same way noting that 4.9%
of non-hispanic asians, 11.7% of non-hispanic blacks and 8.4% of
non-hispanic whites smoke:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paf_asian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.049</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Asian"</span><span class="op">)</span></span>
<span><span class="va">paf_black</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.117</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Black"</span><span class="op">)</span></span>
<span><span class="va">paf_white</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.084</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"White"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-combining-subpopulations-into-a-total">Example 2: Combining subpopulations into a total<a class="anchor" aria-label="anchor" href="#example-2-combining-subpopulations-into-a-total"></a>
</h3>
<p>We can calculate the <strong>total population attributable
fraction</strong> by combining the fractions of the subpopulations
weighted by the proportion of the population. According to Wikipedia the
distribution in 2020 of the US population by race was as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span> <span class="op">=</span> <span class="fl">0.5784</span>, <span class="st">"hispanic"</span> <span class="op">=</span> <span class="fl">0.1873</span>, </span>
<span>             <span class="st">"black"</span> <span class="op">=</span> <span class="fl">0.1205</span>, <span class="st">"asian"</span> <span class="op">=</span> <span class="fl">0.0592</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Normalized weights to sum to 1</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span></code></pre></div>
<p>The <code>paf_total</code> function computes the aggregated
<code>paf</code> of the whole population:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paf_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/totalpifpaf.html">paf_total</a></span><span class="op">(</span><span class="va">paf_white</span>, <span class="va">paf_hispanic</span>, <span class="va">paf_black</span>, </span>
<span>                            <span class="va">paf_asian</span>, weights <span class="op">=</span> <span class="va">weights</span>, var_weights <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                            label <span class="op">=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span><span class="va">paf_population</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[All]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 4.663% [<span style="font-style: italic;">95% CI</span>: 4.486% to 4.839%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 1.979</span></span>
<span><span class="co">#&gt; ────────────────────────────────── Components: ─────────────────────────────────</span></span>
<span><span class="co">#&gt; • 4.722% (sd %: 2.006) --- <span style="font-style: italic;">[White]</span></span></span>
<span><span class="co">#&gt; • 3.912% (sd %: 1.676) --- <span style="font-style: italic;">[Hispanic]</span></span></span>
<span><span class="co">#&gt; • 6.457% (sd %: 2.694) --- <span style="font-style: italic;">[Black]</span></span></span>
<span><span class="co">#&gt; • 2.810% (sd %: 1.218) --- <span style="font-style: italic;">[Asian]</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>where we set <code>var_weights = 0</code> as no covariance matrix was
known for the race distribution data (it does exist its just not on
Wikipedia).</p>
<p>The <code>paf</code> total implements the following formula:</p>
<p><span class="math display">\[
\textrm{PAF}_{\text{Total}} = w_1 \cdot \text{PAF}_{\text{White}} +
  w_2 \cdot \text{PAF}_{\text{Hispanic}} +
  w_3 \cdot \text{PAF}_{\text{Black}} +
  w_4 \cdot \text{PAF}_{\text{Asian}}
\]</span></p>
<p>where the weights stand for the proportion of the population in each
subgroup.</p>
<p>The <code>coef</code>, <code>confint</code>, <code>summary</code>,
and <code>as.data.frame</code> functions have been extended to allow the
user to extract information from a <code>paf</code> (or
<code>pif</code>):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">paf_population</span><span class="op">)</span></span>
<span><span class="co">#&gt;        value standard_deviation     ci_low      ci_up confidence type label</span></span>
<span><span class="co">#&gt; 1 0.04662895         0.01979259 0.04486196 0.04839268       0.95  PAF   All</span></span></code></pre></div>
<p>Attributable cases can be calculated for example using the estimates
from <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10593099/#SD2" class="external-link"><span class="citation">Dhana et al. (2023)</span></a>. They estimate the
number of people with Alzheimer’s Disease in New York, USA 426.5 (400.2,
452.7) thousand. This implies a variance of
<code>((452.7 - 400.2) / 2*qnorm(0.975))^2 = 2647.005</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/casecalc.html">attributable_cases</a></span><span class="op">(</span><span class="fl">426.5</span>, <span class="va">paf_population</span>, variance <span class="op">=</span> <span class="fl">2647</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attributable cases: </span><span style="font-weight: bold; font-style: italic;">[All]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attributable cases = 19.887 [<span style="font-style: italic;">95% CI</span>: 2.572 to 37.203]</span></span>
<span><span class="co">#&gt; standard_deviation(attributable cases) = 883.469</span></span></code></pre></div>
<!---
### Why are we using the log relative risk?

A common question is why in this case we are using the log relative risk (`logrr`) with `exp` link and not the relative risks directly. The reason depends on what standard deviation can be properly
recovered. Recall that the classic (Wald-type) confidence intervals should have the same
distance from the point estimate (in this case the `RR`) to the bounds. We can see that
this does not happen here as for example in the case of **smoking** the RR is
1.59 [1.15-2.20] and:


``` r
2.20 - 1.59
#> [1] 0.61
```

while 


``` r
1.59 - 1.15
#> [1] 0.44
```

The distances are not the same!

However in the log-scale they are much more similar:


``` r
log(2.20) - log(1.59)
#> [1] 0.3247233
```


``` r
log(1.59) - log(1.15)
#> [1] 0.3239721
```


which suggests that the uncertainty was estimated in the log-scale and hence we
need to use the log relative risk as beta and exponentiate it (`link = exp`). 
Furthermore we can go to the original paper, check the methodology and conclude
that the confidence interval (and hence the variance!) was estimated using the log-relative risk 
and then exponentiated. Hence  the uncertainty should be propagated for the 
log risk and then exponentiated. 

Mathematically the explanation of why this happens is because usually relative risks,
odds ratios and hazard ratios are transformed to the log-scale to estimate
the confidence intervals. You can see in Wikipedia, for example, 
the classic formulas for the [relative risks CIs](https://en.wikipedia.org/wiki/Relative_risk)
and for the [odds ratios](https://en.wikipedia.org/wiki/Odds_ratio#Statistical_inference) all involve a log-transform. 
--->
</div>
<div class="section level3">
<h3 id="example-3-estimating-the-pif-for-the-proportion-of-dementia-reduced-by-a-15-reduction-in-smoking-">Example 3: Estimating the PIF for the proportion of dementia reduced
by a 15% reduction in smoking.<a class="anchor" aria-label="anchor" href="#example-3-estimating-the-pif-for-the-proportion-of-dementia-reduced-by-a-15-reduction-in-smoking-"></a>
</h3>
<p><a href="https://doi.org/10.1001/jamanetworkopen.2022.19672" class="external-link"><span class="citation">M. Lee et al. (2022)</span></a> also estimates the
proportion of dementia cases that would be reduced by a 15% decrease in
smoking prevalence. This 15% reduction corresponds to multiplying the
current smoking prevalence by <code>1 - 0.15 = 0.85</code> specified
with the prevalence under the counterfactual (<code>p_cft</code>)
variable:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pif_hispanic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.069</span>, p_cft <span class="op">=</span> <span class="fl">0.069</span><span class="op">*</span><span class="fl">0.85</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Hispanic"</span><span class="op">)</span></span>
<span><span class="va">pif_asian</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.049</span>, p_cft <span class="op">=</span> <span class="fl">0.049</span><span class="op">*</span><span class="fl">0.85</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Asian"</span><span class="op">)</span></span>
<span><span class="va">pif_black</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.117</span>, p_cft <span class="op">=</span> <span class="fl">0.117</span><span class="op">*</span><span class="fl">0.85</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"Black"</span><span class="op">)</span></span>
<span><span class="va">pif_white</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.084</span>, p_cft <span class="op">=</span> <span class="fl">0.084</span><span class="op">*</span><span class="fl">0.85</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.0273858</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, rr_link <span class="op">=</span> <span class="va">exp</span>, label <span class="op">=</span> <span class="st">"White"</span><span class="op">)</span></span></code></pre></div>
<p>The total fraction of the overall population can be aggregated with
<code>pif_total</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pif_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/totalpifpaf.html">pif_total</a></span><span class="op">(</span><span class="va">pif_white</span>, <span class="va">pif_hispanic</span>, <span class="va">pif_black</span>, </span>
<span>                            <span class="va">pif_asian</span>, weights <span class="op">=</span> <span class="va">weights</span>, var_weights <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                            label <span class="op">=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span><span class="va">pif_population</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Potential Impact Fraction: </span><span style="font-weight: bold; font-style: italic;">[All]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PIF = 0.699% [<span style="font-style: italic;">95% CI</span>: 0.695% to 0.703%]</span></span>
<span><span class="co">#&gt; standard_deviation(pif %) = 0.297</span></span>
<span><span class="co">#&gt; ────────────────────────────────── Components: ─────────────────────────────────</span></span>
<span><span class="co">#&gt; • 0.708% (sd %: 0.301) --- <span style="font-style: italic;">[White]</span></span></span>
<span><span class="co">#&gt; • 0.587% (sd %: 0.251) --- <span style="font-style: italic;">[Hispanic]</span></span></span>
<span><span class="co">#&gt; • 0.969% (sd %: 0.404) --- <span style="font-style: italic;">[Black]</span></span></span>
<span><span class="co">#&gt; • 0.421% (sd %: 0.183) --- <span style="font-style: italic;">[Asian]</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>We can use the <code>as.data.frame</code> function to create a
<code>data.frame</code> with all of the results:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">pif_population</span>, <span class="va">pif_white</span>, <span class="va">pif_black</span>, <span class="va">pif_hispanic</span>, <span class="va">pif_asian</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt;         value standard_deviation       ci_low       ci_up confidence type</span></span>
<span><span class="co">#&gt; 1 0.006994343        0.002968888 0.0069537857 0.007034899       0.95  PIF</span></span>
<span><span class="co">#&gt; 2 0.007082968        0.003009649 0.0011666075 0.012964284       0.95  PIF</span></span>
<span><span class="co">#&gt; 3 0.009685883        0.004040705 0.0017344947 0.017573937       0.95  PIF</span></span>
<span><span class="co">#&gt; 4 0.005867629        0.002514437 0.0009271875 0.010783639       0.95  PIF</span></span>
<span><span class="co">#&gt; 5 0.004214654        0.001826806 0.0006277357 0.007788699       0.95  PIF</span></span>
<span><span class="co">#&gt;      label</span></span>
<span><span class="co">#&gt; 1      All</span></span>
<span><span class="co">#&gt; 2    White</span></span>
<span><span class="co">#&gt; 3    Black</span></span>
<span><span class="co">#&gt; 4 Hispanic</span></span>
<span><span class="co">#&gt; 5    Asian</span></span></code></pre></div>
<p>Averted cases can be calculated with the same number as before with
the <code>averted_cases</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/casecalc.html">averted_cases</a></span><span class="op">(</span><span class="fl">426.5</span>, <span class="va">pif_population</span>, variance <span class="op">=</span> <span class="fl">2647</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Averted cases: </span><span style="font-weight: bold; font-style: italic;">[All]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Averted cases = 2.983 [<span style="font-style: italic;">95% CI</span>: 0.386 to 5.580]</span></span>
<span><span class="co">#&gt; standard_deviation(averted cases) = 132.520</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-4-a-categorical-population-attributable-fraction">Example 4: A categorical population attributable fraction<a class="anchor" aria-label="anchor" href="#example-4-a-categorical-population-attributable-fraction"></a>
</h3>
<p><a href="https://doi.org/10.1111/1753-6405.12456" class="external-link"><span class="citation">Pandeya et al. (2015)</span></a> estimate the
population attributable fraction of different cancers given distinct
levels of alcohol consumption for the Australian population.</p>
<p>The <code>alcohol</code> dataframe included in the package contains
an estimate of the intake of alcohol by sex as well as the proportion of
individuals in each of the intake-categories:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">alcohol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;     sex alcohol_g median_intake age_18_plus</span></span>
<span><span class="co">#&gt; 1  MALE      None           0.0        47.2</span></span>
<span><span class="co">#&gt; 2  MALE   &gt;0-&lt;1 g           0.8         1.4</span></span>
<span><span class="co">#&gt; 3  MALE     1-&lt;2g           1.6         2.2</span></span>
<span><span class="co">#&gt; 4  MALE     2-&lt;5g           3.2         8.1</span></span>
<span><span class="co">#&gt; 5  MALE    5-&lt;10g           7.1         8.1</span></span>
<span><span class="co">#&gt; 6  MALE   10-&lt;15g          12.6         6.9</span></span>
<span><span class="co">#&gt; 7  MALE   15-&lt;20g          17.4         4.6</span></span>
<span><span class="co">#&gt; 8  MALE   20-&lt;30g          24.5         7.3</span></span>
<span><span class="co">#&gt; 9  MALE   30-&lt;40g          34.7         4.2</span></span>
<span><span class="co">#&gt; 10 MALE   40-&lt;50g          44.2         3.2</span></span>
<span><span class="co">#&gt; 11 MALE   50-&lt;60g          54.4         2.0</span></span>
<span><span class="co">#&gt; 12 MALE      ≥60g          85.2         4.8</span></span></code></pre>
<p>The relative risk of alcohol varies by consumption level
(<code>alcohol_g</code>). For example in the case of rectal cancer the
estimated relative risk is 1.10 (1.07–1.12) per 10g/day. We will need to
compute the relative risk for each of the consumption level groups using
their median intake as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Get alcohol intake for men divided by 10 cause RR is per 10g/day</span></span>
<span><span class="va">alcohol_men_intake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">3.2</span>, <span class="fl">7.1</span>, <span class="fl">12.6</span>, <span class="fl">17.4</span>, <span class="fl">24.5</span>, <span class="fl">34.7</span>, </span>
<span>                        <span class="fl">44.2</span>, <span class="fl">54.4</span>, <span class="fl">85.2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span> </span>
<span></span>
<span><span class="co">#Divided by 10 cause risk is per 10 g/day</span></span>
<span><span class="va">relative_risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.10</span><span class="op">)</span><span class="op">*</span><span class="va">alcohol_men_intake</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Divide by 100 to get the prevalence in decimals</span></span>
<span><span class="va">prevalence</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.472</span>, <span class="fl">0.014</span>, <span class="fl">0.022</span>, <span class="fl">0.081</span>, <span class="fl">0.081</span>, <span class="fl">0.069</span>, <span class="fl">0.046</span>, </span>
<span>                   <span class="fl">0.073</span>, <span class="fl">0.042</span>, <span class="fl">0.032</span>, <span class="fl">0.02</span>, <span class="fl">0.048</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calculate the paf</span></span>
<span><span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span><span class="va">prevalence</span>, beta <span class="op">=</span> <span class="va">relative_risk</span>, var_p <span class="op">=</span> <span class="fl">0</span>, var_b <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0102908670119104]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 70.114% [<span style="font-style: italic;">95% CI</span>: 70.114% to 70.114%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.000</span></span></code></pre></div>
<p>If we want to add uncertainty we can approximate the covariance of
the relative risk as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculate covariance of the betas given by variance*intake_i*intake_j</span></span>
<span><span class="va">beta_sd</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1.12</span> <span class="op">-</span> <span class="fl">1.07</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, ncol <span class="op">=</span> <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">beta_var</span><span class="op">[</span><span class="va">k</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">beta_sd</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">alcohol_men_intake</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">alcohol_men_intake</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Calculate the paf</span></span>
<span><span class="va">paf_males</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span><span class="va">prevalence</span>, beta <span class="op">=</span> <span class="va">relative_risk</span>, var_p <span class="op">=</span> <span class="fl">0</span>, var_b <span class="op">=</span> <span class="va">beta_var</span>, </span>
<span>               label <span class="op">=</span> <span class="st">"Males"</span><span class="op">)</span></span>
<span><span class="va">paf_males</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Males]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 70.114% [<span style="font-style: italic;">95% CI</span>: 68.480% to 71.663%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.812</span></span></code></pre></div>
<p>We can repeat the same process for females:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Get alcohol intake for women divided by 10 cause RR is per 10g/day</span></span>
<span><span class="va">alcohol_female_intake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">3.9</span>, <span class="fl">7.1</span>, <span class="fl">12.6</span>, <span class="fl">17.4</span>, </span>
<span>                           <span class="fl">24.5</span>, <span class="fl">34.7</span>, <span class="fl">44.2</span>, <span class="fl">54.4</span>, <span class="fl">78.1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Divided by 10 cause risk is per 10 g/day</span></span>
<span><span class="va">relative_risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.10</span><span class="op">)</span><span class="op">*</span><span class="va">alcohol_female_intake</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Divide by 100 to get the prevalence in decimals</span></span>
<span><span class="va">prevalence</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.603</span>, <span class="fl">0.02</span>, <span class="fl">0.054</span>, <span class="fl">0.091</span>, <span class="fl">0.081</span>, <span class="fl">0.061</span>, <span class="fl">0.026</span>, </span>
<span>                   <span class="fl">0.034</span>, <span class="fl">0.015</span>, <span class="fl">0.007</span>, <span class="fl">0.003</span>, <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calculate covariance of the betas given by variance*intake_i*intake_j</span></span>
<span><span class="va">beta_sd</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1.12</span> <span class="op">-</span> <span class="fl">1.07</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, ncol <span class="op">=</span> <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">prevalence</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">beta_var</span><span class="op">[</span><span class="va">k</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">beta_sd</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">alcohol_female_intake</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">alcohol_female_intake</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Calculate the paf</span></span>
<span><span class="va">paf_females</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span><span class="va">prevalence</span>, beta <span class="op">=</span> <span class="va">relative_risk</span>, var_p <span class="op">=</span> <span class="fl">0</span>, var_b <span class="op">=</span> <span class="va">beta_var</span>, </span>
<span>                   label <span class="op">=</span> <span class="st">"Females"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">paf_females</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Females]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 65.264% [<span style="font-style: italic;">95% CI</span>: 64.737% to 65.784%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.267</span></span></code></pre></div>
<p>The total fraction can be computed with <code>paf_total</code>
assuming both males and females are 50% each of the population:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/totalpifpaf.html">paf_total</a></span><span class="op">(</span><span class="va">paf_males</span>, <span class="va">paf_females</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0974069593265456]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 67.689% [<span style="font-style: italic;">95% CI</span>: 67.426% to 67.950%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.427</span></span>
<span><span class="co">#&gt; ────────────────────────────────── Components: ─────────────────────────────────</span></span>
<span><span class="co">#&gt; • 70.114% (sd %: 0.812) --- <span style="font-style: italic;">[Males]</span></span></span>
<span><span class="co">#&gt; • 65.264% (sd %: 0.267) --- <span style="font-style: italic;">[Females]</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-5-combining-fractions-of-different-risks-into-an-ensemble">Example 5: Combining fractions of different risks into an
ensemble<a class="anchor" aria-label="anchor" href="#example-5-combining-fractions-of-different-risks-into-an-ensemble"></a>
</h3>
<p><span class="citation">M. Lee et al. (2022)</span> combines multiple
population attributable fractions from different risk exposures can be
combined into a single fraction. For example, we can create an
attributable fraction for <strong>behavioral</strong> risk factors by
joining the fractions for: smoking, physical inactivity, and excesive
alcohol consumption into one fraction that represents the reduction in
cases if all of these exposures were taken to the level of minimum
risk.</p>
<p>For that purpose we calculate each of the fractions separately and
then use the <code>paf_ensemble</code> function to join them. We first
obtain the log-relative risk, its standard deviation, and the total
proportion of individuals exposed (here we highlight the part of the
table):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dementiarisk</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            risk_factor     logrr      sdlog total</span></span>
<span><span class="co">#&gt; 5    Excessive alcohol 0.1655144 0.05402095   3.6</span></span>
<span><span class="co">#&gt; 7              Smoking 0.4637340 0.16548657   8.5</span></span>
<span><span class="co">#&gt; 10 Physical inactivity 0.3293037 0.09296182  62.8</span></span></code></pre>
<p>We then calculate the population attributable fraction for each:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paf_alcohol</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.036</span>, beta <span class="op">=</span> <span class="fl">0.1655144</span>, var_beta <span class="op">=</span> <span class="fl">0.05402095</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Alcohol"</span><span class="op">)</span></span>
<span><span class="va">paf_smoking</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.085</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.16548657</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Smoking"</span><span class="op">)</span></span>
<span><span class="va">paf_physical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.628</span>, beta <span class="op">=</span> <span class="fl">0.3293037</span>, var_beta <span class="op">=</span> <span class="fl">0.09296182</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Physical Activity"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>paf_ensemble</code> function allows to calculate the
ensemble <code>paf</code> by estimating the product:</p>
<p><span class="math display">\[
\textrm{PAF}_{\text{Ensemble}} = 1 - (1 - w_1
\cdot\textrm{PAF}_{\text{Alcohol}})\cdot (1 - w_2
\cdot\textrm{PAF}_{\text{Smoking}})\cdot (1 - w_3\cdot
\textrm{PAF}_{\text{Physical}})
\]</span></p>
<p>where the weights are oftentimes calculated via a communality
correction or are set to 1 for disjointed risks. In the case of this
paper the communality estimates were:</p>
<ul>
<li><p><strong>Physical inactivity:</strong> 31.1</p></li>
<li><p><strong>Smoking:</strong> 5.9</p></li>
<li><p><strong>Excessive alcohol:</strong> 3.8</p></li>
</ul>
<p>hence we can use them as the <code>weights</code> argument:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/totalpifpaf.html">paf_ensemble</a></span><span class="op">(</span><span class="va">paf_alcohol</span>, <span class="va">paf_physical</span>, <span class="va">paf_smoking</span>, </span>
<span>             weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.038</span>, <span class="fl">0.311</span>, <span class="fl">0.059</span><span class="op">)</span>,</span>
<span>             label <span class="op">=</span> <span class="st">"Behavioural factors"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Behavioural factors]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 6.406% [<span style="font-style: italic;">95% CI</span>: 6.202% to 6.610%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 1.627</span></span>
<span><span class="co">#&gt; ────────────────────────────────── Components: ─────────────────────────────────</span></span>
<span><span class="co">#&gt; • 0.644% (sd %: 0.227) --- <span style="font-style: italic;">[Alcohol]</span></span></span>
<span><span class="co">#&gt; • 19.674% (sd %: 5.236) --- <span style="font-style: italic;">[Physical Activity]</span></span></span>
<span><span class="co">#&gt; • 4.776% (sd %: 2.028) --- <span style="font-style: italic;">[Smoking]</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>Finally, variance among the weights can be implemented with the
<code>var_weights</code> argument providing a variance-covariance
matrix:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Variance covariance matrix</span></span>
<span><span class="va">weight_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="op">-</span><span class="fl">0.02</span>, </span>
<span>     <span class="fl">0.21</span>, <span class="fl">1.00</span>,  <span class="fl">0.09</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.02</span>, <span class="fl">0.09</span>,  <span class="fl">1.00</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weight_variance</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alcohol"</span>, <span class="st">"Physical inactivity"</span>, <span class="st">"Smoking"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">weight_variance</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alcohol"</span>, <span class="st">"Physical inactivity"</span>, <span class="st">"Smoking"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/totalpifpaf.html">paf_ensemble</a></span><span class="op">(</span><span class="va">paf_alcohol</span>, <span class="va">paf_physical</span>, <span class="va">paf_smoking</span>, </span>
<span>             weights     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.038</span>, <span class="fl">0.311</span>, <span class="fl">0.059</span><span class="op">)</span>,</span>
<span>             var_weights <span class="op">=</span> <span class="va">weight_variance</span>,</span>
<span>             label       <span class="op">=</span> <span class="st">"Behavioural factors"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Behavioural factors]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 6.406% [<span style="font-style: italic;">95% CI</span>: 3.807% to 9.005%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 20.699</span></span>
<span><span class="co">#&gt; ────────────────────────────────── Components: ─────────────────────────────────</span></span>
<span><span class="co">#&gt; • 0.644% (sd %: 0.227) --- <span style="font-style: italic;">[Alcohol]</span></span></span>
<span><span class="co">#&gt; • 19.674% (sd %: 5.236) --- <span style="font-style: italic;">[Physical Activity]</span></span></span>
<span><span class="co">#&gt; • 4.776% (sd %: 2.028) --- <span style="font-style: italic;">[Smoking]</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-6-adjusted-fractions">Example 6: Adjusted fractions<a class="anchor" aria-label="anchor" href="#example-6-adjusted-fractions"></a>
</h3>
<p>Adjusting for communality is a way to discount the contribution of
correlated risk factors. <span class="citation">M. Lee et al.
(2022)</span> estimates the adjusted fractions by computing the ensemble
fraction as above (lee calls it Overall):</p>
<p><span class="math display">\[
\textrm{PAF}_{\text{Ensemble}} = 1 - (1 - w_1
\cdot\textrm{PAF}_{\text{Alcohol}})\cdot (1 - w_2
\cdot\textrm{PAF}_{\text{Smoking}})\cdot (1 - w_3\cdot
\textrm{PAF}_{\text{Physical}})
\]</span></p>
<p>And then normalizing the proportion of each fraction as part of the
ensemble. For example with alcohol:</p>
<p><span class="math display">\[
\textrm{PAF}_{\text{Alcohol}}^{\text{Adj}} =
\dfrac{\textrm{PAF}_{\text{Alcohol}}}{\textrm{PAF}_{\text{Alcohol}} +
\textrm{PAF}_{\text{Smoking}} + \textrm{PAF}_{\text{Physical}}} \cdot
\textrm{PAF}_{\text{Ensemble}}
\]</span> The same process is repeated for adjusting smoking and
physical by just changing the numerator of the fraction. This can be
computed in the package as:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculate each of the fractions</span></span>
<span><span class="va">paf_alcohol</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.036</span>, beta <span class="op">=</span> <span class="fl">0.1655144</span>, var_beta <span class="op">=</span> <span class="fl">0.05402095</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Alcohol"</span><span class="op">)</span></span>
<span><span class="va">paf_smoking</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.085</span>, beta <span class="op">=</span> <span class="fl">0.4637340</span>, var_beta <span class="op">=</span> <span class="fl">0.16548657</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Smoking"</span><span class="op">)</span></span>
<span><span class="va">paf_physical</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.628</span>, beta <span class="op">=</span> <span class="fl">0.3293037</span>, var_beta <span class="op">=</span> <span class="fl">0.09296182</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>                    var_p <span class="op">=</span> <span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Physical Activity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get the communality weights</span></span>
<span><span class="va">cweights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.038</span>, <span class="fl">0.311</span>, <span class="fl">0.059</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calculate the adjusted versions</span></span>
<span><span class="fu"><a href="../reference/weighted_adjusted.html">weighted_adjusted_paf</a></span><span class="op">(</span><span class="va">paf_alcohol</span>, <span class="va">paf_smoking</span>, <span class="va">paf_physical</span>, weights <span class="op">=</span> <span class="va">cweights</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Alcohol</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Alcohol_adj]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 0.068% [<span style="font-style: italic;">95% CI</span>: 0.016% to 0.120%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Smoking</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Smoking_adj]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 0.505% [<span style="font-style: italic;">95% CI</span>: 0.099% to 0.911%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.207</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Physical Activity`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[Physical Activity_adj]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 2.080% [<span style="font-style: italic;">95% CI</span>: 1.359% to 2.800%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 0.368</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-7-ensuring-non-negative-fractions">Example 7: Ensuring non-negative fractions<a class="anchor" aria-label="anchor" href="#example-7-ensuring-non-negative-fractions"></a>
</h3>
<p><span class="citation">S. Lee et al. (2024)</span> show an example
with a relative risk of <code>rr = 7.0</code> (log relative risk
<code>1.94591</code>) and a log-variance of <code>0.35.</code> that
results in a negative confidence interval when applying directly the
delta method:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, beta <span class="op">=</span> <span class="fl">1.94</span>, var_beta <span class="op">=</span> <span class="fl">0.591</span><span class="op">^</span><span class="fl">2</span>, var_p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0173820105906731]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 22.955% [<span style="font-style: italic;">95% CI</span>: -5.100% to 43.520%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 12.206</span></span></code></pre></div>
<p>The <code>pif</code> and <code>paf</code> functions contain the
<code>logit</code> link option for guaranteeing positivity in the
fraction’s intervals:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pifpaf.html">paf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, beta <span class="op">=</span> <span class="fl">1.94</span>, var_beta <span class="op">=</span> <span class="fl">0.591</span><span class="op">^</span><span class="fl">2</span>, var_p <span class="op">=</span> <span class="fl">0</span>, link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Population Attributable Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0178812018276085]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PAF = 22.955% [<span style="font-style: italic;">95% CI</span>: 7.152% to 53.541%]</span></span>
<span><span class="co">#&gt; standard_deviation(paf %) = 12.206</span></span></code></pre></div>
<p>We remark that this option is not turned on by default as the
<strong>positivity</strong> of the fraction depends on:</p>
<ol style="list-style-type: decimal">
<li><p>The relative risk being strictly greater than 1.</p></li>
<li><p>Epidemiological rationale on why the fraction should be
positive.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="example-8-computing-averted-and-attributable-cases">Example 8: Computing averted and attributable cases<a class="anchor" aria-label="anchor" href="#example-8-computing-averted-and-attributable-cases"></a>
</h3>
<p>Attributable and averted cases can be calculated with the
<code>attributable_cases</code> (resp. <code>averted_cases</code>)
function. For example <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10593099/#SD2" class="external-link"><span class="citation">Dhana et al. (2023)</span></a> estimates the number of
people with Alzheimer’s Disease in New York, USA 426.5 (400.2, 452.7)
thousand. This implies a variance of
<code>((452.7 - 400.2) / 2*qnorm(0.975))^2 = 2647.005</code>.</p>
<p>To estimate cases we need to:</p>
<ol style="list-style-type: decimal">
<li>Estimate the corresponding potential impact fraction (averted) or
population attributable fraction (attributable)</li>
<li>Use the <code>averted_cases</code> (resp.
<code>attributable_cases</code> function)</li>
</ol>
<p>We start by calcualting the same fraction as before from <a href="https://doi.org/10.1001/jamanetworkopen.2022.19672" class="external-link"><span class="citation">M. Lee et al. (2022)</span></a>. This considers the
impact on dementia of reducing smoking prevalence by 15% (from 8.5% to
7.225%). The PIF for this intervention is:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pif_smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span></span>
<span>  p        <span class="op">=</span> <span class="fl">0.085</span>, </span>
<span>  p_cft    <span class="op">=</span> <span class="fl">0.085</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.15</span><span class="op">)</span>, <span class="co"># 15% reduction</span></span>
<span>  beta     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.59</span><span class="op">)</span>, </span>
<span>  var_beta <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.20</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, </span>
<span>  var_p    <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pif_smoking</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Potential Impact Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0698429449342544]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PIF = 0.716% [<span style="font-style: italic;">95% CI</span>: 0.118% to 1.311%]</span></span>
<span><span class="co">#&gt; standard_deviation(pif %) = 0.304</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/casecalc.html">averted_cases</a></span><span class="op">(</span><span class="fl">426.5</span>, <span class="va">pif_smoking</span>, variance <span class="op">=</span> <span class="fl">2647.005</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Averted cases: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0698429449342544]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Averted cases = 3.055 [<span style="font-style: italic;">95% CI</span>: 0.394 to 5.716]</span></span>
<span><span class="co">#&gt; standard_deviation(averted cases) = 135.779</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-9-computing-averted-cases-strictly-positive">Example 9: Computing averted cases (strictly positive)<a class="anchor" aria-label="anchor" href="#example-9-computing-averted-cases-strictly-positive"></a>
</h3>
<p>In some cases it might be of interest to guarantee the positivity of
the averted cases. Following the previous example, a higher
(hypothetical) variance might result in a confidence interval that
includes negative values:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/casecalc.html">averted_cases</a></span><span class="op">(</span><span class="fl">426.5</span>, <span class="va">pif_smoking</span>, variance <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Averted cases: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0698429449342544]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Averted cases = 3.055 [<span style="font-style: italic;">95% CI</span>: -2.398 to 8.508]</span></span>
<span><span class="co">#&gt; standard_deviation(averted cases) = 278.207</span></span></code></pre></div>
<p>When there is an epidemiological rationale on the interval being
strictly positive (for example, the relative risk is known to be
strictly greater than 1) we can change the link function to
<code>logit</code> to guarantee the interval is always positive:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/casecalc.html">averted_cases</a></span><span class="op">(</span><span class="fl">426.5</span>, <span class="va">pif_smoking</span>, variance <span class="op">=</span> <span class="fl">100000</span>, link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Averted cases: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0698429449342544]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Averted cases = 3.055 [<span style="font-style: italic;">95% CI</span>: 0.513 to 18.203]</span></span>
<span><span class="co">#&gt; standard_deviation(averted cases) = 278.207</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-10-using-hazard-ratios-hr-and-odds-ratios-or-instead-of-relative-risks-rr">Example 10: Using Hazard Ratios (HR) and Odds Ratios (OR) instead of
Relative Risks (RR)<a class="anchor" aria-label="anchor" href="#example-10-using-hazard-ratios-hr-and-odds-ratios-or-instead-of-relative-risks-rr"></a>
</h3>
<p>Sometimes Hazard Rates or Odds Ratios are reported in the literature.
As the potential impact fraction and the population attributable
fraction require relative risks, one needs to convert the former. One
way is via the <code>EValues</code> package which uses the method
described in <a href="https://doi.org/10.1080/01621459.2018.1529598" class="external-link"><span class="citation">Maya B. Mathur and Tyler J. VanderWeele
(2019)</span></a>.</p>
<p>In the following example we used the Hazard Ratio of shingles
vaccination on dementia by Wu et al:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">EValue</span><span class="op">)</span></span>
<span></span>
<span><span class="va">upper_rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/effect_measures.html" class="external-link">HR</a></span><span class="op">(</span><span class="fl">0.72</span>, rare <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/convert_measures.html" class="external-link">toRR</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lower_rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/effect_measures.html" class="external-link">HR</a></span><span class="op">(</span><span class="fl">0.67</span>, rare <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/convert_measures.html" class="external-link">toRR</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rr_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/effect_measures.html" class="external-link">HR</a></span><span class="op">(</span><span class="fl">0.69</span>, rare <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/convert_measures.html" class="external-link">toRR</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>which results in the risk of 0.7735267 with interval 0.76, 0.8. From
here one can calculate the potential impact fraction of doubling
vaccination coverage from the baseline of <code>p =  0.438</code> to
<code>p_cft = 0.876</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pifpaf.html">pif</a></span><span class="op">(</span></span>
<span>  p     <span class="op">=</span> <span class="fl">0.438</span>,</span>
<span>  beta  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rr_value</span><span class="op">)</span>,</span>
<span>  p_cft <span class="op">=</span> <span class="fl">0.876</span>,</span>
<span>  var_beta <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">upper_rr</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lower_rr</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Potential Impact Fraction: </span><span style="font-weight: bold; font-style: italic;">[deltapif-0960449159030135]</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PIF = 11.012% [<span style="font-style: italic;">95% CI</span>: 9.969% to 12.043%]</span></span>
<span><span class="co">#&gt; standard_deviation(pif %) = 0.529</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dhana2023prevalence" class="csl-entry">
Dhana, Klodian, Todd Beck, Pankaja Desai, Robert S Wilson, Denis A
Evans, and Kumar B Rajan. 2023. <span>“Prevalence of Alzheimer’s
Dementia in the 50 US States and 3142 Counties: A Population Estimate
Using the 2020 Bridged-Race Postcensal from the National Center for
Health Statistics.”</span> <em>Alzheimer’s &amp; Dementia</em> 19:
e074430.
</div>
<div id="ref-lee" class="csl-entry">
Lee, Mark, Eric Whitsel, Christy Avery, Timothy M Hughes, Michael E
Griswold, Sanaz Sedaghat, Rebecca F Gottesman, Thomas H Mosley, Gerardo
Heiss, and Pamela L Lutsey. 2022. <span>“Variation in Population
Attributable Fraction of Dementia Associated with Potentially Modifiable
Risk Factors by Race and Ethnicity in the US.”</span> <em>JAMA Network
Open</em> 5 (7): e2219672–72.
</div>
<div id="ref-lee2024comparison" class="csl-entry">
Lee, Sangjun, Sungji Moon, Kyungsik Kim, Soseul Sung, Youjin Hong,
Woojin Lim, and Sue K Park. 2024. <span>“A Comparison of Green, Delta,
and Monte Carlo Methods to Select an Optimal Approach for Calculating
the 95% Confidence Interval of the Population-Attributable Fraction:
Guidance for Epidemiological Research.”</span> <em>Journal of Preventive
Medicine and Public Health</em> 57 (5): 499.
</div>
<div id="ref-mathurevalue" class="csl-entry">
Maya B. Mathur, and Tyler J. VanderWeele. 2019. <span>“Sensitivity
Analysis for Unmeasured Confounding in Meta-Analyses.”</span>
<em>Journal of the American Statistical Association&gt;</em>.
</div>
<div id="ref-pandeya" class="csl-entry">
Pandeya, Nirmala, Louise F Wilson, Penelope M Webb, Rachel E Neale,
Christopher J Bain, and David C Whiteman. 2015. <span>“Cancers in
Australia in 2010 Attributable to the Consumption of Alcohol.”</span>
<em>Australian and New Zealand Journal of Public Health</em> 39 (5):
408–13.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rodrigo Zepeda-Tello.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
